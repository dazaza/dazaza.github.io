<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>像素的中心是(0.5，0.5)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">像素的中心是(0.5，0.5)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-11 23:01:12</div><div class="page_narrow text-break page_content"><p>现在更多的光线跟踪是通过眼睛完成的，这是一个需要重新学习的课程：如果像素的中心是分数(0.5，0.5)，代码会更好，生活也更容易。如果你确定你这样做是对的，那就太好了；往前走，这里没什么可看的。取而代之的是享受这个。</p><p>将像素中心映射到(0.5，0.5)是保罗·赫克伯特(Paul Heckbert)的一篇可爱的小文章“像素的坐标是什么？”(What Are of a Pixel？)最先解释的(至少对我来说是这样)，“图形宝石”(The Graphics Gems)，第246-248页，1990年。</p><p>那篇文章现在很难找到了，所以这里有个要点。假设您的屏幕宽度和高度为1000。我们来谈谈X轴吧。可能很容易说0.0是一行最左边像素的中心，1.0是它旁边的中心，依此类推。您甚至可以使用四舍五入，其中浮点坐标73.6和74.4都会转到中心74.0。</p><p>然而，请三思而后行。使用此贴图，左边缘为-0.5%，右边缘为999.5。这不是一件令人愉快的工作。更糟糕的是，如果在像素坐标值上使用abs()或mod()等各种运算符，此映射可能会导致沿边缘的细微错误。</p><p>范围为0.0%到1000.0更容易，这意味着每个像素的中心在分数0.5时。例如，整数像素43然后对于其内部的子像素值具有43.0%到43.99999的敏感范围。以下是保罗的想象：</p><p>OpenGL一直将分数(0.5，0.5)视为像素中心。DirectX起初没有，但最终随着DirectX 10的推出而与该程序打交道。</p><p>从整型到浮点型像素坐标的正确转换操作是加0.5；浮点型到整型的操作是使用FLOOR()。</p><p>这已经是老生常谈了。每个人都是这样做的，对吗？我之所以提出它，是因为我开始在一些光线跟踪示例(伪)代码中看到，这些代码用于生成透视摄影机的方向：</p><p>float3 ray_Origin=Camera-&gt；Eyes；float2 d=2.0*(float2(idx.x，idx.y)/float2(宽度，高度))-1.0；float3 ray_direction=d.x*Camera-&gt；U+D.y*Camera-&gt；V+Camera-&gt；W；</p><p>矢量idx是像素的整数位置，宽度和高度是屏幕分辨率。通过将矢量D乘以U和V这两个矢量，计算矢量D并将其用于生成世界空间矢量。将摄像机在世界空间中的方向W矢量相加。U和V表示视图平面在距眼睛W的距离处的正X轴和Y轴。在上面的代码中，所有这些看起来都很漂亮和对称，而且大部分都是对称的。</p><p>矢量d_1应该表示屏幕上各点的归一化设备坐标(NDC)中从-1.0到1.0的一对值。但是，代码失败。继续我们的示例，整数像素位置(0，0)为(-1.0，-1.0)。听起来不错，对吧？但是我们的最高整数像素位置是(999,999)，它转换为(0.998，0.998)。0.002的总差异是因为这个糟糕的贴图将整个视图移动了半个像素。这些像素中心应与每边的边缘相距0.001。</p><p>Float2 d=2.0*((Float2(idx.x，idx.y)+Float2(0.5，0.5))/Float2(宽，高))-1.0；</p><p>这就给出了像素中心的正确ndc范围，从-0.999到0.999。如果我们通过这个转换转换浮点角点值(0.0，0.0)和(1000.0,1000.0)(我们不添加0.5，因为我们已经处于浮点状态)，我们就会得到从-1.0到1.0的整个NDC范围，从边到边，证明代码是正确的。</p><p>如果0.5让您感到恼火，并且您错过了对称性，则在像素内部生成随机值时(即，通过通过每个像素随机投射更多光线进行抗锯齿)，此公式非常合适：</p><p>Float2 d=2.0*((Float2(idx.x，idx.y)+Float2(兰德(种子)，兰德(种子))/Float2(宽，高))-1.0；</p><p>您只需将范围[0.0，1.0]中的一个随机数添加到每个整数像素位置值即可。此随机值的平均值为0.5，位于像素的中心。</p><p>长话短说：当心。把那半个像素弄对。根据我的经验，这些半像素的误差偶尔会出现在不同的地方(相机、纹理采样等)。多年来，我在Autodesk从事与光栅化相关的代码工作。他们的所作所为只会带来痛苦。如果我们不小心的话它们会再次出现在光线追踪器上。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://www.realtimerendering.com/blog/the-center-of-the-pixel-is-0-50-5/">http://www.realtimerendering.com/blog/the-center-of-the-pixel-is-0-50-5/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/像素/">#像素</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/center/">#center</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1003173.html"><img src="http://img.diglog.com/img/2020/5/thumb_cd8b0d283c5cc31412745b7adea28ca6.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003173.html">三星宣布推出新款50MP双像素和四拜耳等效传感器</a></div><span class="my_story_list_date">2020-5-22 2:49</span></div><div class="col-sm"><div><a target="_blank" href="/story/culture_art_379957.html"><img src="http://img.diglog.com/img/2011/1/thumb_fc3fa6ef1ec04406a15e723cdb5c94c7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/culture_art_379957.html">像素渐变的乒乓球墙壁</a></div><span class="my_story_list_date">2011-1-25 21:47</span></div><div class="col-sm"><div><a target="_blank" href="/story/technology_design_114684.html"><img src="http://img.diglog.com/img/2008/12/thumb_1e37e94974d44651958b3d2d4b17faaf.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/technology_design_114684.html">像素隔热手套</a></div><span class="my_story_list_date">2008-12-24 21:2</span></div><div class="col-sm"><div><a target="_blank" href="/story/technology_web2_6637.html"><img src="http://img.diglog.com/img/2006/9/thumb_182e6a6f-337a-4323-947b-53f55eb2f9a0.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/technology_web2_6637.html">CityPixel.com像素风格的虚拟社区</a></div><span class="my_story_list_date">2006-9-27 16:33</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>