<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用REACT、REDUX和SSR在没有JavaScript的情况下控制用户</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用REACT、REDUX和SSR在没有JavaScript的情况下控制用户</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-07 12:21:26</div><div class="page_narrow text-break page_content"><p>一些东西是否可以在没有JavaScript(JS)的情况下工作，这是黑客新闻评论中时不时会出现的问题--大多数时候是不能的。</p><p>这些有JS残疾的人是谁，为什么没有它事情就不能正常运作？前者当然是少数，但即便如此，随着NoScript成为下载量排名第七的Firefox插件和其他浏览器，以及现有的禁用JS的方式，这些用户也不容忽视。对于后者-我不知道。也许现代网络开发人员很懒。也许他们工作过度了，预算太低，时间紧迫。也许支持noscript太难了。也许他们甚至不知道JS可以被禁用，也不知道为什么有人会这样做。</p><p>我并不声称有这些问题的答案，但是有一段时间我已经有了一个想法，那就是如何以一种不会给开发人员带来太大负担的方式容纳这些用户。以下是实现此目的的一种方法的简短探索，并提供了一个展示该方法的演示。这是我希望在将来的某个时候实现我的愿望礼物，我的副业，但更重要的是，我希望有人能想出更好的东西。</p><p>说JS被大量使用是温和的说法，所有网站中有95.8%的网站在客户端使用它。我相信很多这样的网站在没有JS的情况下都能正常工作，这很棒。另一方面，肯定有一些没有JavaScript就不能工作的Web应用，比如WebGL/Canvas体验、音频编辑器、游戏面板测试，以及严重依赖浏览器中的JSAPI的其他Web应用。介于这两个之间的某个地方，您会发现CRUD应用程序(复杂程度各不相同)在没有JS的情况下不能工作，或者只能部分工作。</p><p>每个Web应用程序的一个基本组件是呈现HTML，这通常会反映一些状态。像Reaction这样的框架在现代Web开发中经常被用来帮助渲染和交互性。这些框架中的许多都有处理状态的方法，并且许多框架还允许将状态存储在其他地方，比如Redux-“用于JS应用程序的可预测状态容器”，它采用了事件源模式。</p><p>像Redux这样的基于事件的状态容器非常适合我们的目的，因为它与一种可以在浏览器中使用和不使用JS表单提交的交互完美地结合在一起！放到redux存储中的所有东西都应该是可序列化的，我们在表单中提交的任何东西都应该是可序列化的-至少对于enctype=&#34；application/x-www-form-urlencoded&#34；.是这样的。虽然对于是否应该将所有的状态都放到Redux中没有“正确”的答案，但是如果我们这样做了-当然可能会有更多的工作-我们得到了一个可以同时运行客户端和服务器端的集中式存储。</p><p>然后，该存储可以充当呈现的HTML所反映的状态的基准或单一真值来源。考虑到Reaction(和其他)框架支持服务器端呈现，我们可以在一些聪明、有远见和谨慎的情况下创建一个单独的Reaction应用程序，在使用和不使用JS的情况下都可以使用(使用大量加载)。</p><p>首先，我们创建帮助器组件，这些组件将抽象出拥有和不拥有JS之间的主要区别。要实现经典的TodoMVC应用程序，我只需要Button和Form组件，第一个组件是“Do this on click”的包装器，后者是依赖于用户更多输入的更通用的操作包装器。这两个帮助器的工作原理相同，即将包含整个操作(类型和有效负载)的表单呈现为表单元素。当Reaction应用程序在客户端运行时，将阻止提交事件，并将操作分派到客户端。如果没有JS，则不会阻止事件，并且会在我们当前所处的任何路由上向服务器发出请求。</p><p>在服务器端，除了监听视图路由上的GET请求外，我们还监听POST请求。对于所有GET请求，我们将返回初始的Reaction应用程序，该应用程序将为任何使用JS的用户恢复消重数据。我们对任何POST请求都是这样做的，但我们也假设，任何人向这些路由发出POST请求的唯一原因是因为他们提交了一个表单。有了这个假设，我们将检查请求中是否确实存在包含类型的主体，并且可能还包含有效负载和有效负载类型。如果我们发现了这一点，我们将检查当前会话上是否有某种状态，并使用该状态初始化Redux存储。然后，我们将提交的操作分派到存储区，获取结果状态，更新会话状态，并使用存储区呈现我们的应用程序。</p><p>您可以在这里查看实现所有这些的演示，并在这里查看源代码。</p><p>我们不能访问正在提交的任何仅限JS事件的表单，这意味着没有必要进行任何必要的交互，比如拖动、双击、长时间单击等。</p><p>我们得到了一些额外的标记，我们在设计样式时必须考虑这些标记，因为所有东西都必须包装在表单中-我们不能使用带有onclick处理程序的独立按钮。</p><p>服务器端会话管理可能会以比演示中更好的方式来完成，而在生产中，您可能需要对提交的操作进行更多的清理和验证。</p><p>如果使用这种方法实现Web应用，没有JS的用户将会有源源不断的更新，但在许多情况下，另一种选择是根本没有Web应用。</p><p>这当然可以使用Reaction和Redux之外的其他框架来实现。也许这甚至可能是Sapper或Next.js中可以找到出路的东西呢？</p><p>简而言之，通过利用表单事件和Redux等基于事件的状态容器的相似性，我们可以通过使所有操作都通过表单来为未启用JS的用户分派和更新服务器端的状态。通过使用一些帮助器组件来捕获、阻止和分派客户端的事件，这会变得更容易，而且几乎不需要做任何重复的工作就能获得好处。对于最基本的功能，我们可以使用什么样的交互是有限的，并且不得不在样式、安全性和服务器成本方面采取一些额外的预防措施，但这可能比没有JS的用户根本不能使用应用程序更好。</p><p>感谢您阅读这篇文章！我也很想听听你的想法和想法。加入黑客新闻的讨论，或者随时给我发电子邮件给我，地址是这个博客所在的域的Daniel。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.klungo.no/2020/05/28/using-react-and-redux-to-acommodate-users-without-javascript/">https://blog.klungo.no/2020/05/28/using-react-and-redux-to-acommodate-users-without-javascript/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/java/">#java</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/react/">#react</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/redux/">#redux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/js/">#js</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1005521.html"><img src="http://img.diglog.com/img/2020/6/thumb_6c0d98b3b2ad1e4309c9fd0c85650add.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1005521.html">新的基于Java的勒索软件瞄准Linux和Windows系统</a></div><span class="my_story_list_date">2020-6-7 9:41</span></div><div class="col-sm"><div><a target="_blank" href="/story/1005266.html"><img src="http://img.diglog.com/img/2020/6/thumb_9e1e686ad00681bf7d6d47821de5fb34.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1005266.html">JavaScript开发人员的有用链接</a></div><span class="my_story_list_date">2020-6-5 14:24</span></div><div class="col-sm"><div><a target="_blank" href="/story/1005073.html"><img src="http://img.diglog.com/img/2020/6/thumb_59413fdac3188e903082cc46af1e334d.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1005073.html">陌生事物，JavaScript版</a></div><span class="my_story_list_date">2020-6-4 7:33</span></div><div class="col-sm"><div><a target="_blank" href="/story/1004846.html"><img src="http://img.diglog.com/img/2020/6/thumb_8e1d19e2ef6c2e56f26e1b8b60667a3a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1004846.html">Firefox 77提供了更快的JavaScript调试和可选权限</a></div><span class="my_story_list_date">2020-6-2 23:33</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>