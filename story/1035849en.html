<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>è‹¹æœå…¬å¸å…è®¸MacOS Big Surä¸Šçš„æŸäº›ç½‘ç»œæµé‡ç»•è¿‡é˜²ç«å¢™Apple Lets Some Network Traffic Bypass Firewalls on MacOS Big Sur</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Apple Lets Some Network Traffic Bypass Firewalls on MacOS Big Sur<br/>è‹¹æœå…¬å¸å…è®¸MacOS Big Surä¸Šçš„æŸäº›ç½‘ç»œæµé‡ç»•è¿‡é˜²ç«å¢™</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-22 10:43:51</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/9d4673f1ae1fd359234dadb83a62dfc4.jpeg"><img src="http://img2.diglog.com/img/2020/11/9d4673f1ae1fd359234dadb83a62dfc4.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Firewalls arenâ€™t just for corporate networks. Large numbers of security- or privacy-conscious people also use them to filter or redirect traffic flowing in and out of their computers. Apple recently made a major change to macOS that frustrates these efforts.</p><p>é˜²ç«å¢™ä¸ä»…é€‚ç”¨äºå…¬å¸ç½‘ç»œã€‚å¤§é‡å…·æœ‰å®‰å…¨æ„è¯†æˆ–éšç§æ„è¯†çš„äººå‘˜è¿˜ä½¿ç”¨å®ƒä»¬æ¥è¿‡æ»¤æˆ–é‡å®šå‘æµå…¥å’Œæµå‡ºè®¡ç®—æœºçš„æµé‡ã€‚è‹¹æœæœ€è¿‘å¯¹macOSè¿›è¡Œäº†é‡å¤§æ›´æ”¹ï¼Œè¿™æŒ«è´¥äº†è¿™äº›åŠªåŠ›ã€‚</p><p> Beginning with Big Sur released last week, some 50 Apple-specific apps and processes are no longer routed through firewalls like Little Snitch and Lulu. The undocumented exemption came to light only after Patrick Wardle, a security researcher at a Mac and iOS enterprise developer Jamf, disclosed the change over the weekend.</p><p> ä»ä¸Šå‘¨å‘å¸ƒçš„Big Surå¼€å§‹ï¼Œå¤§çº¦50ä¸ªAppleç‰¹å®šçš„åº”ç”¨å’Œè¿‡ç¨‹ä¸å†é€šè¿‡Little Snitchå’ŒLuluç­‰é˜²ç«å¢™è¿›è¡Œè·¯ç”±ã€‚ Macå’ŒiOSä¼ä¸šå¼€å‘äººå‘˜Jamfçš„å®‰å…¨ç ”ç©¶å‘˜Patrick Wardleåœ¨å‘¨æœ«æŠ«éœ²äº†è¿™ä¸€æ›´æ”¹ä¹‹åï¼Œæ‰å‘ç°äº†æ— è¯è±å…ã€‚</p><p> In Big Sur Apple decided to exempt many of its apps from being routed thru the frameworks they now require 3rd-party firewalls to use (LuLu, Little Snitch, etc.) ğŸ§  Q: Could this be (ab)used by malware to also bypass such firewalls? ğŸ¤”  A: Apparently yes, and trivially so ğŸ˜¬ğŸ˜±ğŸ˜­  pic.twitter.com/CCNcnGPFIB</p><p> åœ¨å¤§è‹å°”ï¼Œè‹¹æœå†³å®šå…é™¤è®¸å¤šåº”ç”¨ç¨‹åºé€šè¿‡å…¶ç°åœ¨éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹é˜²ç«å¢™ï¼ˆLuLuï¼ŒLittle Snitchç­‰ï¼‰çš„æ¡†æ¶çš„è·¯ç”±ã€‚ğŸ§é—®ï¼šè¿™æ˜¯å¦å¯èƒ½è¢«æ¶æ„è½¯ä»¶æ»¥ç”¨è€Œç»•è¿‡è¿™æ ·çš„é˜²ç«å¢™ï¼Ÿ ğŸ¤”-ç­”ï¼šæ˜¾ç„¶æ˜¯çš„ï¼Œä¹Ÿå¾ˆå®¹æ˜“-ğŸ˜¬ğŸ˜±ğŸ˜­pic.twitter.com/CCNcnGPFIB</p><p>â€” patrick wardle (@patrickwardle)  November 14, 2020</p><p>-å¸•ç‰¹é‡Œå…‹Â·æ²ƒå¾·å°”ï¼ˆ@patrickwardleï¼‰2020å¹´11æœˆ14æ—¥</p><p>  To demonstrate the risks that come with this move, Wardleâ€”a former hacker for the NSAâ€”demonstrated how malware developers could exploit the change to make an end-run around a tried-and-true security measure. He set Lulu to block all outgoing traffic on a Mac running Big Sur and then ran a small programming script that interacted with one of the apps that Apple exempted. The python script had no trouble reaching a command and control server he set up to simulate one commonly used by malware to receive commands and exfiltrate sensitive data.</p><p>  ä¸ºäº†è¯æ˜æ­¤ä¸¾å¸¦æ¥çš„é£é™©ï¼Œå‰å›½å®¶å®‰å…¨å±€ï¼ˆNSAï¼‰é»‘å®¢æ²ƒå¾·å°”ï¼ˆWardleï¼‰æ¼”ç¤ºäº†æ¶æ„è½¯ä»¶å¼€å‘äººå‘˜å¦‚ä½•åˆ©ç”¨æ­¤æ›´æ”¹ä»¥ç»è¿‡å®è·µæ£€éªŒçš„å®‰å…¨æªæ–½è¿›è¡Œæœ€ç»ˆè§£å†³ã€‚ä»–è®¾ç½®Luluæ¥é˜»æ­¢è¿è¡ŒBig Surçš„Macä¸Šçš„æ‰€æœ‰ä¼ å‡ºæµé‡ï¼Œç„¶åè¿è¡Œä¸€ä¸ªå°å‹ç¼–ç¨‹è„šæœ¬ï¼Œè¯¥è„šæœ¬ä¸Appleè±å…çš„å…¶ä¸­ä¸€ä¸ªåº”ç”¨ç¨‹åºè¿›è¡Œäº†äº¤äº’ã€‚ pythonè„šæœ¬å¯ä»¥æ¯«ä¸è´¹åŠ›åœ°åˆ°è¾¾ä»–è®¾ç½®çš„å‘½ä»¤å’Œæ§åˆ¶æœåŠ¡å™¨ï¼Œä»¥æ¨¡æ‹Ÿæ¶æ„è½¯ä»¶å¸¸ç”¨çš„å‘½ä»¤å’Œæ§åˆ¶æœåŠ¡å™¨ï¼Œä»¥æ¥æ”¶å‘½ä»¤å¹¶æ³„éœ²æ•æ„Ÿæ•°æ®ã€‚</p><p> â€œIt kindly asked (coerced?) one of the trusted Apple items to generate network traffic to an attacker-controlled server and could (ab)use this to exfiltrate files,â€ Wardle, referring to the script, told me. â€œBasically, â€˜Hey Mr. Apple Item, can you please send this file to Patrickâ€™s remote server.â€™ And it would kindly agree. And since the traffic was coming from the trusted item, it would never be routed through the firewall... meaning the firewall is 100% blind.â€</p><p>â€œå¥½å¿ƒåœ°è¦æ±‚ï¼ˆå¼ºè¿«ï¼Ÿï¼‰ä¸€ä¸ªå—ä¿¡ä»»çš„Appleäº§å“æ¥ç”Ÿæˆåˆ°æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨çš„ç½‘ç»œæµé‡ï¼Œå¹¶ä¸”å¯ä»¥ï¼ˆæ»¥ç”¨ï¼‰å®ƒæ¥æ³„éœ²æ–‡ä»¶ï¼Œâ€ Wardleæåˆ°è„šæœ¬æ—¶å‘Šè¯‰æˆ‘ã€‚ â€œåŸºæœ¬ä¸Šï¼Œâ€˜Appleå…ˆç”Ÿï¼Œæ‚¨èƒ½æŠŠè¿™ä¸ªæ–‡ä»¶å‘é€åˆ°Patrickçš„è¿œç¨‹æœåŠ¡å™¨å—ï¼Ÿâ€™æˆ‘ä»¬ä¼šåŒæ„çš„ã€‚è€Œä¸”ç”±äºæµé‡æ¥è‡ªå—ä¿¡ä»»çš„é¡¹ç›®ï¼Œå› æ­¤æ°¸è¿œä¸ä¼šé€šè¿‡é˜²ç«å¢™è¿›è¡Œè·¯ç”±â€¦â€¦è¿™æ„å‘³ç€é˜²ç«å¢™æ˜¯100ï¼…ç›²ç›®çš„ã€‚â€</p><p>    Wardle  tweeted a portion of a bug report he submitted to Apple during the Big Sur beta phase. It specifically warns that â€œessential security tools such as firewalls are ineffectiveâ€ under the change.</p><p>    Wardleåœ¨Twitterä¸Šå‘å¸ƒäº†ä»–åœ¨Big Sur Betaé˜¶æ®µæäº¤ç»™Appleçš„é”™è¯¯æŠ¥å‘Šçš„ä¸€éƒ¨åˆ†ã€‚å®ƒç‰¹åˆ«è­¦å‘Šè¯´ï¼Œæ›´æ”¹åâ€œè¯¸å¦‚é˜²ç«å¢™ä¹‹ç±»çš„åŸºæœ¬å®‰å…¨å·¥å…·æ— æ•ˆâ€ã€‚</p><p> Apple has yet to explain the reason behind the change. Firewall misconfigurations are often the source of software not working properly. One possibility is that Apple implemented the move to reduce the number of support requests it receives and make the Mac experience better for people not schooled in setting up effective firewall rules. Itâ€™s not unusual for firewalls to exempt their own traffic. Apple may be applying the same rationale.</p><p> è‹¹æœå°šæœªè§£é‡Šè¿™ä¸€å˜åŒ–èƒŒåçš„åŸå› ã€‚é˜²ç«å¢™é…ç½®é”™è¯¯é€šå¸¸æ˜¯å¯¼è‡´è½¯ä»¶æ— æ³•æ­£å¸¸è¿è¡Œçš„åŸå› ã€‚ä¸€ç§å¯èƒ½æ€§æ˜¯è‹¹æœå®æ–½äº†æ­¤ä¸¾ï¼Œä»¥å‡å°‘å…¶æ”¶åˆ°çš„æ”¯æŒè¯·æ±‚çš„æ•°é‡ï¼Œå¹¶ä½¿Macæ•™è‚²ç»™é‚£äº›æ²¡æœ‰å­¦å†çš„äººä»¬å»ºç«‹æœ‰æ•ˆçš„é˜²ç«å¢™è§„åˆ™ã€‚é˜²ç«å¢™å…é™¤è‡ªå·±çš„æµé‡å¹¶ä¸ç½•è§ã€‚è‹¹æœå¯èƒ½ä¼šé‡‡ç”¨ç›¸åŒçš„ç†ç”±ã€‚</p><p> But the inability to override the settings violates a core tenet that people ought to be able to selectively restrict traffic flowing from their own computers. In the event a Mac does become infected, the change also gives hackers a way to bypass what for many is an effective mitigation against such attacks.</p><p> ä½†æ˜¯æ— æ³•è¦†ç›–è®¾ç½®è¿åäº†ä¸€ä¸ªæ ¸å¿ƒåŸåˆ™ï¼Œå³äººä»¬åº”è¯¥èƒ½å¤Ÿæœ‰é€‰æ‹©åœ°é™åˆ¶æ¥è‡ªå…¶è‡ªå·±è®¡ç®—æœºçš„æµé‡ã€‚å¦‚æœMacç¡®å®å—åˆ°æ„ŸæŸ“ï¼Œæ­¤æ›´æ”¹è¿˜ä¸ºé»‘å®¢æä¾›äº†ä¸€ç§ç»•å¼€è®¸å¤šäººå¯ä»¥æœ‰æ•ˆç¼“è§£æ­¤ç±»æ”»å‡»çš„æ–¹æ³•ã€‚</p><p> â€œThe issue I see is that it opens the door for doing exactly what Patrick demoed... malware authors can use this to sneak data around a firewall,â€ Thomas Reed, director of Mac and mobile offerings at security firm Malwarebytes, said. â€œPlus, thereâ€™s always the potential that someone may have a legitimate need to block some Apple traffic for some reason, but this takes away that ability without using some kind of hardware network filter outside the Mac.â€</p><p> å®‰å…¨å…¬å¸Malwâ€‹â€‹arebytesçš„Macå’Œç§»åŠ¨äº§å“éƒ¨é—¨ä¸»ç®¡Thomas Reedè¡¨ç¤ºï¼šâ€œæˆ‘çœ‹åˆ°çš„é—®é¢˜æ˜¯ï¼Œå®ƒç¡®å®ä¸ºPatrickæ¼”ç¤ºçš„äº‹æƒ…æ‰“å¼€äº†å¤§é—¨â€¦â€¦æ¶æ„è½¯ä»¶ä½œè€…å¯ä»¥ä½¿ç”¨å®ƒæ¥å°†æ•°æ®æ½œå…¥é˜²ç«å¢™ã€‚â€ â€œæ­¤å¤–ï¼Œæ€»æœ‰å¯èƒ½å‡ºäºæŸç§åŸå› æŸäººå¯èƒ½å‡ºäºæŸç§åˆæ³•çš„éœ€è¦é˜»æ­¢æŸäº›Appleæµé‡ï¼Œä½†è¿™æ— éœ€ä½¿ç”¨Macå¤–éƒ¨çš„æŸç§ç¡¬ä»¶ç½‘ç»œè¿‡æ»¤å™¨å°±å¯ä»¥æ¶ˆé™¤è¿™ç§èƒ½åŠ›ã€‚â€</p><p> People who want to know what apps and processes are exempt can open the macOS terminal and enter  sudo defaults read /System/Library/Frameworks/NetworkExtension.framework/Resources/Info.plist ContentFilterExclusionList.</p><p>æƒ³è¦çŸ¥é“å“ªäº›åº”ç”¨ç¨‹åºå’Œè¿›ç¨‹å…ç¨çš„äººå¯ä»¥æ‰“å¼€macOSç»ˆç«¯å¹¶è¾“å…¥sudoé»˜è®¤å€¼ï¼Œè¯·å‚é˜…/System/Library/Frameworks/NetworkExtension.framework/Resources/Info.plist ContentFilterExclusionListã€‚</p><p>  The change came as Apple deprecated macOS kernel extensions, which software developers used to make apps interact directly with the OS. The deprecation included NKEsâ€”short for network kernel extensionsâ€”that third-party firewall products used to monitor incoming and outgoing traffic.</p><p>  è¿™é¡¹æ›´æ”¹æ˜¯åœ¨Appleä¸èµæˆä½¿ç”¨macOSå†…æ ¸æ‰©å±•çš„æƒ…å†µä¸‹è¿›è¡Œçš„ï¼Œè¯¥è½¯ä»¶å¼€å‘äººå‘˜æ›¾ç»ä½¿ç”¨è¿‡è¿™äº›æ‰©å±•æ¥ä½¿åº”ç”¨ç¨‹åºç›´æ¥ä¸OSè¿›è¡Œäº¤äº’ã€‚ä¸æ¨èä½¿ç”¨çš„æ˜¯NKEï¼ˆç½‘ç»œå†…æ ¸æ‰©å±•çš„ç¼©å†™ï¼‰ï¼Œç¬¬ä¸‰æ–¹é˜²ç«å¢™äº§å“ç”¨æ¥ç›‘è§†ä¼ å…¥å’Œä¼ å‡ºæµé‡ã€‚</p><p> In place of NKEs, Apple introduced a new user-mode framework called the  Network Extension Framework. To run on Big Sur, all third-party firewalls that used NKEs had to be rewritten to use the new framework.</p><p> è‹¹æœå…¬å¸ä»£æ›¿NKEï¼Œå¼•å…¥äº†ä¸€ç§æ–°çš„ç”¨æˆ·æ¨¡å¼æ¡†æ¶ï¼Œç§°ä¸ºç½‘ç»œæ‰©å±•æ¡†æ¶ã€‚è¦åœ¨Big Surä¸Šè¿è¡Œï¼Œå¿…é¡»é‡å†™æ‰€æœ‰ä½¿ç”¨NKEçš„ç¬¬ä¸‰æ–¹é˜²ç«å¢™ä»¥ä½¿ç”¨æ–°æ¡†æ¶ã€‚</p><p> Apple representatives didnâ€™t respond to emailed questions about this change. This post will be updated if they respond later. In the meantime, people who want to override this new exemption will, as Reed noted above, have to rely on a network filter that runs from outside their Mac.</p><p> Appleä»£è¡¨æœªå›å¤æœ‰å…³æ­¤æ›´æ”¹çš„ç”µå­é‚®ä»¶é—®é¢˜ã€‚å¦‚æœä»–ä»¬ç¨åå›å¤ï¼Œåˆ™è¯¥å¸–å­å°†è¢«æ›´æ–°ã€‚åŒæ—¶ï¼Œå¦‚ä¸Šé¢Reedæ‰€è¿°ï¼Œæƒ³è¦å–æ¶ˆè¿™é¡¹æ–°è±å…çš„äººå°†ä¸å¾—ä¸ä¾é ä»Macå¤–éƒ¨è¿è¡Œçš„ç½‘ç»œè¿‡æ»¤å™¨ã€‚</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://arstechnica.com/gadgets/2020/11/apple-lets-some-big-sur-network-traffic-bypass-firewalls/">https://arstechnica.com/gadgets/2020/11/apple-lets-some-big-sur-network-traffic-bypass-firewalls/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ç»•è¿‡/">#ç»•è¿‡</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/lets/">#lets</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/é˜²ç«å¢™/">#é˜²ç«å¢™</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ†äº«/">#åˆ†äº«</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>