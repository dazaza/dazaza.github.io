<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>åŠ å¯†ç½‘ç«™å’ŒAPIçš„å¸¸è§å®‰å…¨æ¼æ´ Common security vulnerabilities with crypto websites and APIs</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Common security vulnerabilities with crypto websites and APIs<br/>åŠ å¯†ç½‘ç«™å’ŒAPIçš„å¸¸è§å®‰å…¨æ¼æ´ </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-22 20:16:32</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/d7b7d866ec3f0a080c360a8351dbf995.png"><img src="http://img2.diglog.com/img/2020/12/d7b7d866ec3f0a080c360a8351dbf995.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>There are many crypto startups coming up with the increasing popularity of cryptocurrencies.   As a FinTech enthusiast,Â I explore as many crypto websites, wallets, DeFi systems as possible and as a bug bounty hunter â€“ I get to test some of them.</p><p>æœ‰è®¸å¤šåŠ å¯†è´§å¸åˆåˆ›å…¬å¸æå‡ºäº†è¶Šæ¥è¶Šå¤šçš„åŠ å¯†è´§å¸æµè¡Œçš„æƒ³æ³•ã€‚ä½œä¸ºä¸€åé‡‘èç§‘æŠ€çˆ±å¥½è€…ï¼Œæˆ‘ä¼šå°½å¯èƒ½å¤šåœ°æ¢ç´¢åŠ å¯†ç½‘ç«™ï¼Œé’±åŒ…ï¼ŒDeFiç³»ç»Ÿä»¥åŠä½œä¸ºæ¼æ´èµé‡‘çŒäºº-æˆ‘å°†å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚</p><p> This week I tested a couple of crypto applications and there seems to be a pattern in security vulnerabilities among these applications.</p><p> æœ¬å‘¨ï¼Œæˆ‘æµ‹è¯•äº†å‡ ä¸ªåŠ å¯†åº”ç”¨ç¨‹åºï¼Œè¿™äº›åº”ç”¨ç¨‹åºä¹‹é—´ä¼¼ä¹å­˜åœ¨æŸç§å®‰å…¨æ¼æ´ã€‚</p><p> Most of these security issues were related to injection, bypassing disabled forms, and access control.</p><p> è¿™äº›å®‰å…¨é—®é¢˜å¤§éƒ¨åˆ†ä¸æ³¨å…¥ï¼Œç»•è¿‡ç¦ç”¨çš„è¡¨å•å’Œè®¿é—®æ§åˆ¶æœ‰å…³ã€‚</p><p>  Injection via X-forwarded-for header:  As a general practice most crypto websites save log-in IPs and have some functionality around IP whitelisting.   Â    an example of login notification â€“ also present in the dashboard  Without a proper validation on the server side, this field can be injected using XFF header.  These Injection can range from a harmless XSS to server side code injection, hereâ€™s an example:      an example of XFF injection  Most of these application uses REST architecture, hence these API injections can lead to severe damage depending on where you are using these JSON fields.</p><p>  é€šè¿‡X-forwarded-foræ ‡å¤´æ³¨å…¥ï¼šé€šå¸¸ï¼Œå¤§å¤šæ•°åŠ å¯†ç½‘ç«™éƒ½ä¼šä¿å­˜ç™»å½•IPï¼Œå¹¶å…·æœ‰ä¸€äº›å›´ç»•IPç™½åå•çš„åŠŸèƒ½ã€‚ç™»å½•é€šçŸ¥çš„ç¤ºä¾‹â€“ä¹Ÿå‡ºç°åœ¨ä»ªè¡¨æ¿ä¸­å¦‚æœæ²¡æœ‰åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œé€‚å½“çš„éªŒè¯ï¼Œåˆ™å¯ä»¥ä½¿ç”¨XFFæ ‡å¤´æ³¨å…¥è¯¥å­—æ®µã€‚è¿™äº›æ³¨å…¥çš„èŒƒå›´ä»æ— å®³çš„XSSåˆ°æœåŠ¡å™¨ç«¯ä»£ç æ³¨å…¥ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼šXFFæ³¨å…¥çš„ç¤ºä¾‹è¿™äº›åº”ç”¨ç¨‹åºä¸­çš„å¤§å¤šæ•°éƒ½ä½¿ç”¨RESTä½“ç³»ç»“æ„ï¼Œå› æ­¤ï¼Œæ ¹æ®æ‚¨åœ¨è¿™äº›JSONå­—æ®µä¸­çš„ä½¿ç”¨ä½ç½®ï¼Œè¿™äº›APIæ³¨å…¥ä¼šå¯¼è‡´ä¸¥é‡çš„æŸå®³ã€‚</p><p> Bypassing disabled input fields:  Some of the input fields are disabled in the dashboard (of crypto/FinTech websites).  In most cases, these fields are name, username and email â€“ disabling them make sense because these fields shouldnâ€™t be updated regularly for KYC and compliance issues.   Just disabling them from HTML forms on the client side is a bad idea, it can be easily bypassed through a browser proxy like Burp and Zap.   Sometimes even fields which arenâ€™t supposed to be updated like currency, language and timezone can get injected.   hereâ€™s an example:     Again, because of REST architecture if you are using these user data elsewhere â€“ it can create injection issues ranging from XSS to server side code execution</p><p> ç»•è¿‡ç¦ç”¨çš„è¾“å…¥å­—æ®µï¼šåœ¨æŸäº›é¢æ¿ä¸­ï¼ˆCrypto / FinTechç½‘ç«™çš„ï¼‰ç¦ç”¨äº†æŸäº›è¾“å…¥å­—æ®µã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™äº›å­—æ®µæ˜¯åç§°ï¼Œç”¨æˆ·åå’Œç”µå­é‚®ä»¶-ç¦ç”¨å®ƒä»¬æ˜¯æœ‰é“ç†çš„ï¼Œå› ä¸ºä¸åº”é’ˆå¯¹KYCå’Œåˆè§„æ€§é—®é¢˜å®šæœŸæ›´æ–°è¿™äº›å­—æ®µã€‚åªæ˜¯åœ¨å®¢æˆ·ç«¯ä»HTMLè¡¨å•ç¦ç”¨å®ƒä»¬æ˜¯ä¸€ä¸ªåä¸»æ„ï¼Œå¯ä»¥é€šè¿‡Burpå’ŒZapè¿™æ ·çš„æµè§ˆå™¨ä»£ç†è½»æ¾ç»•è¿‡å®ƒã€‚æœ‰æ—¶ï¼Œç”šè‡³ä¸åº”è¯¥æ›´æ–°çš„å­—æ®µï¼ˆä¾‹å¦‚è´§å¸ï¼Œè¯­è¨€å’Œæ—¶åŒºï¼‰ä¹Ÿå¯ä»¥æ³¨å…¥ã€‚è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼šåŒæ ·ï¼Œç”±äºRESTæ¶æ„ï¼Œå¦‚æœæ‚¨åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨è¿™äº›ç”¨æˆ·æ•°æ®ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ³¨å…¥é—®é¢˜ï¼Œä»XSSåˆ°æœåŠ¡å™¨ç«¯ä»£ç æ‰§è¡Œ</p><p> Access control: This one is complex and deep topic but Iâ€™ll share two examples:  weak auth token and  improper session managements.   There are many ways to authenticate a user in REST from HTTP basic auth, JWT to a complex implementation of cryptography. No matter what variation of auth token you are using, make sure you are not just encoding BASE64 of user data like user ID and some timestamp.   In case of JWT, use a longer secret with HMAC enabled, RS256(asymmetric algorithm) is recommended over HS256(symmetric) is the  alg header.   Also, there are some known issues with JWT, you can read more about it at  https://www.cvedetails.com/product/35664/Jwt-Project-JWT.html?vendor_id=16053 and  https://auth0.com/blog/brute-forcing-hs256-is-possible-the-importance-of-using-strong-keys-to-sign-jwts/  Coming to session management â€“ the most common issue here is session fixation.  It is recommended to end the session when a user log-out. All the cookies and session ids shouldnâ€™t work in a new session but thatâ€™s not the case most of the time.   In some cases, even where new session IDs are generated old session IDs are not disabled.  This was the case with Remitano, where I submitted the issue in their bug bounty program on Hackerone: Here is the video POC for the same:   https://youtu.be/543g_6UbIS0   Again make sure, session IDs are not predictable.</p><p> è®¿é—®æ§åˆ¶ï¼šè¿™æ˜¯ä¸€ä¸ªå¤æ‚è€Œæ·±å…¥çš„ä¸»é¢˜ï¼Œä½†æˆ‘å°†åˆ†äº«ä¸¤ä¸ªç¤ºä¾‹ï¼šèº«ä»½éªŒè¯ä»¤ç‰Œå¼±å’Œä¼šè¯ç®¡ç†ä¸å½“ã€‚ä»HTTPåŸºæœ¬èº«ä»½éªŒè¯ï¼ŒJWTåˆ°å¤æ‚çš„åŠ å¯†å®ç°ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åœ¨RESTä¸­å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ— è®ºæ‚¨ä½¿ç”¨ä»€ä¹ˆå½¢å¼çš„èº«ä»½éªŒè¯ä»¤ç‰Œï¼Œè¯·ç¡®ä¿æ‚¨ä¸åªæ˜¯å¯¹ç”¨æˆ·æ•°æ®ï¼ˆä¾‹å¦‚ç”¨æˆ·IDå’Œæ—¶é—´æˆ³ï¼‰è¿›è¡ŒBASE64ç¼–ç ã€‚å¦‚æœæ˜¯JWTï¼Œè¯·åœ¨å¯ç”¨HMACçš„æƒ…å†µä¸‹ä½¿ç”¨æ›´é•¿çš„æœºå¯†ï¼Œå»ºè®®ä½¿ç”¨RS256ï¼ˆéå¯¹ç§°ç®—æ³•ï¼‰ï¼Œè€Œalgæ ‡å¤´åº”ä½¿ç”¨HS256ï¼ˆå¯¹ç§°ï¼‰ã€‚å¦å¤–ï¼ŒJWTå­˜åœ¨ä¸€äº›å·²çŸ¥é—®é¢˜ï¼Œæ‚¨å¯ä»¥åœ¨https://www.cvedetails.com/product/35664/Jwt-Project-JWT.html?vendor_id=16053å’Œhttps://auth0.comä¸Šäº†è§£æ›´å¤šæœ‰å…³JWTçš„ä¿¡æ¯ã€‚ / blog / brute-force-hs256-å¯èƒ½æ˜¯ä½¿ç”¨å¼ºé”®ç­¾åjwtsçš„é‡è¦æ€§/è¿›å…¥ä¼šè¯ç®¡ç†â€“è¿™é‡Œæœ€å¸¸è§çš„é—®é¢˜æ˜¯ä¼šè¯å›ºå®šã€‚å»ºè®®åœ¨ç”¨æˆ·æ³¨é”€æ—¶ç»“æŸä¼šè¯ã€‚æ‰€æœ‰Cookieå’Œä¼šè¯IDå‡ä¸åº”åœ¨æ–°ä¼šè¯ä¸­ä½¿ç”¨ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¹¶éå¦‚æ­¤ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå³ä½¿å·²ç”Ÿæˆæ–°çš„ä¼šè¯IDï¼Œä¹Ÿä¸ä¼šç¦ç”¨æ—§çš„ä¼šè¯IDã€‚ Remitanoå°±æ˜¯è¿™ç§æƒ…å†µï¼Œæˆ‘åœ¨å…¶å…³äºHackeroneçš„æ¼æ´èµé‡‘è®¡åˆ’ä¸­æäº¤äº†è¯¥é—®é¢˜ï¼šè¿™æ˜¯ç›¸åŒçš„è§†é¢‘POCï¼šhttps://youtu.be/543g_6UbIS0å†æ¬¡ç¡®ä¿ä¼šè¯IDæ˜¯ä¸å¯é¢„æµ‹çš„ã€‚</p><p> Thatâ€™s all for now, hope you found this short post useful.  And if you are a crypto or FinTech startup and looking for security audit â€“ we should talk ğŸ™‚  If you have any questions, suggestion regarding this post â€“ feel free to reach out on my  Twitter.</p><p> åˆ°æ­¤ä¸ºæ­¢ï¼Œå¸Œæœ›æ‚¨å¯¹è¿™ç¯‡ç®€çŸ­çš„å¸–å­æœ‰æ‰€å¸®åŠ©ã€‚å¦‚æœæ‚¨æ˜¯åŠ å¯†è´§å¸æˆ–é‡‘èç§‘æŠ€åˆ›ä¸šå…¬å¸ï¼Œå¹¶ä¸”æ­£åœ¨å¯»æ±‚å®‰å…¨å®¡è®¡ï¼Œæˆ‘ä»¬åº”è¯¥è°ˆè°ˆğŸ™‚å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®ï¼Œå…³äºæ­¤å¸–å­çš„å»ºè®®ï¼Œè¯·éšæ—¶ä¸æˆ‘çš„Twitterè”ç»œã€‚ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://introvertmac.wordpress.com/2020/12/22/common-security-issues-with-crypto-websites-and-apis/">https://introvertmac.wordpress.com/2020/12/22/common-security-issues-with-crypto-websites-and-apis/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/æ¼æ´/">#æ¼æ´</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/security/">#security</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ†äº«/">#åˆ†äº«</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>