<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>è°·æ­Œå¦‚ä½•ä¿æŒä½ä½å»¶ç»­æ—¶é—´ï¼Ÿ How does Google keep build times low?</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">How does Google keep build times low?<br/>è°·æ­Œå¦‚ä½•ä¿æŒä½ä½å»¶ç»­æ—¶é—´ï¼Ÿ </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-06 18:05:13</div><div class="page_narrow text-break page_content"><p>Monorepos have existed for a very long time. The basic idea behind them is to store the complete source code of your company or product,  including all of its dependencies, in a single source repository and have an integrated build and test process for the whole.</p><p>Monoreposå·²ç»å­˜åœ¨äº†å¾ˆé•¿æ—¶é—´ã€‚å®ƒä»¬èƒŒåçš„åŸºæœ¬æ€æƒ³æ˜¯å­˜å‚¨å…¬å¸æˆ–äº§å“çš„å®Œæ•´æºä»£ç ï¼ŒåŒ…æ‹¬å…¶æ‰€æœ‰ä¾èµ–é¡¹ï¼Œåœ¨å•ä¸ªæºå­˜å‚¨åº“ä¸­ï¼Œå¹¶ä¸ºæ•´ä½“å…·æœ‰é›†æˆçš„æ„å»ºå’Œæµ‹è¯•è¿‡ç¨‹ã€‚</p><p> I like to think of the BSD systems as the canonical example of open-source monorepos, but these were never seen as good practice by many (c.f.  CatB). Monorepos have only become popular during the last decade because of Googleâ€™s engineering practices and their increasing desire to  share details with the public. Googleâ€™s monorepo is probably the largest in the world, and if works at their scaleâ€”the thinking goesâ€”it must be good for everyone else, right? Not so fast.</p><p> æˆ‘å–œæ¬¢å°†BSDç³»ç»Ÿè§†ä¸ºå¼€æºMonoreposçš„è§„èŒƒç¤ºä¾‹ï¼Œä½†è¿™äº›ä»æœªè¢«è®¤ä¸ºæ˜¯è®¸å¤šï¼ˆC.f.CATBï¼‰çš„è‰¯å¥½å®è·µã€‚ç”±äºè°·æ­Œçš„å·¥ç¨‹å®è·µåŠå…¶æ—¥ç›Šæ„¿æœ›ä¸å…¬ä¼—åˆ†äº«è¯¦ç»†ä¿¡æ¯ï¼Œå› æ­¤è«ç½—å°”æ–¯åœ¨è¿‡å»åå¹´ä¸­åªå˜å¾—æµè¡Œã€‚è°·æ­Œçš„Monorepoå¯èƒ½æ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„ï¼Œå¦‚æœåœ¨ä»–ä»¬çš„è§„æ¨¡ä¸Šå·¥ä½œ - æ€è€ƒ - å®ƒå¯¹å…¶ä»–äººéƒ½å¿…é¡»æœ‰å¥½å¤„ï¼Œå¯¹å§ï¼Ÿä¸æ˜¯é‚£ä¹ˆå¿«ã€‚</p><p> Monorepos are an interesting beast. If mended properly, they indeed enable a level of uniformity and code quality that is hard to achieve otherwise. If left unattended, however, they become unmanageable monsters of tangled dependencies, slow builds, and frustrating developer experiences. Whether you have a good or bad experience directly depends on the level of engineering support behind the monorepo. Simply put, monorepos require dedicated teams (plural)  and tools to run nicely (not just random engineers â€œvolunteeringâ€ their efforts), and these cost a lot of time and money.</p><p> Monoreposæ˜¯ä¸€ä¸ªæœ‰è¶£çš„é‡å…½ã€‚å¦‚æœæ­£ç¡®åœ°ä¿®è¡¥ï¼Œå®ƒä»¬ç¡®å®èƒ½å¤Ÿå®ç°æ°å½“çš„å‡åŒ€æ€§å’Œä»£ç è´¨é‡ï¼Œä»¥å…¶ä»–æ–¹å¼éš¾ä»¥å®ç°ã€‚ç„¶è€Œï¼Œå¦‚æœæ— äººçœ‹ç®¡ï¼Œå®ƒä»¬ä¼šæˆä¸ºçº ç»“ä¾èµ–æ€§ï¼Œç¼“æ…¢çš„å»ºé€ å’Œä»¤äººæ²®ä¸§çš„å¼€å‘äººå‘˜ä½“éªŒçš„æ— æ³•ç®¡ç†æ€ªç‰©ã€‚æ— è®ºæ‚¨æ˜¯è‰¯å¥½è¿˜æ˜¯ä¸è‰¯ç»éªŒï¼Œç›´æ¥ä¾èµ–äºMonorepoèƒŒåçš„å·¥ç¨‹æ”¯æŒæ°´å¹³ã€‚ç®€å•åœ°è¯´ï¼ŒMonoreposéœ€è¦ä¸“é—¨çš„å›¢é˜Ÿï¼ˆå¤æ•°ï¼‰å’Œå·¥å…·æ¥è¿è¡Œå¾ˆå¥½ï¼ˆä¸ä»…ä»…æ˜¯éšæœºå·¥ç¨‹å¸ˆâ€œå¿—æ„¿è€…â€ä»–ä»¬çš„åŠªåŠ›ï¼‰ï¼Œè€Œä¸”è¿™äº›èŠ±è´¹äº†å¾ˆå¤šæ—¶é—´å’Œé‡‘é’±ã€‚</p><p> As a consequence of this cost, you must be wary before adopting a monorepo model. You must have a good story around support upfront, or else you are in for long-term pain. And once you are in a monorepo, the â€œlong termâ€ is guaranteed because untangling the dependency mess that arises in such an environment can be next to impossible. The worst scenario is when you did not actively decide to implant a monorepo, but you end up in one due to organic or unexpected quick growthâ€”in which case your tooling and practices are almost certainly not ready for it.</p><p> ç”±äºè¿™ä¸€æˆæœ¬ï¼Œæ‚¨å¿…é¡»åœ¨é‡‡ç”¨Monorepoæ¨¡å‹ä¹‹å‰è°¨æ…æ€åº¦ã€‚ä½ å¿…é¡»æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ•…äº‹ï¼Œå‘¨è¾¹åœ°æ”¯æŒï¼Œå¦åˆ™ä½ æ˜¯ä¸ºäº†é•¿æœŸç—›è‹¦ã€‚ä¸€æ—¦ä½ è¿›å…¥MONOREPOï¼Œâ€œé•¿æœŸâ€æ˜¯ä¿è¯çš„ï¼Œå› ä¸ºåœ¨è¿™ç§ç¯å¢ƒä¸­äº§ç”Ÿçš„ä¾èµ–æ€§æ··ä¹±æ˜¯ä¸å¯èƒ½çš„ã€‚æœ€ç³Ÿç³•çš„æƒ…å†µæ˜¯å½“ä½ æ²¡æœ‰ç§¯æå†³å®šæ¤å…¥ä¸€ä¸ªmonorepoçš„æ—¶å€™ï¼Œä½†ç”±äºæœ‰æœºæˆ–æ„å¤–çš„å¿«é€Ÿå¢é•¿ï¼Œä½ æœ€ç»ˆç»“æŸ - åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨çš„å·¥å…·å’Œå®è·µå‡ ä¹è‚¯å®šæ²¡æœ‰ä¸ºæ­¤åšå¥½å‡†å¤‡ã€‚</p><p> In this post, I will look at how Google is able to successfully run the worldâ€™s largest monorepo while keeping build times minimal. They can, for example, validate and merge most PRs on CI within minutes while having the almost-absolute confidence that they wonâ€™t break  anythingâ€”yet itâ€™s impossible to build the whole repository in those few minutes. Iâ€™ll restrict this post to analyzing build times and will specifically avoid talking about test times. Both are crucially important but both have very different solutions. Maybe a follow-up post will cover tests ğŸ˜‰.</p><p> åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šçœ‹çœ‹è°·æ­Œå¦‚ä½•èƒ½å¤Ÿåœ¨ä¿æŒå»ºç«‹æ—¶é—´æœ€å°çš„åŒæ—¶æˆåŠŸè¿è¡Œä¸–ç•Œä¸Šæœ€å¤§çš„Monorepoã€‚ä¾‹å¦‚ï¼Œå®ƒä»¬å¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…éªŒè¯å¹¶åˆå¹¶å¤§å¤šæ•°PIä¸Šçš„CIï¼ŒåŒæ—¶å…·æœ‰å‡ ä¹ç»å¯¹çš„ä¿¡å¿ƒï¼Œä»¥è‡³äºå®ƒä»¬ä¸ä¼šç ´åä»»ä½•ä¸œè¥¿ - ç„¶è€Œåœ¨å‡ åˆ†é’Ÿå†…å»ºç«‹æ•´ä¸ªå­˜å‚¨åº“æ˜¯ä¸å¯èƒ½çš„ã€‚æˆ‘å°†é™åˆ¶è¿™ç¯‡æ–‡ç« æ¥åˆ†ææ„å»ºæ—¶é—´ï¼Œå¹¶å°†ç‰¹åˆ«é¿å…è°ˆè®ºæµ‹è¯•æ—¶é—´ã€‚ä¸¤è€…éƒ½å¾ˆé‡è¦ï¼Œä½†ä¸¤è€…éƒ½æœ‰å¾ˆä¸åŒçš„è§£å†³æ–¹æ¡ˆã€‚ä¹Ÿè®¸åç»­å¸–å­å°†è¦†ç›–æµ‹è¯•ğŸ˜‰ã€‚</p><p>  A key feature of a monorepo, as mentioned earlier, is to have a unified build process for the whole. In the common case, the repository has a single entry point at the top level, which means that the entire repository has to be built for every change to ensure the health of the tree. It might be possible for individual engineers to hand-pick which parts of the tree to build on their development machine (e.g. by running  make on a subdirectory), but CI environments will blindly do builds from the root.</p><p>  å¦‚å‰æ‰€è¿°ï¼ŒMonorepoçš„ä¸€ä¸ªå…³é”®ç‰¹å¾æ˜¯ä¸ºæ•´ä½“æ‹¥æœ‰ç»Ÿä¸€çš„æ„å»ºè¿‡ç¨‹ã€‚åœ¨å¸¸è§çš„æƒ…å†µä¸‹ï¼Œå­˜å‚¨åº“åœ¨é¡¶çº§å¤„äºå•ä¸ªå…¥å£ç‚¹ï¼Œè¿™æ„å‘³ç€å¿…é¡»ä¸ºæ¯ç§æ›´æ”¹æ„å»ºæ•´ä¸ªå­˜å‚¨åº“ä»¥ç¡®ä¿æ ‘çš„è¿è¡ŒçŠ¶å†µã€‚å„ä¸ªå·¥ç¨‹å¸ˆå¯èƒ½å¯ä»¥æ‰‹åŠ¨æŒ‘é€‰æ ‘çš„å“ªäº›éƒ¨åˆ†ä»¥åœ¨å…¶å¼€å‘æœºä¸Šæ„å»ºï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡åœ¨å­ç›®å½•ä¸­è¿è¡Œmakeï¼‰ï¼Œä½†CIç¯å¢ƒå°†ç›²ç›®åœ°ä»æ ¹æœ¬ä¸­æ„å»ºã€‚</p><p> This approach, tied to the fact that monorepos grow unboundedly with the company or product they support, causes build times to balloonâ€¦ until they grind the development processes to a halt. If you add to this that most build systems need occasional clean operations, frustration is guaranteed:</p><p> è¿™ç§æ–¹æ³•ä¸Monoreposä¸ä»–ä»¬æ”¯æŒçš„å…¬å¸æˆ–äº§å“æ— æŸç¼šçš„äº‹å®ç›¸å…³è”ï¼Œå¯¼è‡´å»ºç«‹æ—¶é—´åˆ°æ°”çƒ......ç›´åˆ°ä»–ä»¬å°†å¼€å‘è¿‡ç¨‹æ‹–åˆ°åœæ­¢ã€‚å¦‚æœæ‚¨æ·»åŠ äº†è¿™ä¸€ç‚¹ï¼Œå¤§å¤šæ•°æ„å»ºç³»ç»Ÿéœ€è¦å¶å°”å¹²å‡€çš„æ“ä½œï¼Œè¯·ä¿è¯æŒ«æŠ˜ï¼š </p><p> Pull requests are almost impossible to manage as they need long validation times and might hit unpredicted merge conflicts.</p><p>æ‹‰å‡ºè¯·æ±‚å‡ ä¹æ— æ³•ç®¡ç†ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦é•¿æœŸéªŒè¯æ—¶é—´ï¼Œå¹¶ä¸”å¯èƒ½ä¼šè¾¾åˆ°æœªé¢„æµ‹çš„åˆå¹¶å†²çªã€‚</p><p> Quality suffers because developers wonâ€™t want to pay the penalty of yet another CI run just to address nits raised in the final pass of a code review.</p><p> è´¨é‡é­å—ï¼Œå› ä¸ºå¼€å‘äººå‘˜ä¸æƒ³æ”¯ä»˜å¦ä¸€ä¸ªCIçš„æƒ©ç½šï¼Œåªæ˜¯ä¸ºäº†è§£å†³ä»£ç å®¡æŸ¥çš„æœ€ç»ˆé€šè¡Œè¯ä¸­æå‡ºçš„NITSã€‚</p><p> Facing these circumstances, the natural temptation is to split the repository into smaller pieces and regain control of the build times. (This, by the way, is the specific project Iâ€™m involved in right now.) And, depending on the tooling you are subject to and the freedom (or lack thereof) you have in changing it, this may be the only possible/correct answer. But why? Why would moving to smaller repositories fix build times? The total amount of code wonâ€™t get smaller just by splitting it; if anything, it might  grow even more! The answer may be obvious:</p><p> é¢å¯¹è¿™äº›æƒ…å†µï¼Œè‡ªç„¶è¯±æƒ‘æ˜¯å°†å­˜å‚¨åº“åˆ†æˆè¾ƒå°çš„ç¢ç‰‡å¹¶é‡æ–°è·å¾—å¯¹æ„å»ºæ—¶çš„æ§åˆ¶ã€‚ ï¼ˆé¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™æ˜¯æˆ‘ç°åœ¨å‚ä¸çš„å…·ä½“é¡¹ç›®ã€‚ï¼‰å¹¶ä¸”æ ¹æ®æ‚¨æ‰€å¤„çš„å·¥å…·ä»¥åŠæ‚¨åœ¨æ”¹å˜å®ƒçš„è‡ªç”±ï¼ˆæˆ–ç¼ºä¹ï¼‰çš„æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½æ˜¯å”¯ä¸€å¯èƒ½çš„/æ­£ç¡®ç­”æ¡ˆã€‚ä½†ä¸ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ç§»åŠ¨åˆ°è¾ƒå°çš„å­˜å‚¨åº“ä¿®å¤æ„å»ºæ—¶é—´ï¼Ÿé€šè¿‡æ‹†åˆ†æ‹†åˆ†æ—¶ï¼Œä»£ç æ€»é‡ä¸ä¼šå˜å°;å¦‚æœæœ‰çš„è¯ï¼Œå®ƒå¯èƒ½ä¼šå¢åŠ æ›´å¤šï¼ç­”æ¡ˆå¯èƒ½æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼š</p><p> Multiple repositories introduce synchronization points. Under such a model, the cross-repository dependencies are expressed as  binary package dependencies with specific version numbers. In essence, the smaller repositories leverage builds that  others have already done and thus bound their build times.</p><p> å¤šä¸ªå­˜å‚¨åº“å¼•å…¥åŒæ­¥ç‚¹ã€‚åœ¨è¿™æ ·çš„æ¨¡å‹ä¸­ï¼Œäº¤å‰å­˜å‚¨åº“ä¾èµ–å…³ç³»è¢«è¡¨ç¤ºä¸ºå…·æœ‰ç‰¹å®šç‰ˆæœ¬å·çš„äºŒè¿›åˆ¶åŒ…ä¾èµ–å…³ç³»ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œè¾ƒå°çš„å­˜å‚¨åº“åˆ©ç”¨å»ºç«‹å…¶ä»–äººå·²ç»å®Œæˆå¹¶å› æ­¤ç»‘å®šäº†ä»–ä»¬çš„æ„å»ºæ—¶é—´ã€‚</p><p>  Yetâ€¦ Googleâ€™s monorepo is known for  not using binary artifacts: they build  everything at head with the exception of the most basic C++ toolchain (known as crosstool in  Google Bazel parlance) for bootstrapping reasons. How do they pull this off? The answer is simple and is the exact same as given above: they leverage builds that others have already done. And the specific way they do this is by applying a common solution to performance problems: caching.</p><p>  ç„¶è€Œ......è°·æ­Œçš„MONOREPOæ˜¯ä¸ä½¿ç”¨äºŒå…ƒå·¥ä»¶çš„åˆ«åï¼šå®ƒä»¬åœ¨å¤´éƒ¨å»ºç«‹ä¸€åˆ‡ï¼Œé™¤äº†æœ€åŸºæœ¬çš„C ++ Toolchainï¼ˆè°·æ­ŒBazel Partranceä¸­ç§°ä¸ºCrosstoolï¼‰ï¼Œä»¥ä¾¿å¼•å¯¼è¢«å¼•å¯¼åŸå› ã€‚ä»–ä»¬å¦‚ä½•æŠŠå®ƒèµ¶èµ°ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œä¸ä¸Šé¢ç»™å‡ºçš„å®Œå…¨ç›¸åŒï¼šä»–ä»¬åˆ©ç”¨å…¶ä»–äººå·²ç»å®Œæˆçš„å»ºé€ ã€‚ä»¥åŠä»–ä»¬è¿™æ ·åšçš„å…·ä½“æ–¹å¼æ˜¯é€šè¿‡å¯¹æ€§èƒ½é—®é¢˜åº”ç”¨å¸¸è§è§£å†³æ–¹æ¡ˆï¼šç¼“å­˜ã€‚</p><p> Google builds rely on a  cross-user (remote) massive artifact cache that stores the outputs of all build actions. This cache is what introduces the same â€œsynchronization pointsâ€ that multiple repositories benefit from. By leveraging this cache, the vast majority of dependencies needed for any given build will have already been compiled by someone or something else and will be reused.</p><p> Googleæ„å»ºä¾èµ–äºè·¨ç”¨æˆ·ï¼ˆè¿œç¨‹ï¼‰çš„å¤§è§„æ¨¡å·¥ä»¶ç¼“å­˜ï¼Œè¯¥ç¼“å­˜å­˜å‚¨æ‰€æœ‰æ„å»ºæ“ä½œçš„è¾“å‡ºã€‚æ­¤ç¼“å­˜æ˜¯ä»‹ç»å¤šä¸ªå­˜å‚¨åº“ä¸­å—ç›Šçš„ç›¸åŒâ€œåŒæ­¥ç‚¹â€ã€‚é€šè¿‡åˆ©ç”¨æ­¤ç¼“å­˜ï¼Œä»»ä½•ç»™å®šæ„å»ºæ‰€éœ€çš„ç»å¤§å¤šæ•°ä¾èµ–é¡¹éƒ½å°†ç”±æŸäººæˆ–å…¶ä»–æŸç§æ„å»ºç¼–åˆ¶ï¼Œå¹¶ä¸”å°†è¢«é‡ç”¨ã€‚</p><p> Butâ€¦ caching alone is insufficient to fix build times unless you get 90%+ cache hit rates overall. And thatâ€™s where the differences between awful build times in a monorepo and great build times lie. In the next sections, Iâ€™ll look into the specific mechanisms that lead to such high cache hit rates. And if Google can have them, so can you.  Bazel, from its inception, has been trying to spread these practices to the publicâ€”but you can apply these same concepts with other build tools too.</p><p> ä½†æ˜¯......é™¤éæ‚¨æ•´ä½“è·å¾—90ï¼…+ç¼“å­˜å‘½ä¸­ç‡ï¼Œå¦åˆ™å•ç‹¬ç¼“å­˜ä¸è¶³ä»¥ä¿®å¤æ„å»ºæ—¶é—´ã€‚è¿™å°±æ˜¯Monorepoå’Œä¼Ÿå¤§çš„å»ºç­‘æ—¶é—´åœ¨Monorepoå’Œä¼Ÿå¤§çš„å»ºç­‘æ—¶é—´ä¹‹é—´çš„å·®å¼‚ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘å°†ç ”ç©¶å¯¼è‡´è¿™ç§é«˜é€Ÿç¼“å­˜å‘½ä¸­ç‡çš„å…·ä½“æœºåˆ¶ã€‚å¦‚æœè°·æ­Œå¯ä»¥æ‹¥æœ‰å®ƒä»¬ï¼Œä½ ä¹Ÿå¯ä»¥ã€‚ä»æˆç«‹å¼€å§‹ï¼ŒBazelä¸€ç›´è¯•å›¾å‘å…¬ä¼—ä¼ æ’­è¿™äº›åšæ³• - ä½†æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ„å»ºå·¥å…·åº”ç”¨è¿™äº›ç›¸åŒçš„æ¦‚å¿µã€‚ </p><p>  First of all, we have to ensure that build actions (e.g. compiler invocations, resource bundling) are deterministic. Given a set of input files and tools to process them, the output must not be subject to environmental differences. In other words: build actions must be sufficiently-specified so that they donâ€™t rely on hidden dependencies that could change their outputs.</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿æ„å»ºåŠ¨ä½œï¼ˆä¾‹å¦‚ç¼–è¯‘å™¨è°ƒç”¨ï¼Œèµ„æºæ†ç»‘ï¼‰æ˜¯ç¡®å®šæ€§çš„ã€‚ç»™å®šä¸€ç»„è¾“å…¥æ–‡ä»¶å’Œå·¥å…·å¤„ç†å®ƒä»¬ï¼Œè¾“å‡ºä¸å¾—å—åˆ°ç¯å¢ƒå·®å¼‚çš„å½±å“ã€‚æ¢å¥è¯è¯´ï¼šå¿…é¡»å……åˆ†æŒ‡å®šæ„å»ºæ“ä½œï¼Œä»¥ä¾¿å®ƒä»¬ä¸ä¾èµ–äºå¯ä»¥æ›´æ”¹å…¶è¾“å‡ºçš„éšè—ä¾èµ–é¡¹ã€‚</p><p> I covered this topic in depth in the previous â€œ How does Google avoid clean builds?â€ post where I analyzed how this simple idea allows incremental builds to always work. I also glanced over some of the many other benefits that it brings, including how it can lead to optimal build times, which is what Iâ€™m covering here.</p><p> æˆ‘åœ¨ä¸Šä¸€ä¸ªâ€œGoogleå¦‚ä½•é¿å…å¹²å‡€çš„æ„å»ºï¼Ÿâ€çš„æ·±å…¥äº†è§£äº†è¿™ä¸€ä¸»é¢˜ã€‚å‘å¸ƒæˆ‘åˆ†æäº†è¿™ä¸ªç®€å•çš„æƒ³æ³•å¦‚ä½•å…è®¸å¢é‡æ„å»ºå§‹ç»ˆå·¥ä½œã€‚æˆ‘ä¹Ÿç¥äº†ä¸€çœ¼å®ƒå¸¦æ¥çš„è®¸å¤šå…¶ä»–ç¦åˆ©ï¼ŒåŒ…æ‹¬å¦‚ä½•å¯¼è‡´æœ€ä½³å»ºè®¾æ—¶é—´ï¼Œè¿™æ˜¯æˆ‘åœ¨è¿™é‡Œè¦†ç›–çš„ã€‚</p><p> Deterministic actions are the foundation to reducing build times in a monorepo. Soâ€¦ you must sort this out before you can take advantage of any of the remaining points.</p><p> ç¡®å®šæ€§è¡ŒåŠ¨æ˜¯åœ¨Monorepoä¸­å‡å°‘å»ºç­‘æ—¶é—´çš„åŸºç¡€ã€‚æ‰€ä»¥......ä½ å¿…é¡»åœ¨åˆ©ç”¨ä»»ä½•å‰©ä½™ç‚¹ä¹‹å‰å¯¹æ­¤è¿›è¡Œåˆ†ç±»ã€‚</p><p>  Once build actions are deterministic, the next thing to worry about is increasing the chances of reusing previously-cached actions for any given build. This is generally only possible when builds use the exact same configuration, or else their outputs will differ and may be incompatible with each other. For example: a debug build will not be able to safely reuse the outputs of a release build. Which is kinda obvious, but there arenâ€™t just two configurations. There tend to be more. Many more.</p><p>  ä¸€æ—¦æ„å»ºè¡ŒåŠ¨æ˜¯ç¡®å®šæ€§çš„ï¼Œä¸‹ä¸€ä»¶äº‹å°±æ˜¯å¢åŠ ä¸ºä»»ä½•ç»™å®šçš„æ„å»ºé‡å¤ä½¿ç”¨å…ˆå‰ç¼“å­˜çš„åŠ¨ä½œçš„æœºä¼šã€‚è¿™é€šå¸¸åªæœ‰åœ¨æ„å»ºä½¿ç”¨å®Œå…¨ç›¸åŒçš„é…ç½®æ—¶æ‰å¯èƒ½ï¼Œå¦åˆ™å®ƒä»¬çš„è¾“å‡ºå°†ä¸åŒï¼Œå¹¶ä¸”å¯èƒ½ä¸å½¼æ­¤ä¸å…¼å®¹ã€‚ä¾‹å¦‚ï¼šè°ƒè¯•ç‰ˆæœ¬å°†æ— æ³•å®‰å…¨åœ°é‡ç”¨å‘å¸ƒæ„å»ºçš„è¾“å‡ºã€‚è¿™æœ‰ç‚¹æ˜æ˜¾ï¼Œä½†ä¸ä»…æœ‰ä¸¤ç§é…ç½®ã€‚å¾€å¾€ä¼šæ›´å¤šã€‚è¿˜æœ‰å¾ˆå¤šã€‚</p><p> In fact, the number of build configurations grows with the size of the projectâ€”and, paradoxically, the number of options grows to  reduce build times. You see: when engineers suffer from painfully slow builds, in the best of their intentions, they add knobs to conditionally compile certain parts of the project to speed things up. Which is great in single-user/single-machine builds, but it doesnâ€™t scale and is an anti-pattern in a monorepo world where we must have almost-perfect caching across users.</p><p> å®é™…ä¸Šï¼Œæ„å»ºé…ç½®çš„æ•°é‡éšç€é¡¹ç›®çš„å¤§å°è€Œå¢é•¿ - è€Œä¸”çŸ›ç›¾çš„æ˜¯ï¼Œé€‰é¡¹æ•°é‡å¢é•¿ä»¥å‡å°‘æ„å»ºæ—¶é—´ã€‚ä½ çœ‹ï¼šå½“å·¥ç¨‹å¸ˆç—›è‹¦åœ°ç¼“æ…¢å»ºé€ æ—¶ï¼Œä»–ä»¬åœ¨ä»–ä»¬çš„æ„å›¾ä¸­ï¼Œä»–ä»¬å¯ä»¥åœ¨æœ‰æ¡ä»¶åœ°ç¼–åˆ¶é¡¹ç›®çš„æŸäº›éƒ¨åˆ†æ¥åŠ é€Ÿæ—‹é’®ã€‚åœ¨å•ç”¨æˆ·/å•æœºæ„å»ºä¸­å¾ˆå¥½ï¼Œä½†å®ƒä¸ä¼šç¼©æ”¾ï¼Œå¹¶ä¸”åœ¨Monorepo Worldä¸­æ˜¯ä¸€ç§åæ¨¡å¼ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ç”¨æˆ·èº«ä¸Šå‡ ä¹å®Œç¾çš„ç¼“å­˜ã€‚</p><p> Thus, for monorepo builds to be quick, we actually have to homogenize configurations so that most engineers and CI are running almost the same configuration. In practical terms, this means having debug builds for interactive development, and release builds for production usage. And thatâ€™s about it.</p><p> å› æ­¤ï¼Œå¯¹äºmonorepoå»ºç«‹å¿«é€Ÿï¼Œæˆ‘ä»¬å®é™…ä¸Šå¿…é¡»å‡åŒ€åŒ–é…ç½®ï¼Œä»¥ä¾¿å¤§å¤šæ•°å·¥ç¨‹å¸ˆå’ŒCIè¿è¡Œå‡ ä¹ç›¸åŒçš„é…ç½®ã€‚å®é™…ä¸Šï¼Œè¿™æ„å‘³ç€å…·æœ‰ç”¨äºäº¤äº’å¼å¼€å‘çš„è°ƒè¯•æ„å»ºï¼Œå¹¶é‡Šæ”¾ç”Ÿäº§ä½¿ç”¨ã€‚é‚£å°±æ˜¯å…³äºå®ƒçš„ã€‚</p><p> As an anecdote, we encountered this specific issue while onboard a certain iOS team into remote builds. This team had been developing on laptops only, and because they had slow builds, the engineers had added many feature flags to make components optional. When we moved them to remote builds and remote caching, we saw very little benefit: these users were  still rebuilding everything and the reason was because they could not make use of previously-cached results due to different configurations. Once we removed most build-time conditionals, they started truly seeing the benefits of remote caching/execution and faster builds. Counterintuitive, isnâ€™t it?</p><p> ä½œä¸ºä¸€ä¸ªè½¶äº‹ï¼Œæˆ‘ä»¬é‡åˆ°äº†è¿™ä¸ªç‰¹å®šçš„é—®é¢˜ï¼ŒåŒæ—¶åœ¨æŸä¸ªiOSå›¢é˜Ÿé™·å…¥è¿œç¨‹æ„å»ºæ—¶ã€‚è¯¥å›¢é˜Ÿä»…åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸Šå¼€å‘ï¼Œå› ä¸ºå®ƒä»¬å…·æœ‰ç¼“æ…¢çš„æ„å»ºï¼Œå·¥ç¨‹å¸ˆæ·»åŠ äº†è®¸å¤šåŠŸèƒ½æ ‡å¿—æ¥ä½¿ç»„ä»¶å¯é€‰ã€‚å½“æˆ‘ä»¬å°†å®ƒä»¬ç§»åŠ¨åˆ°è¿œç¨‹æ„å»ºå’Œè¿œç¨‹ç¼“å­˜æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¾ˆå°‘çš„å¥½å¤„ï¼šè¿™äº›ç”¨æˆ·ä»ç„¶é‡å»ºä¸€åˆ‡ï¼ŒåŸå› æ˜¯å› ä¸ºç”±äºä¸åŒçš„é…ç½®ï¼Œä»–ä»¬æ— æ³•åˆ©ç”¨ä»¥å‰ç¼“å­˜çš„ç»“æœã€‚ä¸€æ—¦æˆ‘ä»¬åˆ é™¤äº†å¤§å¤šæ•°æ„å»ºæ¡ä»¶ï¼Œä»–ä»¬å°±å¼€å§‹çœŸæ­£çœ‹åˆ°è¿œç¨‹ç¼“å­˜/æ‰§è¡Œå’Œæ›´å¿«çš„æ„å»ºçš„å¥½å¤„ã€‚è¿åç›´è§‰ï¼Œä¸æ˜¯å—ï¼Ÿ </p><p>  By this point, we know that our actions are deterministic and that user builds have a chance to reuse the cache because we have made builds uniform. But here comes the question: how do we seed the cache?</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬çš„è¡Œä¸ºæ˜¯ç¡®å®šæ€§çš„ï¼Œå¹¶ä¸”ç”¨æˆ·æ„å»ºæœ‰æœºä¼šé‡ç”¨ç¼“å­˜ï¼Œå› ä¸ºæˆ‘ä»¬åˆ¶ä½œäº†æ„é€ ã€‚ä½†è¿™æ˜¯é—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•ç§å­ç¼“å­˜ï¼Ÿ</p><p>  A  cross-user cache of build artifacts must be populated only from trusted sources. We cannot have a developerâ€™s workstation inject output artifacts that were built on their machine because the developer could have tampered with the outputs. This means that the cross-user remote cache can only be populated from machines that cannot be tampered with. (If the cache is not used across users, then no extra precautions are necessary.) These trusted sources come in two forms:</p><p>  å¿…é¡»ä»…ä»å¯ä¿¡æºå¡«å……æ„å»ºå·¥ä»¶çš„äº¤å‰ç”¨æˆ·ç¼“å­˜ã€‚æˆ‘ä»¬ä¸èƒ½æ‹¥æœ‰åœ¨å…¶è®¡ç®—æœºä¸Šæ„å»ºçš„å¼€å‘äººå‘˜çš„å·¥ä½œç«™æ³¨å…¥è¾“å‡ºå·¥ä»¶ï¼Œå› ä¸ºå¼€å‘äººå‘˜å¯èƒ½ä¼šç¯¡æ”¹è¾“å‡ºã€‚è¿™æ„å‘³ç€è·¨ç”¨æˆ·è¿œç¨‹ç¼“å­˜åªèƒ½ä»æ— æ³•ç¯¡æ”¹çš„æœºå™¨å¡«å……ã€‚ ï¼ˆå¦‚æœåœ¨ç”¨æˆ·èº«ä¸Šæœªä½¿ç”¨ç¼“å­˜ï¼Œåˆ™æ— éœ€é¢å¤–çš„é¢„é˜²æªæ–½ã€‚ï¼‰è¿™äº›å¯ä¿¡æºæœ‰ä¸¤ç§å½¢å¼ï¼š</p><p> The first one, and the one thatâ€™s easy to apply almost in any case, are CI runs. CI runs happen on machines that are not (and should not be!) directly accessible by the larger engineering population, thus we can trust that the output they generate comes precisely from the code and tools that were fed to them.</p><p> ç¬¬ä¸€ä¸ªï¼Œå¹¶ä¸”æ˜“äºåœ¨ä»»ä½•æƒ…å†µä¸‹æ˜“äºåº”ç”¨çš„é‚£ä¸ªæ˜¯CIè¿è¡Œã€‚ CIè¿è¡Œåœ¨æ²¡æœ‰ï¼ˆä¸åº”è¯¥æ˜¯ï¼ï¼‰çš„æœºå™¨ä¸Šï¼Œé€šè¿‡è¾ƒå¤§çš„å·¥ç¨‹äººå£ç›´æ¥è®¿é—®ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¿¡ä»»ä»–ä»¬ç”Ÿæˆçš„è¾“å‡ºç²¾ç¡®åœ°ä»é€åˆ°å®ƒä»¬çš„ä»£ç å’Œå·¥å…·ä¸­ã€‚</p><p> The second one, and the one thatâ€™s more subtle, are user-initiated builds. When an engineer is building on their workstation, we  can cache their build outputs across users  if we generate those outputs using a trusted environment. Such a trusted environment comes in the form of  remote execution. Under a remote execution scenario, the build machine sends individual build actions to a remote service. This service, which is trusted too, runs actions on behalf of the user, but the user doesnâ€™t have a chance to interfere with the outputs before they are saved into the cache.</p><p> ç¬¬äºŒä¸ªï¼Œå’Œæ›´å¾®å¦™çš„é‚£ä¸ªæ˜¯ç”¨æˆ·å¯åŠ¨çš„æ„å»ºã€‚å½“å·¥ç¨‹å¸ˆåœ¨å·¥ä½œç«™ä¸Šæ„å»ºæ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å¯ä¿¡ç¯å¢ƒç”Ÿæˆè¿™äº›è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç”¨æˆ·ç¼“å­˜å…¶æ„å»ºè¾“å‡ºã€‚è¿™ç§å¯ä¿¡ç¯å¢ƒä»¥è¿œç¨‹æ‰§è¡Œçš„å½¢å¼å‡ºç°ã€‚åœ¨è¿œç¨‹æ‰§è¡Œæ–¹æ¡ˆä¸‹ï¼Œæ„å»ºè®¡ç®—æœºå°†å„ä¸ªæ„å»ºæ“ä½œå‘é€åˆ°è¿œç¨‹æœåŠ¡ã€‚è¿™é¡¹æœåŠ¡ä¹Ÿæ˜¯å€¼å¾—ä¿¡èµ–çš„ï¼Œä»£è¡¨ç”¨æˆ·è¿è¡Œæ“ä½œï¼Œä½†ç”¨æˆ·åœ¨å°†è¾“å‡ºä¿å­˜åˆ°ç¼“å­˜ä¹‹å‰ï¼Œç”¨æˆ·æ²¡æœ‰æœºä¼šå¹²æ‰°è¾“å‡ºã€‚</p><p> You might think that a compromised compiler is an attack vector in this scenario: the engineer modifies the compiler, sends it to the remote CI machine or remote execution worker to build a piece of code, and the outputs that contain malicious code are injected into the cache. But thatâ€™s not the case. Remember: the compiler is also an  input to the action, just like the source files are. If you tamper with the compiler, then the actionâ€™s signature changes, which means the cache key changes, which means nobody will be able to address such cache entry unless they have the same compromised compiler.</p><p> æ‚¨å¯èƒ½ä¼šè®¤ä¸ºå—æŸç¼–è¯‘å™¨æ˜¯è¿™ç§æƒ…å†µä¸‹çš„æ”»å‡»çŸ¢é‡ï¼šå·¥ç¨‹å¸ˆä¿®æ”¹ç¼–è¯‘å™¨ï¼Œå°†å…¶å‘é€åˆ°è¿œç¨‹CIæœºå™¨æˆ–è¿œç¨‹æ‰§è¡Œå·¥ä½œäººå‘˜ä»¥æ„å»ºä¸€æ®µä»£ç ï¼Œå¹¶å°†åŒ…å«æ¶æ„ä»£ç çš„è¾“å‡ºæ³¨å…¥åˆ°å…¶ä¸­ç¼“å­˜ã€‚ä½†é‚£ä¸æ˜¯è¿™ç§æƒ…å†µã€‚è¯·è®°ä½ï¼šç¼–è¯‘å™¨ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹åŠ¨ä½œçš„è¾“å…¥ï¼Œå°±åƒæºæ–‡ä»¶ä¸€æ ·ã€‚å¦‚æœä½¿ç”¨ç¼–è¯‘å™¨ç¯¡æ”¹ï¼Œåˆ™æ“ä½œçš„ç­¾åæ›´æ”¹ï¼Œè¿™æ„å‘³ç€ç¼“å­˜å¯†é’¥æ›´æ”¹ï¼Œè¿™æ„å‘³ç€é™¤éå®ƒä»¬å…·æœ‰ç›¸åŒçš„å—æŸç¼–è¯‘å™¨ï¼Œå¦åˆ™æ— äººèƒ½å¤Ÿè§£å†³æ­¤ç±»ç¼“å­˜æ¡ç›®ã€‚</p><p> In the end, you want to take both approaches. You want periodic CI runs to populate the cache as these ensure that the cache is frequently repopulated from HEAD. And you want to incrementally cache outputs that originate from interactive builds and PRs to keep up with drift and to keep up with possible divergences in the configurations that they use.</p><p> æœ€ç»ˆï¼Œæ‚¨æƒ³é‡‡å–ä¸¤ç§æ–¹æ³•ã€‚æ‚¨å¸Œæœ›å®šæœŸCIè¿è¡Œä»¥å¡«å……ç¼“å­˜ï¼Œå› ä¸ºè¿™äº›ç¼“å­˜ç¡®ä¿ç¼“å­˜ç»å¸¸ä»å¤´é‡æ–°å¡«å……ã€‚å¹¶ä¸”æ‚¨å¸Œæœ›é€æ­¥é€æ­¥æºè‡ªäº¤äº’å¼æ„å»ºå’ŒPRSçš„ç¼“å­˜è¾“å‡ºï¼Œä»¥è·Ÿä¸Šæ¼‚ç§»ï¼Œå¹¶åœ¨å…¶ä½¿ç”¨çš„é…ç½®ä¸­è·Ÿä¸Šå¯èƒ½çš„åˆ†æ­§ã€‚</p><p> As long as users stick to the blessed configurations discussed in the previous section, and as long as you have these sources of data to populate the cache, then you should start seeing high cache hit ratios and faster build times overall.</p><p> åªè¦ç”¨æˆ·åšæŒä¸Šä¸€èŠ‚ä¸­è®¨è®ºçš„ç¬¦åˆç¥ç¦çš„é…ç½®ï¼Œåªè¦æ‚¨æ‹¥æœ‰è¿™äº›æ•°æ®æ¥æºæ¥å¡«å……ç¼“å­˜ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥å¼€å§‹çœ‹åˆ°é«˜ç¼“å­˜å‘½ä¸­æ¯”ç‡å¹¶æ›´å¿«åœ°æ„å»ºæ—¶é—´ã€‚ </p><p>  Definitely. Iâ€™m a believer that they are good, and not only because of Google: the BSDs taught me this principle a very long time ago. That said, itâ€™s true that they can be a poor choice unless your engineering practices and tools keep up, which as mentioned in the opening, can be extremely expensive. If you cannot afford the cost, it might be better to stay with multiple smaller repositories and let smaller groups of developers handle them in an ad-hoc manner. The whole wonâ€™t be as nice, but the overall experience might be less frustrating.</p><p>ç¡®å®ã€‚æˆ‘æ˜¯ä¸€ä¸ªä¿¡å¾’ï¼Œä»–ä»¬å¾ˆå¥½ï¼Œä¸ä»…å› ä¸ºè°·æ­Œï¼šå¾ˆä¹…ä»¥å‰å°±æ•™æˆ‘è¿™ä¸ªåŸç†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤éæ‚¨çš„å·¥ç¨‹å®è·µå’Œå·¥å…·è·Ÿä¸Šï¼Œé™¤éæ‚¨çš„å·¥ç¨‹å®è·µå’Œå·¥å…·è·Ÿä¸Šï¼Œè¿™å¯èƒ½æ˜¯è¾ƒå·®çš„é€‰æ‹©ï¼Œè¿™å¯ä»¥éå¸¸æ˜‚è´µã€‚å¦‚æœæ‚¨æ— æ³•è´Ÿæ‹…æˆæœ¬ï¼Œåˆ™å¯ä»¥æ›´å¥½åœ°ç•™åœ¨å¤šä¸ªè¾ƒå°çš„å­˜å‚¨åº“ä¸­ï¼Œå¹¶è®©è¾ƒå°çš„å¼€å‘äººå‘˜ç»„ä»¥ad-hocæ–¹å¼å¤„ç†å®ƒä»¬ã€‚æ•´ä½“ä¸ä¼šé‚£ä¹ˆå¥½ï¼Œä½†æ•´ä½“ç»éªŒå¯èƒ½ä¸é‚£ä¹ˆä»¤äººæ²®ä¸§ã€‚</p><p> In the end, monorepos are an â€œimplementation detailâ€ of bundling multiple separate components in one place. Having a monorepo should  not imply that you must build the whole thing every time you make a change. Having multiple repositories should not mean that they are isolated islands. And the latter is, precisely, what we are trying to prove in my current team: we want to see how well we can integrate smaller repositories without actually being a monorepo. Because, with suboptimal toolingâ€¦ build times are not the only problem. Source control is another major one: Git, if you happen to use it, is not the greatest choice for monorepos.</p><p> æœ€åï¼ŒMonoreposæ˜¯ä¸€ä¸ªâ€œå®æ–½ç»†èŠ‚â€ï¼Œå®ƒåœ¨ä¸€ä¸ªåœ°æ–¹æ†ç»‘å¤šä¸ªå•ç‹¬çš„ç»„ä»¶ã€‚æ‹¥æœ‰ä¸€ä¸ªmonorepoä¸åº”æš—ç¤ºæ¯æ¬¡æ”¹å˜æ—¶éƒ½å¿…é¡»å»ºç«‹æ•´ä¸ªä¸œè¥¿ã€‚æ‹¥æœ‰å¤šä¸ªå­˜å‚¨åº“ä¸åº”è¯¥æ„å‘³ç€å®ƒä»¬æ˜¯å­¤ç«‹çš„å²›å±¿ã€‚åè€…æ°æ°æ˜¯æˆ‘ä»¬è¯•å›¾åœ¨æˆ‘å½“å‰çš„å›¢é˜Ÿä¸­è¯æ˜çš„ä¸œè¥¿ï¼šæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°æˆ‘ä»¬å¦‚ä½•åœ¨æ²¡æœ‰å®é™…ä½œä¸ºmonorepoçš„æƒ…å†µä¸‹é›†æˆè¾ƒå°çš„å­˜å‚¨åº“ã€‚å› ä¸ºï¼Œå…·æœ‰æ¬¡ä¼˜å·¥å…·...æ„å»ºæ—¶é—´ä¸æ˜¯å”¯ä¸€çš„é—®é¢˜ã€‚æºæ§åˆ¶æ˜¯å¦ä¸€ä¸ªä¸»è¦çš„ä¸€ä¸ªï¼šgitï¼Œå¦‚æœä½ ç¢°å·§ä½¿ç”¨å®ƒï¼Œä¸æ˜¯monoreposçš„æœ€å¤§é€‰æ‹©ã€‚</p><p>  If you enjoyed this post, subscribe to this blog to keep up with two upcoming, related topics! One will be on ensuring build times remain low once we have achieved them; and the other may be on how Google keeps test runs on CI fast.</p><p>  å¦‚æœæ‚¨å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·è®¢é˜…æ­¤åšå®¢ä»¥è·Ÿä¸Šä¸¤ä¸ªå³å°†åˆ°æ¥çš„ç›¸å…³ä¸»é¢˜ï¼ä¸€æ—¦æˆ‘ä»¬è¾¾åˆ°äº†ä»–ä»¬ï¼Œå°±ä¼šç¡®ä¿å»ºè®¾æ—¶é—´ä»ç„¶å¾ˆä½;å¦ä¸€ä¸ªå¯èƒ½æ˜¯Googleå¦‚ä½•åœ¨CIä¸Šä¿æŒæµ‹è¯•è¿è¡Œã€‚ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://jmmv.dev/2021/02/google-monorepos-and-caching.html">https://jmmv.dev/2021/02/google-monorepos-and-caching.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/è°·æ­Œ/">#è°·æ­Œ</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ä¿æŒ/">#ä¿æŒ</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/build/">#build</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/æ„å»º/">#æ„å»º</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è°·æ­Œ/">#è°·æ­Œ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>