<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>å¦‚ä½•åœ¨2021å¹´åˆ¶ä½œä¸€ä¸ªPythonåŒ… How to make a Python package in 2021</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">How to make a Python package in 2021<br/>å¦‚ä½•åœ¨2021å¹´åˆ¶ä½œä¸€ä¸ªPythonåŒ… </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-08 10:12:08</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/4/daacc23b71e491fecf6eb28f7ad0be78.png"><img src="http://img2.diglog.com/img/2021/4/daacc23b71e491fecf6eb28f7ad0be78.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>If you are like me, every once in a while you write a useful python utility and want to share it with your colleagues. The best way to do this is to make a package: it easy to install and saves from copy-pasting.</p><p>å¦‚æœæ‚¨å–œæ¬¢æˆ‘ï¼Œæ¯æ¬¡å¶å°”éƒ½ä¼šå†™ä¸€ä¸ªæœ‰ç”¨çš„Pythonå®ç”¨ç¨‹åºï¼Œå¹¶å¸Œæœ›ä¸åŒäº‹åˆ†äº«å®ƒã€‚è¿™æ ·åšçš„æœ€ä½³æ–¹æ³•æ˜¯åˆ¶ä½œä¸€ä¸ªåŒ…ï¼šæ˜“äºå®‰è£…å¹¶ä»å¤å°ç²˜è´´ä¸­ä¿å­˜ã€‚</p><p> If you are like me, you might be thinking that creating packages is a real headache. Well, thatâ€™s not the case anymore. And I am going to prove it with this step-by-step guide. Just three main steps (and a bunch of optional ones) accompanied by few GitHub links. See for yourself:</p><p> å¦‚æœä½ åƒæˆ‘ä¸€æ ·ï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºåˆ›å»ºåŒ…æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¤´ç—›ã€‚å¥½å§ï¼Œè¿™ä¸æ˜¯è¿™ç§æƒ…å†µã€‚æˆ‘å°†é€šè¿‡è¿™ä¸ªé€æ­¥çš„æŒ‡å—æ¥è¯æ˜å®ƒã€‚åªæœ‰ä¸‰ä¸ªä¸»è¦æ­¥éª¤ï¼ˆä»¥åŠä¸€å †å¯é€‰çš„æ­¥éª¤ï¼‰ä¼´éšç€å‡ ä¸ªGitHubé“¾æ¥ã€‚ä½ è‡ªå·±çœ‹ï¼š</p><p>  We will create  podsearch - a utility that searches for podcasts in iTunes. Letâ€™s create a directory and a virtual environment:</p><p>  æˆ‘ä»¬å°†åˆ›å»ºPodsearch  - ä¸€ä¸ªå®ç”¨ç¨‹åºï¼Œç”¨äºæœç´¢iTunesä¸­çš„æ’­å®¢ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç›®å½•å’Œè™šæ‹Ÿç¯å¢ƒï¼š</p><p>    &#34;&#34;&#34;Let&#39;s find some podcasts!&#34;&#34;&#34;  __version__  =  &#34;0.1.0&#34;  def  search ( name ,  count = 5 ):  &#34;&#34;&#34;Search podcast by name.&#34;&#34;&#34;  raise  NotImplementedError ()</p><p>    ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;æ‰¾åˆ°ä¸€äº›æ’­å®¢ï¼ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;ï¼†ï¼ƒ34; __version__ =ï¼†ï¼ƒ34; 0.1.0ï¼†ï¼ƒ34; defæœç´¢ï¼ˆåç§°ï¼Œcount = 5ï¼‰ï¼šï¼†ï¼ƒ34;ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;æŒ‰åç§°æœç´¢æ’­å®¢ã€‚ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;æå‡NotimplementedErrorï¼ˆï¼‰</p><p>  Creating a package in Python used to be a troublesome task. Fortunately, nowadays there is a great little  flit utility which simplifies everything. Letâ€™s install it:</p><p>  åœ¨Pythonä¸­åˆ›å»ºä¸€ä¸ªåŒ…æ›¾ç»æ˜¯ä¸€ä¸ªéº»çƒ¦çš„ä»»åŠ¡ã€‚å¹¸è¿çš„æ˜¯ï¼Œå¦‚ä»Šæœ‰ä¸€ä¸ªå¾ˆå¤§çš„å°ç¢ç‰‡å®ç”¨ç¨‹åºï¼Œç®€åŒ–äº†ä¸€åˆ‡ã€‚è®©æˆ‘ä»¬å®‰è£…å®ƒï¼š</p><p>   $ flit initModule name [podsearch]:Author [Anton Zhiyanov]:Author email [m@antonz.org]:Home page [https://github.com/nalgeon/podsearch-py]:Choose a license (see http://choosealicense.com/ for more info)1. MIT - simple and permissive2. Apache - explicitly grants patent rights3. GPL - ensures that code based on this is shared with the same terms4. Skip - choose a license laterEnter 1-4 [1]: 1Written pyproject.toml; edit that file to add optional extra info.</p><p>   $ flit initmodule name [podsearch]ï¼šauthor [anton zhiyanov]ï¼šä½œè€…ç”µå­é‚®ä»¶[m@antonz.org]ï¼šä¸»é¡µ[https://github.com/nalgeon/podsearch-pyï¼šschooseä¸€ä¸ªè®¸å¯è¯ï¼ˆè¯·å‚é˜…httpï¼š/ /choosealicense.com/è·å–æ›´å¤šä¿¡æ¯ï¼‰1ã€‚éº»çœç†å·¥å­¦é™¢ - ç®€å•å’Œæ‚æ•£2ã€‚ Apache  - æ˜ç¡®æˆäºˆä¸“åˆ©æƒ3ã€‚ GPL  - ç¡®ä¿åŸºäºæ­¤çš„ä»£ç ä¸ç›¸åŒçš„æ¡æ¬¾4å…±äº«ã€‚è·³è¿‡ - é€‰æ‹©License WelderEnter 1-4 [1]ï¼š1å†™pyproject.toml;ç¼–è¾‘è¯¥æ–‡ä»¶ä»¥æ·»åŠ å¯é€‰çš„é¢å¤–ä¿¡æ¯ã€‚</p><p>  Flit has created  pyproject.toml - the project metadata file. It already has everything you need to publish the package to the public repository - PyPI.</p><p>  Flitå·²åˆ›å»ºpyproject.toml  - é¡¹ç›®å…ƒæ•°æ®æ–‡ä»¶ã€‚å®ƒå·²ç»æ‹¥æœ‰å°†åŒ…å‘å¸ƒåˆ°å…¬å…±å­˜å‚¨åº“ -  PYPIæ‰€éœ€çš„ä¸€åˆ‡ã€‚ </p><p> Sign up for  TestPyPi (test repository) and  PyPI (the main one). They are completely independent, so you will need two accounts.</p><p>æ³¨å†ŒTestPypiï¼ˆæµ‹è¯•å­˜å‚¨åº“ï¼‰å’ŒPYPIï¼ˆä¸»è¦æ˜¯ä¸€ä¸ªï¼‰ã€‚å®ƒä»¬æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥ä½ éœ€è¦ä¸¤ä¸ªå¸æˆ·ã€‚</p><p>  [distutils]index-servers = pypi pypitest[pypi]username: nalgeon # replace with your PyPI username[pypitest]repository: https://test.pypi.org/legacy/username: nalgeon # replace with your TestPyPI username</p><p>  [stortutils]ç´¢å¼•æœåŠ¡å™¨= pypi pypitest [pypi]ç”¨æˆ·åï¼šnalgeonï¼ƒç”¨æ‚¨çš„Pypiç”¨æˆ·å[PypiTest]å­˜å‚¨åº“ï¼šhttpsï¼š//test.pypi.org/legacy/usernameï¼šnalgeonï¼ƒreplyä¸æ‚¨çš„testpypiç”¨æˆ·åæ›¿æ¢</p><p>      # ... SEARCH_URL  =  &#34;https://itunes.apple.com/search&#34; @ dataclass class  Podcast :  &#34;&#34;&#34;Podcast metadata.&#34;&#34;&#34;  id :  str  name :  str  author :  str  url :  str  feed :  Optional [ str ]  =  None  category :  Optional [ str ]  =  None  image :  Optional [ str ]  =  None def  search ( name :  str ,  limit :  int  =  5 )  -&gt;  List [ Podcast ]:  &#34;&#34;&#34;Search podcast by name.&#34;&#34;&#34;  params  =  { &#34;term&#34; :  name ,  &#34;limit&#34; :  limit ,  &#34;media&#34; :  &#34;podcast&#34; }  response  =  _get ( url = SEARCH_URL ,  params = params )  return  _parse ( response )</p><p>      ï¼ƒ...æœç´¢_url =ï¼†ï¼ƒ34; httpsï¼š//itunes.apple.com/search&#34; @ dataclassç±»æ’­å®¢ï¼šï¼†ï¼ƒ34;ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;æ’­å®¢å…ƒæ•°æ®ã€‚ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;ï¼†ï¼ƒ34; IDï¼šstråç§°ï¼šsträ½œè€…ï¼šstr URLï¼šstr efferï¼šå¯é€‰[str] =æ— ç±»åˆ«ï¼šå¯é€‰[str] =æ— å›¾åƒï¼šå¯é€‰[str] = none defæœç´¢ï¼ˆåç§°ï¼šstrï¼Œlimitï¼šint = 5ï¼‰ - ï¼†gt;åˆ—è¡¨[æ’­å®¢]ï¼šï¼†ï¼ƒ34;ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;æŒ‰åç§°æœç´¢æ’­å®¢ã€‚ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;ï¼†ï¼ƒ34; params = {ï¼†ï¼ƒ34;æœ¯è¯­ï¼†ï¼ƒ34; ï¼šå§“åï¼Œï¼†ï¼ƒ34;é™åˆ¶ï¼†ï¼ƒ34; ï¼šé™åˆ¶ï¼Œï¼†ï¼ƒ34;åª’ä½“ï¼†ï¼ƒ34; ï¼šï¼†ï¼ƒ34;æ’­å®¢ï¼†ï¼ƒ34; }å“åº”= _getï¼ˆurl = search_urlï¼Œparams = paramsï¼‰è¿”å›_parseï¼ˆå“åº”ï¼‰</p><p> And publish to the main repository - PyPI. Perform this step only after your package has working code that does something useful. Do not publish non-working packages and stubs.</p><p> å¹¶å‘å¸ƒåˆ°ä¸»å­˜å‚¨åº“ -  PYPIã€‚ä»…åœ¨æ‚¨çš„åŒ…å…·æœ‰æœ‰ç”¨çš„å·¥ä½œä»£ç åæ‰æ‰§è¡Œæ­¤æ­¥éª¤ã€‚ä¸è¦å‘å¸ƒéå·¥ä½œåŒ…å’Œå­˜æ ¹ã€‚</p><p>   To make the package a pleasure to use, I recommend that you follow a few more steps.</p><p>   è¦ä½¿åŒ…è£…æ„‰å¿«ä½¿ç”¨ï¼Œæˆ‘å»ºè®®æ‚¨éµå¾ªæ›´å¤šæ­¥éª¤ã€‚</p><p>  No one likes to write documentation. But without docs, it is unlikely that people will want to install your package, so letâ€™s add  README.md and  CHANGELOG.md.</p><p>  æ²¡æœ‰äººå–œæ¬¢å†™æ–‡æ¡£ã€‚ä½†æ²¡æœ‰æ–‡æ¡£ï¼Œäººä»¬ä¸å¤ªå¯èƒ½æƒ³è¦å®‰è£…åŒ…ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ·»åŠ Readme.mdå’Œchangelog.mdã€‚</p><p>          Letâ€™s take care of formatting ( black), test coverage ( coverage), code quality ( flake8,  pylint,  mccabe), and static analysis ( mypy). We will run everything through  tox.</p><p>          è®©æˆ‘ä»¬ç…§é¡¾æ ¼å¼ï¼ˆé»‘è‰²ï¼‰ï¼Œæµ‹è¯•è¦†ç›–èŒƒå›´ï¼ˆè¦†ç›–èŒƒå›´ï¼‰ï¼Œä»£ç è´¨é‡ï¼ˆFlake8ï¼ŒPylintï¼ŒMcCabeï¼‰å’Œé™æ€åˆ†æï¼ˆMypyï¼‰ã€‚æˆ‘ä»¬å°†é€šè¿‡TOXè¿è¡Œä¸€åˆ‡ã€‚ </p><p>   [tox]isolated_build = Trueenvlist = py37,py38,py39[testenv]deps = black coverage flake8 mccabe mypy pylint pytestcommands = black podsearch flake8 podsearch pylint podsearch mypy podsearch coverage erase coverage run --include=podsearch/* -m pytest -ra coverage report -m</p><p>[tox]å­¤ç«‹çš„_build = tighenvlist = py37ï¼Œpy37ï¼Œpy38ï¼Œpy39 [testenv] deps =é»‘è‰²è¦†ç›–èŒƒå›´=é»‘è‰²è¦†ç›–ç‡flake8 mccabe mype pylint pytestcommands =é»‘è‰²podsearch flake8 podsearch pylint podsearch mype podsearchè¦†ç›–æ“¦é™¤è¦†ç›–è¦†ç›–è¿è¡Œ--include = podsearch / * -m pytest -raè¦†ç›–èŒƒå›´æŠ¥å‘Š-M.</p><p>   $ tox -e py39...py39 run-test: commands[0] | black podsearchAll done! âœ¨ ğŸ° âœ¨...py39 run-test: commands[2] | pylint podsearchYour code has been rated at 10.00/10 (previous run: 10.00/10, +0.00)...py39 run-test: commands[6] | coverage report -mTOTAL 100%...py39: commands succeededcongratulations :)</p><p>   $ tox -e py39 ... py39 run-testï¼šå‘½ä»¤[0] | Black Podsearchallå®Œæˆï¼ âœ¨ğŸ°âœ¨... py39 run-testï¼šå‘½ä»¤[2] | Pylint Podsearchyourä»£ç å·²è¢«è¯„ä¸º10.00 / 10ï¼ˆä»¥å‰çš„è¿è¡Œï¼š10.00 / 10ï¼Œ+0.00ï¼‰... py39 run-testï¼šå‘½ä»¤[6] | Coverage Report -Mtotal 100ï¼…... py39ï¼šå‘½ä»¤æˆåŠŸæ¦‚å¿µ:)</p><p>   Every solid open-source project runs cloud tests after each commit, so we will too. A nice side effect is having beautiful badges in the readme ãƒ„</p><p>   æ¯æ¬¡æäº¤åï¼Œæ¯ä¸ªå›ºä½“å¼€æºé¡¹ç›®éƒ½ä¼šè¿è¡Œäº‘æµ‹è¯•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿä¼šè¿è¡Œã€‚ä¸€ä¸ªæ¼‚äº®çš„å‰¯ä½œç”¨æ˜¯åœ¨è‡ªè¿°æ–‡ä»¶ä¸­æœ‰ç¾ä¸½çš„å¾½ç« </p><p> Letâ€™s build the project with  GitHub Actions, check test coverage with  Codecov and code quality with  Code Climate.</p><p> è®©æˆ‘ä»¬ç”¨githubåŠ¨ä½œæ„å»ºé¡¹ç›®ï¼Œæ£€æŸ¥ç”¨CodeCovå’Œä»£ç è´¨é‡çš„æµ‹è¯•è¦†ç›–ï¼Œä»£ç æ°”å€™ã€‚</p><p> You will have to sign up for Codecov and Code Climate (both support GitHub login) and enable package repository in the settings.</p><p> æ‚¨å¿…é¡»æ³¨å†ŒCodecovå’ŒCode Climateï¼ˆæ”¯æŒGitHubç™»å½•ï¼‰å¹¶åœ¨è®¾ç½®ä¸­å¯ç”¨åŒ…å­˜å‚¨åº“ã€‚</p><p>  # ... jobs :  build :  runs-on :  ubuntu-latest  strategy :  matrix :  python-version :  [ 3.7 ,  3.8 ,  3.9 ]  env :  USING_COVERAGE :  &#34; 3.9&#34;  steps :  -  name :  Checkout sources  uses :  actions/checkout@v2  -  name :  Set up Python  uses :  actions/setup-python@v2  with :  python-version :  $  -  name :  Install dependencies  run :  |  python -m pip install --upgrade pip  python -m pip install black coverage flake8 flit mccabe mypy pylint pytest tox tox-gh-actions  -  name :  Run tox  run :  |  python -m tox  -  name :  Upload coverage to Codecov  uses :  codecov/codecov-action@v1  if :  contains(env.USING_COVERAGE, matrix.python-version)  with :  fail_ci_if_error :  true</p><p>  ï¼ƒ...å·¥ä½œï¼šæ„å»ºï¼šruns-onï¼šubuntu-æœ€æ–°ç­–ç•¥ï¼šçŸ©é˜µï¼špython-versionï¼š[3.7,3.8,3.9] envï¼šä½¿ç”¨_coverageï¼šï¼†ï¼ƒ34; 3.9ï¼†ï¼ƒ34;æ­¥éª¤ï¼š - å§“åï¼šç»“å¸æºä½¿ç”¨ï¼šæ“ä½œ/ checkout @ v2  - åç§°ï¼šè®¾ç½®pythonä½¿ç”¨ï¼šæ“ä½œ/ setup-python @ v2 withï¼špython-versionï¼š$  -  nameï¼šå®‰è£…ä¾èµ–é¡¹è¿è¡Œï¼š| Python -M pipå®‰è£… -  upgrade pip python-m pipå®‰è£…é»‘è‰²è¦†ç›–ç‡flake8 flites mccabe mypy pylint pytest tox tox-gh-action  -  nameï¼šè¿è¡Œtoxè¿è¡Œï¼š| Python -M Tox  - åç§°ï¼šä¸Šä¼ CodeCovä½¿ç”¨ï¼šCodeCov / CodeCov-Action @ V1 IFï¼šåŒ…å«ï¼ˆenv.using_coverageï¼Œmatrix.python-versionï¼‰withï¼šfail_ci_if_errorï¼štrue</p><p>  GitHub runs tests via  tox - just as we did.  tox-gh-actions package and  USING_COVERAGE settings ensure that  tox uses the same Python version as GitHub Actions themself, as required by  strategy.matrix (I learned this clever trick from  Hynek Schlawak).</p><p>  githubé€šè¿‡toxè¿è¡Œæµ‹è¯• - å°±åƒæˆ‘ä»¬æ‰€åšçš„é‚£æ ·ã€‚ Tox-GH-Actions Packageå’Œä½¿ç”¨_Coverageè®¾ç½®ç¡®ä¿Toxä½¿ç”¨ä¸Transtratem.Matrixï¼ˆæˆ‘å­¦ä¹ æ¥è‡ªHynek Schlawakï¼‰çš„èªæ˜ä¼ä¿©ï¼‰ä½œä¸ºGitHubæ“ä½œçš„ç›¸åŒPythonç‰ˆæœ¬ã€‚ </p><p> The last step sends test coverage to Codecov. Code Climate does not need a separate step - it spots repository changes automatically.</p><p>æœ€åä¸€æ­¥å‘Codecovå‘é€æµ‹è¯•è¦†ç›–èŒƒå›´ã€‚ä»£ç æ°”å€™ä¸éœ€è¦å•ç‹¬çš„æ­¥éª¤ - å®ƒæ–‘ç‚¹å­˜å‚¨åº“è‡ªåŠ¨æ›´æ”¹ã€‚</p><p> Now commit, push, and enjoy the result in a minute. And let everyone enjoy as well - add badges to  README.md:</p><p> ç°åœ¨æäº¤ï¼Œæ¨ï¼Œäº«å—ä¸€åˆ†é’Ÿçš„ç»“æœã€‚è®©æ¯ä¸ªäººéƒ½å–œæ¬¢äº«å— - ä¸ºReadme.mdæ·»åŠ å¾½ç« ï¼š</p><p> [ ![PyPI Version ][ pypi-image ]][pypi-url] [ ![Build Status ][ build-image ]][build-url] [ ![Code Coverage ][ coverage-image ]][coverage-url] [ ![Code Quality ][ quality-image ]][quality-url]... &lt;!-- Badges --&gt; [ pypi-image ]:  https://img.shields.io/pypi/v/podsearch [ pypi-url ]:  https://pypi.org/project/podsearch/ [ build-image ]:  https://github.com/nalgeon/podsearch-py/actions/workflows/build.yml/badge.svg [ build-url ]:  https://github.com/nalgeon/podsearch-py/actions/workflows/build.yml [ coverage-image ]:  https://codecov.io/gh/nalgeon/podsearch-py/branch/main/graph/badge.svg [ coverage-url ]:  https://codecov.io/gh/nalgeon/podsearch-py [ quality-image ]:  https://api.codeclimate.com/v1/badges/3130fa0ba3b7993fbf0a/maintainability [ quality-url ]:  https://codeclimate.com/github/nalgeon/podsearch-py</p><p> [ï¼[PYPIç‰ˆæœ¬] [PYPI-IMAGE]] [PYPI-URL] [ï¼[æ„å»ºçŠ¶æ€] [æ„å»ºå›¾åƒ]] [æ„å»º -  url] [ï¼[ä»£ç è¦†ç›–] [coverage-image]] [coverage-url ] [ï¼[ä»£ç è´¨é‡] [è´¨é‡å›¾åƒ]] [è´¨é‡ -  url] ...ï¼†lt;ï¼ - å¾½ç«  - ï¼†gt; [PYPI-IMAGE]ï¼šhttps://img.shields.io/pypi/v/podsearch [pypi-url]ï¼šhttps://pypi.org/project/podsearch/ [build-image]ï¼šhttpsï¼š// github .com / nalgeon / podsearch-py /æ“ä½œ/ workflows / build.yml / badge.svg [build-url]ï¼šhttpsï¼š//github.com/nalgeon/podsearch-py/actions/workflows/build.yml [coverage-å›¾åƒ]ï¼šhttps://codecov.io/gh/nalgeon/podsearch-py/branch/main/graph/badge.svg [coverage-url]ï¼šhttpsï¼š//codecov.io/gh/nalgeon/podsearch-py [è´¨é‡å½¢è±¡]ï¼šhttps://api.codeClimate.com/v1/badges/3130fa0ba3b7993fbf0a/maintainability [è´¨é‡url]ï¼šhttpsï¼š//codeclimate.com/github/nalgeon/podsearch-py</p><p>    tox is fine, but not very handy for development. Itâ€™s faster to run individual commands like  pylint,  coverage etc. But they are quite verbose, so weâ€™ll automate the boring stuff.</p><p>    TOXå¾ˆå¥½ï¼Œä½†ä¸èƒ½å¾ˆæ–¹ä¾¿å¼€å‘ã€‚è¿è¡ŒPylintï¼Œè¦†ç›–èŒƒå›´ç­‰çš„ä¸ªåˆ«å‘½ä»¤æ›´å¿«ï¼Œä½†å®ƒä»¬éå¸¸å†—é•¿ï¼Œå› æ­¤æˆ‘ä»¬å°†è‡ªåŠ¨åŒ–æ— èŠçš„ä¸œè¥¿ã€‚</p><p>  .DEFAULT_GOAL := help.PHONY: coverage deps help lint push testcoverage: ## Run tests with coverage	coverage erase	coverage run --include=podsearch/* -m pytest -ra	coverage report -mdeps: ## Install dependencies	pip install black coverage flake8 mccabe mypy pylint pytest toxlint: ## Lint and static-check	flake8 podsearch	pylint podsearch	mypy podsearchpush: ## Push code with tags	git push &amp;&amp; git push --tagstest: ## Run tests	pytest -ra</p><p>  .default_Goalï¼š= Help.Phonyï¼šCoverage Depså¸®åŠ©Lint Push TestCoverageï¼š##ä½¿ç”¨Coverage Coverageåˆ é™¤æµ‹è¯•åˆ é™¤è¦†ç›–èŒƒå›´--include = Podsearch / * -M PyTest -RA CoverageæŠ¥å‘Š-mdepsï¼š##å®‰è£…ä¾èµ–æ€§PIPå®‰è£…é»‘è‰²è¦†ç›–Flake8 McCabe Mypy Pylint Pytest Toxlintï¼š## Lintå’ŒStatic-Check Flake8 Podsearch Pylint Podsearch MyPy Podsearchpushï¼š##æ¨é€ä»£ç æ ‡ç­¾Git Pushï¼†amp;ï¼†amp; git push --tagstestï¼š##è¿è¡Œæµ‹è¯•pytest -ra</p><p>   $ make helpUsage: make [task]task help------ ----coverage Run tests with coveragedeps Install dependencieslint Lint and static-checkpush Push code with tagstest Run testshelp Show help message</p><p>   $ Make Helpusï¼šä½¿[ä»»åŠ¡]ä»»åŠ¡å¸®åŠ©------ ----è¦†ç›–Rockededepså®‰è£…ä¾èµ–æ€§leventiesLint Lintå’ŒStatic-Checkpushæ¨é€ä»£ç ä¸tagstestè¿è¡Œtestshelp show helpæ¶ˆæ¯</p><p>  -  name :  Install dependencies  run :  |  make deps -  name :  Run tox  run :  |  make tox</p><p>   - åç§°ï¼šå®‰è£…ä¾èµ–é¡¹è¿è¡Œï¼š| make deps  -  nameï¼šè¿è¡Œtoxè¿è¡Œï¼š|åˆ¶ä½œæ¯’ç´  </p><p>  GitHub is quite capable of running  flit publish for us. Letâ€™s create a separate workflow:</p><p>GitHubå¾ˆæœ‰èƒ½åŠ›ä¸ºæˆ‘ä»¬è¿è¡ŒFlitå‘å¸ƒã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å·¥ä½œæµç¨‹ï¼š</p><p> name :  publish on :  release :  types :  [ created ] jobs :  publish :  runs-on :  ubuntu-latest  steps :  -  name :  Checkout sources  uses :  actions/checkout@v2  -  name :  Set up Python  uses :  actions/setup-python@v2  with :  python-version :  &#34; 3.9&#34;  -  name :  Install dependencies  run :  |  make deps  -  name :  Publish to PyPi  env :  FLIT_USERNAME :  ${{ secrets.PYPI_USERNAME }}  FLIT_PASSWORD :  ${{ secrets.PYPI_PASSWORD }}  run :  |  make publish</p><p> åç§°ï¼šå‘å¸ƒONï¼šå‘å¸ƒï¼šç±»å‹ï¼š[å·²åˆ›å»º]ä½œä¸šï¼šå‘å¸ƒï¼šè¿è¡Œï¼šUbuntu-æœ€æ–°æ­¥éª¤ï¼š - åç§°ï¼šCheckoutæºä½¿ç”¨ï¼šæ“ä½œ/ checkout @ v2  - åç§°ï¼šè®¾ç½®pythonä½¿ç”¨ï¼šæ“ä½œ/ setup-python @ v2å¸¦ï¼špython-versionï¼šï¼†ï¼ƒ34; 3.9ï¼†ï¼ƒ34; - åç§°ï¼šå®‰è£…ä¾èµ–é¡¹è¿è¡Œï¼š| make deps  - åç§°ï¼šå‘å¸ƒåˆ°pypi envï¼šflit_usernameï¼š$ {{secets.pypi_username}} flit_passwordï¼š$ {{secet.pypi_password}}è¿è¡Œï¼š|å‘å¸ƒ</p><p>  PYPI_USERNAME and  PYPI_PASSWORD are set in repository settings (Settings &gt; Secrets &gt; New repository secret). Use your PyPi username and password, or even better - an  API token.</p><p>  pypi_usernameå’Œpypi_passwordè®¾ç½®åœ¨å­˜å‚¨åº“è®¾ç½®ï¼ˆè®¾ç½®ï¼†gt;ç§˜å¯†ï¼†gt;æ–°å­˜å‚¨åº“ç§˜å¯†ï¼‰ä¸­ã€‚ä½¿ç”¨æ‚¨çš„PYPIç”¨æˆ·åå’Œå¯†ç ï¼Œç”šè‡³æ›´å¥½ -  APIä»¤ç‰Œã€‚</p><p> Now GitHub will automatically publish the package as soon as you create a new release. Sweet!</p><p> ç°åœ¨GitHubä¼šåœ¨åˆ›å»ºæ–°ç‰ˆæœ¬åç«‹å³è‡ªåŠ¨å‘å¸ƒåŒ…è£¹ã€‚ç”œçš„ï¼</p><p>  Your perfect package is ready! It has everything one could dream of: clean code, clear documentation, tests, and cloud builds. Time to tell your colleagues and friends.</p><p>  ä½ çš„å®Œç¾åŒ…è£…å·²å‡†å¤‡å¥½ï¼å®ƒæœ‰ä¸€åˆ‡å¯ä»¥æ¢¦æƒ³ï¼šæ¸…æ´ä»£ç ï¼Œæ¸…æ™°çš„æ–‡æ¡£ï¼Œæµ‹è¯•å’Œäº‘æ„å»ºã€‚æ˜¯æ—¶å€™å‘Šè¯‰ä½ çš„åŒäº‹å’Œæœ‹å‹äº†ã€‚ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://antonz.org/python-packaging/">https://antonz.org/python-packaging/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/è¿è¡Œ/">#è¿è¡Œ</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è°·æ­Œ/">#è°·æ­Œ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>