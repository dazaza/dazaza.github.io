<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>x11é€šç”¨æ–‡ä»¶å¼€å…³å’Œxdgæ‚ä¹± X11 Universal File Opener and XDG Mess</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">X11 Universal File Opener and XDG Mess<br/>x11é€šç”¨æ–‡ä»¶å¼€å…³å’Œxdgæ‚ä¹± </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-23 04:34:05</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/4/6efd33160b99b6274217b3e6ed15b150.jpg"><img src="http://img2.diglog.com/img/2021/4/6efd33160b99b6274217b3e6ed15b150.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>More then a decade ago when I started to use X11 as a desktop â€“ on Linux then with  KDE3 and later with  Fluxbox. At first I thought that files are opened by appropriate applications not by their extension as in  Windows systems but according to their  Magic Numbers. I do not have to tell you how much disappointed I was when I learned the truth ğŸ™‚</p><p>å‡ åå¹´å‰æˆ‘å¼€å§‹åœ¨Linuxä¸Šä½¿ç”¨X11ä½œä¸ºæ¡Œé¢ - ç„¶åä½¿ç”¨kde3å’Œç¨åä½¿ç”¨fluxboxã€‚é¦–å…ˆï¼Œæˆ‘è®¤ä¸ºæ–‡ä»¶æ˜¯é€šè¿‡é€‚å½“çš„åº”ç”¨ç¨‹åºå¼€æ¥ï¼Œè€Œä¸æ˜¯åœ¨Windowsç³»ç»Ÿä¸­çš„æ‰©å±•ï¼Œä½†æ ¹æ®ä»–ä»¬çš„é­”æœ¯å·ç ã€‚æˆ‘ä¸å¿…å‘Šè¯‰ä½ ï¼Œå½“æˆ‘å­¦åˆ°çœŸç›¸æ—¶ï¼Œæˆ‘æœ‰å¤šå¤±æœ›â™¥</p><p> You may want to check other articles in the  FreeBSD Desktop series on the  FreeBSD Desktop â€“ Global Page where you will find links to all episodes of the series along with table of contents for each episodeâ€™s contents.</p><p> æ‚¨å¯èƒ½å¸Œæœ›åœ¨FreeBSDæ¡Œé¢ä¸ŠæŸ¥çœ‹FreeBSDæ¡Œé¢ç³»åˆ—ä¸­çš„å…¶ä»–æ–‡ç«  - å…¨å±€é¡µé¢ï¼Œæ‚¨å°†æ‰¾åˆ°ä¸è¯¥ç³»åˆ—çš„æ‰€æœ‰å‰§é›†çš„é“¾æ¥ä»¥åŠæ¯ä¸ªå‰§é›†å†…å®¹çš„ç›®å½•ã€‚</p><p>  Its a short story about cleaning the mess that XDG does and also using custom   *.desktop handlers to open the files in the way you want. It know its in the  FreeBSD Desktop series but actually it will work on any X11 desktop like  Linux or  Illumos.</p><p>  è¿™æ˜¯ä¸€ä¸ªå…³äºæ¸…ç†XDGæ‰€åšçš„æ··ä¹±çš„çŸ­ç¯‡å°è¯´ï¼Œä¹Ÿä½¿ç”¨è‡ªå®šä¹‰* .desktopå¤„ç†ç¨‹åºä»¥æ‰“å¼€æ‚¨æƒ³è¦çš„æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚å®ƒçŸ¥é“å®ƒåœ¨FreeBSDæ¡Œé¢ç³»åˆ—ä¸­ï¼Œä½†å®é™…ä¸Šå®ƒå°†åœ¨Linuxæˆ–illumosç­‰ä»»ä½•X11æ¡Œé¢ä¸Šå·¥ä½œã€‚</p><p>     After years of using X11 on FreeBSD now with  Openbox as my daily driver I used so called   xdg-utils package with its   *.desktop files. That sometimes driven me nuts. Mess everywhere with doubled â€˜the sameâ€™ applications listed as possible choices to open a file â€¦ almost randomly generated new   *.desktop handlers with â€˜newâ€™ applications specified to open some files â€¦ another dozen of generated   *.desktop files from WINE installations â€¦ it can only challenge the bullshit and mess of  Windows Registry â€¦ not sure which one is more messed up (of course its  Windows Registry but still).</p><p>     ç»è¿‡å¤šå¹´çš„FreeBSDåœ¨FreeBSDä¸Šä½¿ç”¨OpenBoxä½œä¸ºæˆ‘çš„æ¯æ—¥é©±åŠ¨ç¨‹åºæˆ‘ä½¿ç”¨æ‰€è°“çš„XDG-UtilsåŒ…ï¼Œå…¶ä¸­åŒ…å«* .desktopæ–‡ä»¶ã€‚æœ‰æ—¶ä¼šé©±ä½¿æˆ‘åšæœã€‚éšç€WADEBLEDçš„åº”ç”¨ç¨‹åºä¸­åˆ—å‡ºçš„å„ä¸ªåº”ç”¨ç¨‹åºï¼Œä»¥æ‰“å¼€æ–‡ä»¶çš„å¢åŠ ......å‡ ä¹éšæœºç”Ÿæˆçš„æ–°* .desktopå¤„ç†ç¨‹åºï¼Œå…¶ä¸­åŒ…å«æŒ‡å®šä¸ºæ‰“å¼€ä¸€äº›æ–‡ä»¶çš„â€œæ–°å»ºâ€åº”ç”¨ç¨‹åº......æ¥è‡ªWine Installationsçš„å¦ä¸€ä¸ªå·²ç”Ÿæˆçš„* .desktopæ–‡ä»¶......å®ƒ...å®ƒåªèƒ½æŒ‘æˆ˜Windowsæ³¨å†Œè¡¨çš„åºŸè¯å’Œæ··ä¹±......ä¸ç¡®å®šå“ªä¸€ä¸ªæ›´æç ¸ï¼ˆå½“ç„¶æ˜¯å®ƒçš„Windowsæ³¨å†Œè¡¨ï¼Œä½†ä»ç„¶æ˜¯ï¼‰ã€‚</p><p>   If minimalistic   mupdf approach is not for you then you can select  Atril for example â€¦ but you first need to know that is the handler name for the  Atril application. You can find that out fast like that.</p><p>   å¦‚æœMinimalistic Mupdfæ–¹æ³•ä¸é€‚åˆæ‚¨ï¼Œåˆ™å¯ä»¥é€‰æ‹©ATRIL ...ä½†æ‚¨é¦–å…ˆéœ€è¦çŸ¥é“ATRILåº”ç”¨ç¨‹åºçš„å¤„ç†ç¨‹åºåç§°ã€‚ä½ å¯ä»¥åƒé‚£æ ·æ‰¾åˆ°ã€‚</p><p>  We now have the  Atril handler name. To set it as new default application for PDF files type the following.</p><p>  æˆ‘ä»¬ç°åœ¨æœ‰å¥¥é‡Œå°”å¤„ç†ç¨‹åºåç§°ã€‚è¦å°†å…¶è®¾ç½®ä¸ºPDFæ–‡ä»¶çš„æ–°é»˜è®¤åº”ç”¨ç¨‹åºï¼Œè¯·é”®å…¥ä»¥ä¸‹å†…å®¹ã€‚</p><p>  But this is rather unique moment when XDG works as designed. More often it looks like that.</p><p>  ä½†æ˜¯å½“XDGè®¾è®¡æ—¶ï¼Œè¿™æ˜¯ç›¸å½“ç‹¬ç‰¹çš„æ—¶åˆ»ã€‚æ›´å¸¸è§çš„æ˜¯é‚£æ ·ã€‚ </p><p> $   xdg-mime query filetype FILE.docapplication/octet-stream$   xdg-mime query filetype FILE.docxapplication/zip$   xdg-mime query filetype FILE.xlsapplication/octet-stream$   xdg-mime query filetype FILE.xlsxapplication/zip</p><p>$ xdg-mimeæŸ¥è¯¢æ–‡ä»¶é”®æ–‡ä»¶.docapplication/ octet-stream $ xdg-mimeæŸ¥è¯¢filetypeæ–‡ä»¶.docxapplication / zip $ xdg-mimeæŸ¥è¯¢æ–‡ä»¶é”®æ–‡ä»¶.xlsapplication / octet-stream $ xdg-mimeæŸ¥è¯¢filetypeæ–‡ä»¶.xlsxapplication/ zip</p><p> So when you now ask for   application/zip type then what should pop up?  LibreOffice for Word/Excel documents or  Engrampa for ZIP files?</p><p> æ‰€ä»¥å½“ä½ ç°åœ¨è¦æ±‚åº”ç”¨ç¨‹åº/é‚®ç¼–ç±»å‹æ—¶ï¼Œé‚£ä¹ˆåº”è¯¥å¼¹å‡ºä»€ä¹ˆï¼Ÿ LibreOffice for Word / Excelæ–‡æ¡£æˆ–ZIPæ–‡ä»¶çš„engrampaï¼Ÿ</p><p>    After almost accepting the current â€˜tragicâ€™ state of it I came with other idea â€“ to create mine simplified launcher for many of these file types. It started small and is still quite small. The only thing I do now is that I only add new apps for file extensions that are not yet defined.</p><p>    å‡ ä¹æ¥å—å½“å‰çš„â€œæ‚²æƒ¨â€çŠ¶æ€æˆ‘æ¥åˆ°å…¶ä»–æƒ³æ³• - ä¸ºè®¸å¤šè¿™äº›æ–‡ä»¶ç±»å‹åˆ›å»ºæˆ‘çš„ç®€åŒ–å¯åŠ¨å™¨ã€‚å®ƒå¼€å§‹å°è€Œä¸”ä»ç„¶å¾ˆå°ã€‚æˆ‘ç°åœ¨å”¯ä¸€åšçš„æ˜¯æˆ‘åªä¸ºå°šæœªå®šä¹‰çš„æ–‡ä»¶æ‰©å±•åæ·»åŠ æ–°çš„åº”ç”¨ç¨‹åºã€‚</p><p> Its called    see.sh and its function is dual: â€“ to easily replace XDG settings in one place as file opener â€“ as command line opener for single or multiple files</p><p> å®ƒè¢«ç§°ä¸ºSee.shåŠå…¶åŠŸèƒ½æ˜¯åŒé‡çš„ï¼š - åœ¨ä¸€ä¸ªä½ç½®è½»æ¾æ›¿æ¢XDGè®¾ç½®ä½œä¸ºæ–‡ä»¶å¼€å…³ - ä½œä¸ºå•ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶çš„å‘½ä»¤è¡Œå¼€å…³</p><p> The construction of   see.sh is really simple. It utilizes the idea behind the quote of  Antoine de Saint-Exupery which goes like that â€“  â€œPerfection is achieved, not when there is nothing more to add, but when there is nothing left to take away.â€ â€“ its really simple and has nothing to remove from it.</p><p> See.shçš„å»ºè®¾çœŸçš„å¾ˆç®€å•ã€‚å®ƒåˆ©ç”¨äº†åƒè¿™æ ·çš„Antoine de Saint-Exuperyçš„å¼•ç”¨èƒŒåçš„æƒ³æ³• - â€œå®ç°äº†å®Œç¾ï¼Œè€Œä¸æ˜¯åœ¨æ²¡æœ‰æ·»åŠ çš„æ—¶å€™ï¼Œä½†æ˜¯å½“æ²¡æœ‰ä»€ä¹ˆå¯ä»¥å¸¦èµ°æ—¶ã€‚â€ - å®ƒçœŸçš„å¾ˆç®€å•ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥ä»ä¸­åˆ é™¤ã€‚</p><p> I really appreciate that idea that I now do not have to remember which application is needed (and how its spelled besides the   zsh(1) TAB completion) to open any file in command line. Its also faster to type then   xdg-open(1) and I am sure that its settings were not modified by some third party app that I just installed because its hardcoded in it.</p><p> æˆ‘çœŸçš„å¾ˆæ„Ÿæ¿€æˆ‘ç°åœ¨ä¸å¿…è®°ä½éœ€è¦å“ªä¸ªåº”ç”¨ç¨‹åºï¼ˆä»¥åŠé™¤äº†ZSHï¼ˆ1ï¼‰é€‰é¡¹å¡å®Œæˆä¹‹å¤–çš„æ‹¼å†™æ–¹å¼ï¼‰ä»¥åœ¨å‘½ä»¤è¡Œä¸­æ‰“å¼€ä»»ä½•æ–‡ä»¶ã€‚å®ƒä¹Ÿæ›´å¿«åœ°è¾“å…¥xdg-openï¼ˆ1ï¼‰ï¼Œæˆ‘ç›¸ä¿¡å®ƒçš„è®¾ç½®ä¸æ˜¯ç”±æˆ‘åˆšåˆšå®‰è£…çš„ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºä¿®æ”¹ï¼Œå› ä¸ºå®ƒçš„ç¡¬ç¼–ç åœ¨å…¶ä¸­ã€‚</p><p> I also really like    see.sh for being very elastic for the environment variables with which the needed application can be started. For example my default DPI for X11 session since more then a decade is 75. That makes fonts little smaller â€“ more information fits on the available screen space. The GTK2/GTK3 applications do not need any tweaks and always look decent or even great but QT5 (and QT4 not so long ago) apps are real bitches when you want to force them to look the way you want (look nice) â€“ especially when run without fully fledged KDE or PLASMA environment. One of such applications is  LibreOffice. It looked great when it used GTK framework but after they moved to QT it started to look very ugly with my 75 DPI setting. This is how it looks with its environment unmodified.</p><p> æˆ‘ä¹Ÿéå¸¸å–œæ¬¢çœ‹.SHéå¸¸æœ‰å¼¹æ€§ï¼Œå› ä¸ºå¯ä»¥å¯åŠ¨æ‰€éœ€çš„åº”ç”¨ç¨‹åºçš„ç¯å¢ƒå˜é‡ã€‚ä¾‹å¦‚ï¼Œæˆ‘çš„é»˜è®¤DPIä¸ºX11ä¼šè¯ï¼Œå› ä¸ºå¤šå¹´çš„æ•°åå¹´æ˜¯75.è¿™ä½¿å¾—å­—ä½“è¾ƒå° - æ›´å¤šä¿¡æ¯é€‚åˆå¯ç”¨çš„å±å¹•ç©ºé—´ã€‚ GTK2 / GTK3åº”ç”¨ç¨‹åºä¸éœ€è¦ä»»ä½•è°ƒæ•´ï¼Œå¹¶ä¸”å§‹ç»ˆçœ‹èµ·æ¥å¾ˆæ£’ï¼Œä½†ç”šè‡³QT5ï¼ˆå’ŒQT4ä¸æ˜¯å¾ˆä¹…ä»¥å‰ï¼‰åº”ç”¨ç¨‹åºæ˜¯çœŸæ­£çš„å©Šå­å½“ä½ æƒ³å¼ºè¿«ä»–ä»¬çœ‹èµ·æ¥ä½ æƒ³è¦çš„æ–¹å¼ï¼ˆçœ‹èµ·æ¥å¾ˆå¥½ï¼‰ - å°¤å…¶æ˜¯ä»€ä¹ˆæ—¶å€™åœ¨æ²¡æœ‰å®Œå…¨å‰¥ç¦»çš„KDEæˆ–è¡€æµ†ç¯å¢ƒçš„æƒ…å†µä¸‹è¿è¡Œã€‚å…¶ä¸­ä¸€ä¸ªåº”ç”¨ç¨‹åºæ˜¯libreofficeã€‚å½“å®ƒä½¿ç”¨GTKæ¡†æ¶æ—¶ï¼Œå®ƒçœ‹èµ·æ¥å¾ˆæ£’ï¼Œä½†åœ¨ä»–ä»¬æ¬åˆ°Qtä¹‹åï¼Œå®ƒå¼€å§‹ä¸æˆ‘çš„75 DPIè®¾ç½®éå¸¸ä¸‘é™‹ã€‚è¿™å°±æ˜¯å®ƒçš„ç¯å¢ƒå¦‚ä½•æœªç»ä¿®æ”¹ã€‚ </p><p>  Thanks to   see.sh I can start  LibreOffice with different DPI environment setting then 75 and it looks little better with DPI set to 80.  LibreOffice started with   QT_FONT_DPI=80 option does not look that bad now â€“ its fonts are not that small and ugly anymore.</p><p>æ„Ÿè°¢See.shæˆ‘å¯ä»¥ä½¿ç”¨ä¸åŒçš„DPIç¯å¢ƒè®¾ç½®å¯åŠ¨Libreofficeç„¶å75ï¼ŒDPIè®¾ç½®ä¸º80ï¼Œå®ƒçœ‹èµ·æ¥å¾ˆå°‘äº80. libreofficeä»qt_font_dpi = 80é€‰é¡¹å¼€å§‹çœ‹èµ·æ¥ä¸åƒç°åœ¨åˆä¸€æ¬¡ï¼Œå®ƒçš„å­—ä½“ä¸å†é‚£ä¹ˆç³Ÿç³•äº†ã€‚</p><p>  Now the text labels on  LibreOffice menus are more readable but also not too large.</p><p>  ç°åœ¨LibreOfficeèœå•ä¸Šçš„æ–‡æœ¬æ ‡ç­¾æ›´å¯è¯»ï¼Œä½†ä¹Ÿä¸ä¼šå¤ªå¤§ã€‚</p><p> You may also customize   see.sh to first create a backup copy before editing certain files or email them â€“ only your imagination limits you here.</p><p> æ‚¨è¿˜å¯ä»¥è‡ªå®šä¹‰See.shé¦–å…ˆåœ¨ç¼–è¾‘æŸäº›æ–‡ä»¶æˆ–å‘é€ç”µå­é‚®ä»¶ä¹‹å‰åˆ›å»ºå¤‡ä»½å‰¯æœ¬ - åªæœ‰æ‚¨çš„æƒ³è±¡åŠ›é™åˆ¶åœ¨æ­¤å¤„ã€‚</p><p> I also wanted its   see.sh name to be short and fast to type so with completions its just   see[TAB] and then a filename. Of course you may want to rename it to shorter version (or create alias) as   see without extension but i like to keep my scripts with extension to distinguish them from native commands â€“ but that is me.</p><p> æˆ‘ä¹Ÿå¸Œæœ›å®ƒçš„see.shåç§°çŸ­è€Œå¿«é€Ÿåœ°é”®å…¥ï¼Œå®Œæˆå®ƒåªæ˜¯çœ‹åˆ°[é€‰é¡¹å¡]ï¼Œç„¶åæ˜¯æ–‡ä»¶åã€‚å½“ç„¶ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å°†å…¶é‡å‘½åä¸ºæ›´çŸ­çš„ç‰ˆæœ¬ï¼ˆæˆ–åˆ›å»ºåˆ«åï¼‰ï¼Œå¦‚æ²¡æœ‰æ‰©å±•ï¼Œä½†æˆ‘å–œæ¬¢å°†è„šæœ¬ä¸æ‰©å±•åä¸æœ¬æœºå‘½ä»¤åŒºåˆ†å¼€æ¥ - ä½†è¿™æ˜¯æˆ‘ã€‚</p><p> First   see.sh detects if one or multiple arguments (files) have been passed to it. If its just a single file then   see.sh detects its extension and launches the configured application for it.</p><p> é¦–å…ˆï¼Œè¯·å‚é˜….SHæ£€æµ‹æ˜¯å¦å°†ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼ˆæ–‡ä»¶ï¼‰ä¼ é€’ç»™å®ƒã€‚å¦‚æœå®ƒåªæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¯·å‚é˜….shæ£€æµ‹å…¶æ‰©å±•å¹¶ä¸ºå…¶å¯åŠ¨å·²é…ç½®çš„åº”ç”¨ç¨‹åºã€‚</p><p>  If file does not have extension then it checks fileâ€™s  Magic Number. Currently only detection for plain text files is implemented with   file(1) command.</p><p>  å¦‚æœæ–‡ä»¶æ²¡æœ‰æ‰©å±•ï¼Œé‚£ä¹ˆå®ƒä¼šæ£€æŸ¥æ–‡ä»¶çš„é­”æœ¯å·ç ã€‚ç›®å‰ä»…ä½¿ç”¨æ–‡ä»¶ï¼ˆ1ï¼‰å‘½ä»¤å®ç°çº¯æ–‡æœ¬æ–‡ä»¶çš„æ£€æµ‹ã€‚</p><p>  If you pass multiple arguments (files) to   see.sh then separate   see.sh processes will be launched against each given file in parallel. Recursion generally.</p><p>  å¦‚æœä¼ é€’å¤šä¸ªå‚æ•°ï¼ˆæ–‡ä»¶ï¼‰ä»¥æŸ¥çœ‹ã€‚ç„¶åå•ç‹¬çš„See.shè¿›ç¨‹å°†å¹¶è¡Œåœ°å¯åŠ¨æ¯ä¸ªç»™å®šæ–‡ä»¶ã€‚ä¸€èˆ¬é€’å½’ã€‚ </p><p>  Every time you select new application in graphical mode the new   *.desktop file is created as a result with   userapp-${APPNAME}-${RANDOM_STRING}.desktop name under   ~/.local/share/applications directory. I am not sure that its the tidiest way possible. Often very ugly and strange handler filenames are generated â€“ with spaces or quotation marks. Its really far from UNIX way of doing things and its philosophy.</p><p>æ¯æ¬¡åœ¨å›¾å½¢æ¨¡å¼ä¸‹é€‰æ‹©æ–°åº”ç”¨ç¨‹åºæ—¶ï¼Œä½¿ç”¨userapp  -  $ {appname}  -  $ {random_string} .desktopåç§°ä¸‹åˆ›å»ºäº†æ–°çš„* .desktopæ–‡ä»¶.Dã€œ/ .local / share / applicationsç›®å½•ä¸‹ã€‚æˆ‘ä¸ç¡®å®šå®ƒæ˜¯æœ€çƒ­çš„æ–¹æ³•ã€‚é€šå¸¸ç”Ÿæˆéå¸¸ä¸‘é™‹å’Œå¥‡æ€ªçš„å¤„ç†ç¨‹åºæ–‡ä»¶å - å…·æœ‰ç©ºæ ¼æˆ–å¼•å·ã€‚å®ƒçœŸçš„è¿œéunixåšäº‹çš„æ–¹å¼åŠå…¶å“²å­¦ã€‚</p><p> This is how   ~/.local/share/applications directory looked on my machine after some time. Notice the selected file.</p><p> è¿™å°±æ˜¯ã€œ/ .local / share / applicationsç›®å½•åœ¨ä¸€æ®µæ—¶é—´åçœ‹ç€æˆ‘çš„æœºå™¨ã€‚æ³¨æ„æ‰€é€‰æ–‡ä»¶ã€‚</p><p>    The XDG keeps its associations in the   ~/.config/mimeapps.list file. Have a look how messed it gets after some usage.</p><p>    XDGå°†å…¶å…³è”ä¿ç•™åœ¨ã€œ/ .config / mimeapps.listæ–‡ä»¶ä¸­ã€‚åœ¨ä¸€äº›ä½¿ç”¨åçœ‹èµ·æ¥æœ‰å¤šä¹ˆæä¹±ã€‚</p><p>  After some more cleanup and removal of all unneeded   userapp-${APPNAME}-${RANDOM_STRING}.desktop entries it starts to look more organized.</p><p>  ç»è¿‡ä¸€äº›æ›´å¤šçš„æ¸…ç†å’Œåˆ é™¤æ‰€æœ‰ä¸éœ€è¦çš„Userapp  -  $ {appname}  -  $ {random_string} .desktopæ¡ç›®ï¼Œå®ƒå¼€å§‹çœ‹èµ·æ¥æ›´å…·ç»„ç»‡ã€‚</p><p>  Every time    see.sh will find out that it does not have handler for a file it will gracefully remind one to configure it.</p><p>  æ¯æ¬¡çœ‹åˆ°éƒ½ä¼šå‘ç°å®ƒæ²¡æœ‰ç”¨äºæ–‡ä»¶çš„å¤„ç†ç¨‹åºï¼Œå®ƒå°†ä¼˜é›…åœ°æé†’ä¸€ä¸ªé…ç½®å®ƒã€‚</p><p>   Many of these   *.desktop handlers are not present anymore â€¦ but which one? Here is a handy one liner that will either show you the full path of the handler or â€˜NOPEâ€™ when one does not exists. This will also tell you if its your â€˜customâ€™ handlers at   ~/.local/share/applications or the â€˜defaultâ€™ ones that come with packages and installed software located at   /usr/local/share/applications location.</p><p>   å…¶ä¸­è®¸å¤š* .desktopå¤„ç†ç¨‹åºä¸å†å­˜åœ¨......ä½†æ˜¯å“ªä¸€ä¸ªï¼Ÿè¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„ä¸€ä¸ªè¡¬ç­ï¼Œå®ƒå°†æ˜¾ç¤ºä¸€ä¸ªä¸å­˜åœ¨çš„å¤„ç†ç¨‹åºæˆ–'nope'çš„å®Œæ•´è·¯å¾„ã€‚è¿™ä¹Ÿå°†åœ¨ã€œ/ .local / share / applicationçš„â€œè‡ªå®šä¹‰â€å¤„ç†ç¨‹åºæˆ–åœ¨/ usr / local / share / applicationsä½ç½®é™„å¸¦çš„åŒ…è£…å’Œå®‰è£…è½¯ä»¶é™„å¸¦çš„â€œé»˜è®¤â€ã€‚</p><p> %   awk -F&#39;=&#39; &#39;{print $2}&#39; ~/.config/mimeapps.list \ | tr &#39;;&#39; &#39;\n&#39; \ | sort -u \ | sed 1d \ | while read I do echo ${I} find \ ~/.local/share/applications \ /usr/local/share/applications \ | grep &#34;/${I}&#34; || echo NOPE echo done</p><p> ï¼…awk-fï¼†ï¼ƒ39; =ï¼†ï¼ƒ39; ï¼†ï¼ƒ39; {æ‰“å°$ 2}ï¼†ï¼ƒ39; ã€œ/ .config / mimeapps.list \ | TRï¼†ï¼ƒ39 ;;ï¼†ï¼ƒ39; ï¼†ï¼ƒ39; \ nï¼†ï¼ƒ39; \ | sort -u \ | SED 1D \ |è™½ç„¶è¯»å–æˆ‘åšå›å£°{i}æŸ¥æ‰¾\ã€œ/ .local / share / applications \ / usr / local / share / applications \ | grepï¼†ï¼ƒ34; / $ {i}ï¼†ï¼ƒ34; ||å›å£°NOPE ECHOå®Œæˆ </p><p> Well â€¦ maybe not exactly ONE liner but a useful command that will do it ğŸ™‚</p><p>å¥½å§......ä¹Ÿè®¸ä¸æ˜¯ä¸€ä¸ªè¡¬é‡Œï¼Œè€Œæ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å‘½ä»¤ï¼Œå®ƒä¼šè¿™æ ·åš</p><p>   If you just want to check which ones are missed then add   grep -B 1 NONE at the end.</p><p>   å¦‚æœæ‚¨åªæƒ³æ£€æŸ¥é‚£äº›é”™è¿‡äº†å“ªäº›ï¼Œé‚£ä¹ˆåœ¨æœ€åæ·»åŠ Grep -b 1ã€‚</p><p> %   awk -F&#39;=&#39; &#39;{print $2}&#39; ~/.config/mimeapps.list \ | tr &#39;;&#39; &#39;\n&#39; \ | sort -u \ | sed 1d \ | while read I do echo ${I} find \ ~/.local/share/applications \ /usr/local/share/applications \ | grep &#34;/${I}&#34; || echo NOPE echo done | grep -B 1 NOPE</p><p> ï¼…awk-fï¼†ï¼ƒ39; =ï¼†ï¼ƒ39; ï¼†ï¼ƒ39; {æ‰“å°$ 2}ï¼†ï¼ƒ39; ã€œ/ .config / mimeapps.list \ | TRï¼†ï¼ƒ39 ;;ï¼†ï¼ƒ39; ï¼†ï¼ƒ39; \ nï¼†ï¼ƒ39; \ | sort -u \ | SED 1D \ |è™½ç„¶è¯»å–æˆ‘åšå›å£°{i}æŸ¥æ‰¾\ã€œ/ .local / share / applications \ / usr / local / share / applications \ | grepï¼†ï¼ƒ34; / $ {i}ï¼†ï¼ƒ34; ||å›å£°NOPEå›å£°å®Œæˆ| grep -b 1 nope</p><p>   You can safely remove all missing   *.desktop handlers from the   ~/.config/mimeapps.list file. You may use   sed(1) or graphical editor if that suits you better. The logic behind it is to remove all instances of for example   presentations-free18.desktop and then find and replace all instances of doubled semicolons â€˜  ;;â€˜ into single one â€˜  ;â€˜.</p><p>   æ‚¨å¯ä»¥å®‰å…¨åœ°ä»ã€œ/ .config / mimeapps.listæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ä¸¢å¤±çš„* .desktopå¤„ç†ç¨‹åºã€‚å¦‚æœè¿™é€‚åˆæ‚¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨SEDï¼ˆ1ï¼‰æˆ–å›¾å½¢ç¼–è¾‘å™¨ã€‚å®ƒèƒŒåçš„é€»è¾‘æ˜¯åˆ é™¤ä¾‹å¦‚aevere18.desktopçš„æ‰€æœ‰å®ä¾‹ï¼Œç„¶åæŸ¥æ‰¾å¹¶æ›¿æ¢åŒå€åˆ†å·';;'çš„æ‰€æœ‰å®ä¾‹ä¸ºå•ä¸ª';'ã€‚</p><p>  To generate new   *.desktop handlers in orderly fashion you can use mine    generate-desktop-handler.sh script. It will create new handler in the   ~/.local/share/applications directory and it will make sure you are creating one with an application that actually exists. Here is how it works. I have created new handler for my    random-wallpaper-always.sh for setting up random wallpaper from specified directory or to set wallpaper from exact specified file as argument.</p><p>  è¦æœ‰åºåœ°ç”Ÿæˆæ–°çš„* .desktopå¤„ç†ç¨‹åºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Mine Generate-desktop-handler.shè„šæœ¬ã€‚å®ƒå°†åœ¨ã€œ/ .local / share / applicationsç›®å½•ä¸­åˆ›å»ºæ–°çš„å¤„ç†ç¨‹åºï¼Œå¹¶ç¡®ä¿æ‚¨æ­£åœ¨åˆ›å»ºä¸€ä¸ªå®é™…å­˜åœ¨çš„åº”ç”¨ç¨‹åºã€‚ä¸‹é¢æ˜¯å®ƒçš„å·¥ä½œåŸç†ã€‚æˆ‘ä¸ºæˆ‘çš„Aquary-wallpaper-Always.shåˆ›å»ºäº†æ–°çš„å¤„ç†ç¨‹åºï¼Œç”¨äºä»æŒ‡å®šç›®å½•ä¸­è®¾ç½®éšæœºå£çº¸ï¼Œæˆ–å°†å£çº¸ä»ç¡®åˆ‡æŒ‡å®šæ–‡ä»¶è®¾ç½®ä¸ºå‚æ•°ã€‚</p><p> %   generate-desktop-handler.sh   usage: generate-desktop-handler.sh FILE%   generate-desktop-handler.sh non-existing-executableNOPE: executable &#39;non-existing-executable&#39; not found in ${PATH}%   generate-desktop-handler.sh random-wallpaper-always.sh INFO: handler &#39;~/.local/share/applications/random-wallpaper-always.sh.desktop&#39; was successfully generated%   cat ~/.local/share/applications/random-wallpaper-always.sh.desktop[Desktop Entry]Encoding=UTF-8Version=1.0Type=ApplicationNoDisplay=trueExec=random-wallpaper-always.sh %fName=random-wallpaper-always.shComment=random-wallpaper-always.sh</p><p> ï¼…generate-desktop-handler.shç”¨æ³•ï¼šgenerate-desktop-handler.shæ–‡ä»¶ï¼…generate-desktop-handler.shä¸ç°æœ‰-executableopeï¼šå¯æ‰§è¡Œæ–‡ä»¶ï¼†ï¼ƒ39;ä¸å­˜åœ¨å¯æ‰§è¡Œçš„ï¼†ï¼ƒ39;åœ¨$ {path}ï¼…generate-desktop-handler.sh randure-wallper-always.shä¿¡æ¯ï¼šhandlerï¼†ï¼ƒ39;ã€œ/ .local / share / application / aquary-wallpaper-alimany.sh.desktopï¼†ï¼ƒ39;å·²æˆåŠŸç”Ÿæˆï¼…catã€œ/ .local / share / application / walant-wallpaper-aliving.sh.desktop [æ¡Œé¢è¾“å…¥]ç¼–ç = utf-8version = 1.0thepe = applicationnodisplay = trueexec = randum-wallpaper-always.shï¼…fname =éšæœºå£çº¸ -  always.shcomment = random-wallpaper-always.sh</p><p> After you have created new   random-wallpaper-always.sh.desktop handler you may want to add it to some image file type like JPG or PNG. In the example below I will add it to JPG file.</p><p> åˆ›å»ºæ–°çš„Aquary-Wallpaper-always.sh.desktopå¤„ç†ç¨‹åºåï¼Œæ‚¨å¯èƒ½å¸Œæœ›å°†å…¶æ·»åŠ åˆ°ä¸€äº›åƒJPGæˆ–PNGç­‰å›¾åƒæ–‡ä»¶ç±»å‹ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä¼šå°†å…¶æ·»åŠ åˆ°JPGæ–‡ä»¶ä¸­ã€‚ </p><p> First right click on a JPG file with mouse and select  Open With and then  Other Applicationâ€¦.</p><p>é¦–å…ˆå³é”®å•å‡»é¼ æ ‡çš„JPGæ–‡ä»¶ï¼Œç„¶åé€‰æ‹©â€œæ‰“å¼€â€ï¼Œç„¶åé€‰æ‹©â€œå…¶ä»–åº”ç”¨ç¨‹åº...â€ã€‚</p><p>  The select   random-wallpaper-always.sh.desktop handler on the list. Make sure to UNCHECK the  Remember this application for â€¦ files option. If you do not do that it will be the DEFAULT application from now and everytime you would want to open JPG file you will set it as wallpaper ğŸ™‚</p><p>  åœ¨åˆ—è¡¨ä¸­é€‰æ‹©â€œéšæœºå£çº¸ -  always.sh.desktopå¤„ç†ç¨‹åºã€‚ç¡®ä¿å–æ¶ˆé€‰ä¸­æ­¤åº”ç”¨ç¨‹åºçš„è®°ä½æ­¤åº”ç”¨ç¨‹åºã€‚å¦‚æœæ‚¨æ²¡æœ‰è¿™æ ·åšï¼Œå®ƒå°†æ˜¯ä»ç°åœ¨å’Œæ¯æ¬¡æƒ³è¦æ‰“å¼€JPGæ–‡ä»¶æ—¶çš„é»˜è®¤åº”ç”¨ç¨‹åºï¼Œæ‚¨å°†æŠŠå®ƒè®¾ç½®ä¸ºå£çº¸ğŸ™‚</p><p>  You may verify that new option is added by right clicking the JPG file and selecting  Properties and then go to  Open With tab. The   random-wallpaper-always.sh.desktop handler will be one of the configured handlers for JPG files â€“ but not the default one.</p><p>  æ‚¨å¯ä»¥é€šè¿‡å³é”®å•å‡»JPGæ–‡ä»¶å’Œé€‰æ‹©å±æ€§æ¥éªŒè¯æ–°é€‰é¡¹ï¼Œç„¶åä½¿ç”¨é€‰é¡¹å¡æ‰“å¼€ã€‚éšæœºå£çº¸ -  always.sh.desktop handlerå°†æ˜¯JPGæ–‡ä»¶çš„é…ç½®å¤„ç†ç¨‹åºä¹‹ä¸€ - ä½†ä¸æ˜¯é»˜è®¤çš„å¤„ç†ç¨‹åºã€‚</p><p>  Now you can see that   random-wallpaper-always.sh.desktop handler is available to use when selecting the Open With submenu.</p><p>  ç°åœ¨ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°éšæœºå£çº¸always.sh.desktopå¤„ç†ç¨‹åºå¯ç”¨äºé€‰æ‹©ä¸å­èœå•çš„æ‰“å¼€æ—¶ä½¿ç”¨ã€‚</p><p>    There are some other alternatives to XDG but I am more then sure that most or all X11 applications support XDG way of doing things while not support the other alternative ones. Thus its far less hustle with just making XDG work as desired by generating needed handlers and using    see.sh instead of using them and wasting even more time on the topic â€“ at least that is my current experience.</p><p>    XDGè¿˜æœ‰ä¸€äº›æ›¿ä»£æ–¹æ¡ˆï¼Œä½†æˆ‘æ›´ç¡®ä¿å¤§å¤šæ•°æˆ–æ‰€æœ‰X11åº”ç”¨ç¨‹åºéƒ½æ”¯æŒXDGçš„æ–¹å¼ï¼ŒåŒæ—¶ä¸æ”¯æŒå…¶ä»–æ›¿ä»£æ–¹æ¡ˆã€‚å› æ­¤ï¼Œç”±äºé€šè¿‡ç”Ÿæˆæ‰€éœ€çš„å¤„ç†ç¨‹åºå¹¶ä½¿ç”¨See.shè€Œä¸æ˜¯ä½¿ç”¨å®ƒä»¬å¹¶åœ¨ä¸»é¢˜ä¸Šæµªè´¹æ›´å¤šæ—¶é—´ï¼Œå› æ­¤åˆšåˆšä½¿XDGå·¥ä½œæ›´å°‘å¾—å¤šçš„å–§åš£</p><p> Feel free to share your thoughts on the topic â€“ maybe you will show me even better approach to this.</p><p> éšæ„åˆ†äº«ä½ å¯¹è¿™ä¸ªè¯é¢˜çš„çœ‹æ³• - ä¹Ÿè®¸ä½ ä¼šå‘æˆ‘å±•ç¤ºæ›´å¥½çš„æ–¹æ³•ã€‚ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://vermaden.wordpress.com/2021/04/22/freebsd-desktop-part-24-configuration-universal-file-opener/">https://vermaden.wordpress.com/2021/04/22/freebsd-desktop-part-24-configuration-universal-file-opener/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/é€šç”¨/">#é€šç”¨</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/universal/">#universal</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/æ–‡ä»¶/">#æ–‡ä»¶</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ†äº«/">#åˆ†äº«</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>