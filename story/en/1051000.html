<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>rä¸­çš„ç°ä»£æ–‡æœ¬åŠŸèƒ½ Modern Text Features in R</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Modern Text Features in R<br/>rä¸­çš„ç°ä»£æ–‡æœ¬åŠŸèƒ½ </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-03-07 10:59:51</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/3/fb0ba3ab9dfcb51793284558fecae382.jpg"><img src="http://img2.diglog.com/img/2021/3/fb0ba3ab9dfcb51793284558fecae382.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Iâ€™m extremely pleased to present the culmination of several years of work spanning the  systemfonts,  textshaping, and  ragg packages. These releases complete our efforts to create a high-quality, performant raster graphics device that works the same way on every operating system.</p><p>æˆ‘éå¸¸é«˜å…´åœ°å±•ç¤ºäº†å‡ å¹´çš„å·¥ä½œï¼Œè·¨è¶Šäº†Systemfontsï¼ŒTextshingå’ŒRaggå¥—é¤çš„å·¥ä½œã€‚è¿™äº›å‘å¸ƒå®Œæˆæˆ‘ä»¬çš„åŠªåŠ›æ¥åˆ›å»ºä¸€ç§é«˜è´¨é‡çš„æ€§èƒ½å…‰æ …å›¾å½¢è®¾å¤‡ï¼Œåœ¨æ¯ä¸ªæ“ä½œç³»ç»Ÿä¸Šéƒ½æœ‰ç›¸åŒçš„æ–¹å¼å·¥ä½œã€‚</p><p> This blog post presents our improvements to raggâ€™s font rendering so that it now â€œjust worksâ€ regardless of what you throw at it. This includes:</p><p> æ­¤åšå®¢å¸–å­ä»‹ç»äº†RAGGå­—ä½“æ¸²æŸ“çš„æ”¹è¿›ï¼Œä»¥ä¾¿ç°åœ¨â€œåªæ˜¯ä½œå“â€ï¼Œæ— è®ºä½ æŠ›å‡ºä»€ä¹ˆã€‚è¿™åŒ…æ‹¬ï¼š</p><p>  All of the above comes in addition to the fact that ragg is able to use all of your installed fonts.</p><p>  ä»¥ä¸Šæ‰€æœ‰å†…å®¹éƒ½æ˜¯é™¤äº†raggèƒ½å¤Ÿä½¿ç”¨æ‰€æœ‰å·²å®‰è£…çš„å­—ä½“çš„äº‹å®ä¹‹å¤–ã€‚</p><p> To access these features all you need to do install the latest version of ragg:</p><p> è¦è®¿é—®è¿™äº›åŠŸèƒ½ï¼Œæ‚¨éœ€è¦å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„RAGGï¼š</p><p>  But Iâ€™d invite you to read on to learn how it works, how to control it, and what it all means for you as a user.</p><p>  ä½†æˆ‘é‚€è¯·æ‚¨é˜…è¯»ï¼Œä»¥äº†è§£å®ƒæ˜¯å¦‚ä½•è¿ä½œçš„ï¼Œå¦‚ä½•æ§åˆ¶å®ƒï¼Œä»¥åŠå®ƒä½œä¸ºç”¨æˆ·çš„æ–¹å¼ã€‚</p><p>  ragg can be used directly in the same way as the built-in devices, such as   png(),   jpeg(), and   tiff(), by opening the device, running some code that renders graphics, and closing it again when done using   dev.off(). The devices in ragg are prefixed with  agg_ and named by the file format they produce (e.g.Â   agg_png()).</p><p>  RAGGå¯ä»¥é€šè¿‡æ‰“å¼€è®¾å¤‡çš„å†…ç½®è®¾å¤‡ç›´æ¥ä»¥ä¸å†…ç½®è®¾å¤‡ï¼ˆå¦‚PNGï¼ˆï¼‰ï¼ŒJPEGï¼ˆï¼‰å’ŒTIFFï¼ˆï¼‰ç›¸åŒçš„æ–¹å¼ä½¿ç”¨ï¼Œè¿è¡Œä¸€äº›ä»£ç å‘ˆç°å›¾å½¢çš„ä»£ç ï¼Œå¹¶åœ¨å®Œæˆåå†æ¬¡å…³é—­å®ƒdev.offï¼ˆï¼‰ã€‚ RAGGä¸­çš„è®¾å¤‡ä»¥AGG_ä¸ºå‰ç¼€ï¼Œç”±å®ƒä»¬ç”Ÿæˆçš„æ–‡ä»¶æ ¼å¼å‘½åï¼ˆä¾‹å¦‚ï¼ŒAGG_PNGï¼ˆï¼‰ï¼‰ã€‚</p><p> You can use ragg with   ggsave() by passing the device function to the  device argument (e.g.Â   ggsave(device = agg_tiff)).</p><p> æ‚¨å¯ä»¥é€šè¿‡å°†è®¾å¤‡å‡½æ•°ä¼ é€’ç»™è®¾å¤‡å‚æ•°ï¼ˆä¾‹å¦‚GGSAVEï¼ˆDevice = Agg_tiffï¼‰ï¼‰æ¥ä½¿ç”¨å¸¦æœ‰GGSaveï¼ˆï¼‰çš„RAGGã€‚ </p><p> You can tell RStudio to use ragg in the  Plots pane be setting the backend to  AGG under  Global Options &gt; General &gt; Graphics.</p><p>æ‚¨å¯ä»¥å‘Šè¯‰Rstudioåœ¨Plots Paneä¸­ä½¿ç”¨RAGGå°†åç«¯è®¾ç½®ä¸ºGlobal Optionsï¼†gt;ä¸€èˆ¬ï¼†gt;å›¾å½¢ã€‚</p><p> ragg can be used when knitting Rmarkdown files by setting  dev=&#34;ragg_png&#34; in the code chunk options.</p><p> é€šè¿‡è®¾ç½®dev =ï¼†ï¼ƒ34ç¼–ç»‡Rarkmdownæ–‡ä»¶æ—¶å¯ä»¥ä½¿ç”¨ragg; ragg_pngï¼†ï¼ƒ34;åœ¨ä»£ç å—é€‰é¡¹ä¸­ã€‚</p><p>   With the new version of ragg, youâ€™ll be able to render plots such as this and expect it to simply work:</p><p>   ä½¿ç”¨æ–°ç‰ˆæœ¬çš„RAGGï¼Œæ‚¨å°†èƒ½å¤Ÿå‘ˆç°è¯¸å¦‚æ­¤ç±»çš„ç»˜å›¾ï¼Œå¹¶æœŸæœ›å®ƒåªæ˜¯ä¸ºäº†å·¥ä½œï¼š</p><p> library (  ggplot2 ) city_names  &lt;-   c (  &#34;Tokyo (æ±äº¬)&#34;,  &#34;Yokohama (æ¨ªæµœ)&#34;,  &#34;Osaka (å¤§é˜ªå¸‚)&#34;,  &#34;Nagoya (åå¤å±‹å¸‚)&#34;,  &#34;Sapporo (æœ­å¹Œå¸‚)&#34;,  &#34;Kobe (ç¥æˆ¸å¸‚)&#34;,  &#34;Kyoto (äº¬éƒ½å¸‚)&#34;,  &#34;Fukuoka (ç¦å²¡å¸‚)&#34;,  &#34;Kawasaki (å·å´å¸‚)&#34;,  &#34;Saitama (ã•ã„ãŸã¾å¸‚)&#34; ) main_cities  &lt;-   data.frame ( name  =  city_names, lat  =   c ( 35.690,  35.444,  34.694,  35.183,  43.067,  34.69,  35.012,  33.583,  35.517,  35.861 ), lon  =   c ( 139.692,  139.638,  135.502,  136.9,  141.35,  135.196,  135.768,  130.4,  139.7,  139.646 ) ) japan  &lt;-  rnaturalearth ::  ne_countries ( scale  =  10, country  =  &#34;Japan&#34;, returnclass  =  &#34;sf&#34; )  ggplot ( )  +   geom_sf ( data  =  japan, fill  =  &#34;forestgreen&#34;, colour  =  &#34;grey10&#34;, size  =  0.2  )  +  ggrepel ::  geom_label_repel (   aes ( lon,  lat, label  =  name ), data  =  main_cities, fill  =  &#34;#FFFFFF88&#34;, box.padding  =   unit ( 5,  &#34;mm&#34; )  )  +   geom_point (  aes ( lon,  lat ),  main_cities )  +   ggtitle (  &#34;Location of largest cities in Japan (æ—¥æœ¬) ğŸ‡¯ğŸ‡µ&#34;  )  +   theme_void ( )  +   theme (panel.background  =   element_rect ( &#34;steelblue&#34; ), plot.title  =   element_text (margin  =   margin ( 5,  0,  5,  0 ) ) )</p><p> å›¾ä¹¦é¦†ï¼ˆGGPLOT2ï¼‰City_namesï¼†lt;  -  cï¼ˆï¼†ï¼ƒ34;ä¸œäº¬ï¼ˆä¸œäº¬ï¼‰ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;æ¨ªæ»¨ï¼ˆæ¨ªæµœï¼‰ï¼†ï¼ƒ34 ;,ï¼†ï¼ƒ34;å¤§é˜ªï¼ˆå¤§å¦å¸‚ï¼‰ï¼†ï¼ƒ34 ;, ï¼†ï¼ƒ34;åå¤å±‹ï¼ˆåå­—å¸‚ï¼‰ï¼†ï¼ƒ34 ;,ï¼†ï¼ƒ34;æœ­å¹Œï¼ˆæœ­å¹Œå¸‚ï¼‰ï¼†ï¼ƒ34 ;,ï¼†ï¼ƒ34;ç¥æˆ·ï¼ˆç¥æˆ¸å¸‚ï¼‰ï¼†ï¼ƒ34 ;,ï¼†ï¼ƒ34;äº¬éƒ½ï¼ˆäº¬éƒ½å¸‚ï¼‰ï¼†ï¼ƒ34 ;,ï¼†ï¼ƒ34;ç¦å†ˆï¼ˆç¦å·å¸‚ï¼‰ï¼†ï¼ƒ34 ;,ï¼†ï¼ƒ34; kawasakiï¼ˆå·å´å¸‚ï¼‰ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;åŸ¼ç‰ï¼ˆã•ã„ãŸã¾å¸‚ï¼‰ï¼†ï¼ƒ34;ï¼‰main_citiesï¼†ï¼ƒ34;ï¼‰main_citiesï¼†lt ;  -  data.frameï¼ˆname = city_namesï¼Œlat = cï¼ˆ35.690,35.444,34.067,35.69,35.012,31.583,35.517,35.861,35.517,35.861ï¼‰ï¼ŒLon = Cï¼ˆ139.692,139.638,135.502,136.9,141.35,135.196 ï¼Œ135.768,130.4,139.7,139.646ï¼‰ï¼‰æ—¥æœ¬ï¼†lt;  -  rnattalth :: ne_countriesï¼ˆscale = 10ï¼Œcountry =ï¼†ï¼ƒ34;æ—¥æœ¬ï¼†ï¼ƒ34; returnclass =ï¼†ï¼ƒ34; sfï¼†ï¼ƒ34;ï¼‰ggplotï¼ˆï¼‰+ geom_sf ï¼ˆæ•°æ®=æ—¥æœ¬ï¼Œå¡«å……=ï¼†ï¼ƒ34; forestgreenï¼†ï¼ƒ34;ï¼Œcolor =ï¼†ï¼ƒ34; grey10ï¼†ï¼ƒ34; size = 0.2ï¼‰+ ggrepel :: geom_label_repelï¼ˆaesï¼ˆlonï¼Œlatï¼Œlabel = nameï¼‰ï¼Œdata = main_citiesï¼Œå¡«å……=ï¼†ï¼ƒ34;ï¼ƒffffff88ï¼†ï¼ƒ34;ï¼Œbox.padding =å•ä½ï¼ˆ5ï¼Œï¼†ï¼ƒ34; mmï¼†ï¼ƒ34;ï¼‰ï¼‰+ geom_pointï¼ˆaesï¼ˆ lonï¼Œlatï¼‰ï¼Œmain_citiesï¼‰+ ggtitleï¼ˆï¼†ï¼ƒ34;æ—¥æœ¬æœ€å¤§åŸå¸‚çš„ä½ç½®ï¼ˆæ—¥æœ¬ï¼‰ğŸ‡¯ğŸ‡µï¼†ï¼ƒ34; ï¼‰+ theme_voidï¼ˆï¼‰+ä¸»é¢˜ï¼ˆpanel.background = Element_Rectï¼ˆï¼†ï¼ƒ34; SteelBlueï¼†ï¼ƒ34;ï¼‰ï¼ŒPlot.title = Element_Textï¼ˆMargin = Marginï¼ˆ5,0,5,0ï¼‰ï¼‰ï¼‰ï¼‰</p><p> Note the effortless mix of text in English and Japanese, along with emoji in the title. If this has piqued your interest, read on!</p><p> æ³¨æ„è‹±è¯­å’Œæ—¥è¯­ä¸­çš„æ¯«ä¸è´¹åŠ›çš„æ–‡æœ¬ç»„åˆï¼Œä»¥åŠæ ‡é¢˜ä¸­çš„è¡¨æƒ…ç¬¦å·ã€‚å¦‚æœè¿™æ¿€èµ·äº†ä½ çš„å…´è¶£ï¼Œè¯·ç»§ç»­é˜…è¯»ï¼</p><p>  English, the lingua franca of programming, has tended to dominate everything related to text within programming, ranging from encoding to rendering. This has made the Latin script, used in most of the Western world, the best (or often only) supported script in many text-rendering pipelines. This has been true in the R world where the built-in graphic devices have struggled to display other scripts (with the exception of Cairo devices on Linux). It is about time (overdue, really!) that the graphics system in R becomes more inclusive of which languages can be used. It is thus with great joy that I announce that ragg finally supports all scripts.</p><p>  è‹±è¯­ï¼ŒLingua Francaçš„ç¼–ç¨‹ï¼Œå¾€å¾€å æ®äº†ç¼–ç¨‹ä¸­çš„æ–‡æœ¬ç›¸å…³çš„ä¸€åˆ‡ï¼Œä»ç¼–ç åˆ°æ¸²æŸ“ã€‚è¿™ä½¿å¾—åœ¨å¤§å¤šæ•°è¥¿æ–¹ä¸–ç•Œä¸­ä½¿ç”¨çš„æ‹‰ä¸è„šæœ¬ï¼Œåœ¨è®¸å¤šæ–‡æœ¬æ¸²æŸ“ç®¡é“ä¸­æœ€å¥½çš„ï¼ˆæˆ–é€šå¸¸åªæœ‰ï¼‰æ”¯æŒçš„è„šæœ¬ã€‚åœ¨Rä¸–ç•Œä¸­ï¼Œå†…ç½®å›¾å½¢è®¾å¤‡åŠªåŠ›æ˜¾ç¤ºå…¶ä»–è„šæœ¬ï¼ˆLinuxä¸Šçš„å¼€ç½—è®¾å¤‡é™¤å¤–ï¼‰ï¼Œè¿™ä¸€ç›´å¦‚æ­¤ã€‚å®ƒæ˜¯å…³äºæ—¶é—´ï¼ˆé€¾æœŸï¼ŒçœŸçš„ï¼ï¼‰rä¸­çš„å›¾å½¢ç³»ç»Ÿå˜å¾—æ›´åŠ åŒ…å«å“ªäº›è¯­è¨€ã€‚å› æ­¤ï¼Œæˆ‘å®£å¸ƒRAGGæœ€ç»ˆæ”¯æŒæ‰€æœ‰è„šæœ¬ã€‚</p><p>  To start off we will look at a sample of different scripts (Arabic, Hebrew, and Sindhi) that pose a challenge because they are written from right to left:</p><p>  è¦å¼€å§‹ï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹ä¸åŒè„šæœ¬ï¼ˆé˜¿æ‹‰ä¼¯è¯­ï¼Œå¸Œä¼¯æ¥è¯­å’ŒSindhiï¼‰çš„æ ·æœ¬ï¼Œè¿™ä¼šæ„æˆæŒ‘æˆ˜ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä»å³åˆ°å·¦å†™çš„ï¼š </p><p> arabic_text  &lt;-  &#34;Ù‡Ø°Ø§ Ù…ÙƒØªÙˆØ¨ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©&#34; hebrew_text  &lt;-  &#34;×–×” ×›×ª×•×‘ ×‘×¢×‘×¨×™×ª&#34; sindhi_text  &lt;-  &#34;Ù‡ÙŠ Ø³Ù†ÚŒÙŠØ¡Ù Û¾ Ù„Ú©ÙŠÙˆ ÙˆÙŠÙˆ Ø¢Ù‡ÙŠ&#34; p  &lt;-   ggplot ( )  +   geom_text (   aes (x  =  0, y  =  3 : 1, label  =   c ( arabic_text,  hebrew_text,  sindhi_text ) ), family  =  &#34;Arial&#34;  )  +   expand_limits (y  =   c ( 0,  4 ) ) preview_devices ( p,  &#34;rtl_example&#34; )</p><p>Arabic_textï¼†lt;  - ï¼†ï¼ƒ34;Ù‡Ø°Ø§Ù…Ø³ØªÙˆØ¨Ø¨Ø§Ù„Ù„Ø©Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ï¼†ï¼ƒ34;å¸Œä¼¯æ¥_Textï¼†lt;  - ï¼†ï¼ƒ34;×–×”×–×”×›×ª×•×‘×¨×™×ªï¼†ï¼ƒ34; sindhi_textï¼†lt;  - ï¼†ï¼ƒ34;Ù‡ÙŠØ³Ù†Ø³ÙŠØ©Ø¡Ù„Ú©ÙŠÙˆÙˆÙŠÙˆÙÙŠï¼†ï¼ƒ34; pï¼†lt; ggplotï¼ˆï¼‰+ geom_textï¼ˆaesï¼ˆx = 0ï¼Œy = 3ï¼š1ï¼Œlabel = cï¼ˆé˜¿æ‹‰ä¼¯è¯­_textï¼Œhebrew_textï¼Œsindhi_textï¼‰ï¼‰ï¼Œfamily =ï¼†ï¼ƒ34; Arialï¼†ï¼ƒ34;ï¼‰+ expand_limitsï¼ˆy = cï¼ˆ0,4ï¼‰ï¼‰preview_devicesï¼ˆpï¼Œï¼†ï¼ƒ34; rtl_exampleï¼†ï¼ƒ34;ï¼‰</p><p>  If youâ€™re not familiar with the languages above it can be hard to see what is right and what is wrong. You may, however, look at how the text in the code is rendered in the browser and compare that to the device rendering. If you do that, you can see that the Hebrew script is rendered in the wrong direction for all the non-ragg devices (except Cairo on Linux). For the Arabic and Sindhi itâ€™s even harder to see whatâ€™s wrong because the text looks fundamentally different. Thatâ€™s because both Arabic and Sindhi rely extensively on text substitution rules and ligatures; the way a letter is written depends critically on what letters it is next to. Still, by comparing to the browser rendering you can see that the same devices failing on the Hebrew script fail here as well.</p><p>  å¦‚æœä½ ä¸ç†Ÿæ‚‰ä¸Šé¢çš„è¯­è¨€ï¼Œé‚£ä¹ˆå¾ˆéš¾çœ‹å‡ºä»€ä¹ˆæ˜¯æ­£ç¡®çš„ï¼Œä»€ä¹ˆæ˜¯é”™è¯¯çš„ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹ä»£ç ä¸­çš„æ–‡æœ¬å¦‚ä½•åœ¨æµè§ˆå™¨ä¸­å‘ˆç°ï¼Œå¹¶å°†å…¶ä¸è®¾å¤‡å‘ˆç°è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœè¿™æ ·åšï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å¸Œä¼¯æ¥è¯­è„šæœ¬åœ¨æ‰€æœ‰éRAGGè®¾å¤‡ï¼ˆLinuxä¸Šçš„å¼€ç½—é™¤å¤–ï¼‰ä¸­å‘ˆç°é”™è¯¯çš„æ–¹å‘ã€‚å¯¹äºé˜¿æ‹‰ä¼¯è¯­å’ŒSindhiæ¥è¯´ï¼Œç”šè‡³æ›´éš¾çœ‹å‡ºæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºæ–‡æœ¬çœ‹èµ·æ¥æ ¹æœ¬ä¸åŒã€‚é‚£æ˜¯å› ä¸ºé˜¿æ‹‰ä¼¯è¯­å’Œè¾›è¿ªæ—¢å¹¿æ³›ä¾èµ–æ–‡æœ¬æ›¿ä»£è§„åˆ™å’Œæ‰å®;å†™çš„æ˜¯ä¸€å°ä¿¡çš„æ–¹å¼æ‰¹åˆ¤æ€§åœ°ä¾èµ–äºå®ƒæ—è¾¹çš„å­—æ¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œé€šè¿‡ä¸æµè§ˆå™¨æ¸²æŸ“è¿›è¡Œæ¯”è¾ƒï¼Œæ‚¨å¯ä»¥çœ‹åˆ°Hebrewè„šæœ¬ä¸Šå¤±è´¥çš„åŒä¸€è®¾å¤‡åœ¨æ­¤å¤„å¤±è´¥ã€‚</p><p> The Cairo device on Linux handles this task well, as we have noted above. How come this works, but only on one OS? Cairo is built in to most Linux distributions and is designed to work with Pango, the library that linux uses to layout text. Râ€™s Cairo graphics device bundles Cairo on all platforms, but doesnâ€™t include Pango, due to the challenges of building it on other operating systems.</p><p> Linuxä¸Šçš„å¼€ç½—è®¾å¤‡å¾ˆå¥½åœ°å¤„ç†æ­¤ä»»åŠ¡ï¼Œæ­£å¦‚æˆ‘ä»¬ä¸Šé¢æ‰€æŒ‡å‡ºçš„é‚£æ ·ã€‚è¿™æ˜¯å¦‚ä½•è¿ä½œçš„ï¼Œä½†åªåœ¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸Šï¼Ÿ CAIROå†…ç½®äºå¤§å¤šæ•°Linuxå‘è¡Œç‰ˆï¼Œå¹¶ä¸”æ—¨åœ¨ä¸Pangoä¸€èµ·ä½¿ç”¨Linuxç”¨äºå¸ƒå±€æ–‡æœ¬çš„åº“ã€‚ Rçš„å¼€ç½—å›¾å½¢è®¾å¤‡åœ¨æ‰€æœ‰å¹³å°ä¸Šæ†ç»‘å¼€ç½—ï¼Œä½†ç”±äºåœ¨å…¶ä»–æ“ä½œç³»ç»Ÿä¸Šå»ºé€ å®ƒçš„æŒ‘æˆ˜ï¼Œä¸åŒ…æ‹¬Pangoã€‚</p><p>  What happens if you combine right-to-left and left-to-right text in the same sentence? The string needs to be split into pieces that each consist of text running in one direction, laid out individually, and then combined back together</p><p>  å¦‚æœåœ¨åŒä¸€ä¸ªå¥å­ä¸­å°†å·¦å³å’Œå·¦å³æ–‡æœ¬ç»„åˆåœ¨ä¸€èµ·ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿéœ€è¦å°†å­—ç¬¦ä¸²åˆ†æˆç¢ç‰‡ï¼Œæ¯ä¸ªéƒ¨åˆ†åŒ…å«åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šè¿è¡Œçš„æ–‡æœ¬ï¼Œå•ç‹¬å¸ƒç½®ï¼Œç„¶åå°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·</p><p> bidi_text  &lt;-  &#34;The Hebrew (×¢Ö´×‘×¨Ö´×™×ª) script\nis right-to-left&#34; p  &lt;-   ggplot ( )  +   geom_text (   aes (x  =  0, y  =  0, label  =  bidi_text ), family  =  &#34;Arial&#34;  ) preview_devices ( p,  &#34;bidi_example&#34; )</p><p> bidi_textï¼†lt;  - ï¼†ï¼ƒ34;å¸Œä¼¯æ¥è¯­ï¼ˆ×¢Ö´×‘×¨Ö´×™×ªï¼‰è„šæœ¬\ niså·¦å³ï¼†ï¼ƒ34; pï¼†lt; ggplotï¼ˆï¼‰+ geom_textï¼ˆaesï¼ˆx = 0ï¼Œy = 0ï¼Œlabel = bidi_textï¼‰ï¼Œfamily =ï¼†ï¼ƒ34; Arialï¼†ï¼ƒ34;ï¼‰preview_devicesï¼ˆpï¼Œï¼†ï¼ƒ34; bidi_exampleï¼†ï¼ƒ34;ï¼‰</p><p>  Given that most devices struggle with RtL scripts, itâ€™s not surprising that they also fail when mixed. Again the exception is ragg, and Cairo on Linux.</p><p>  é‰´äºå¤§å¤šæ•°è®¾å¤‡ä¸RTLè„šæœ¬æ–—äº‰ï¼Œå®ƒå¹¶ä¸ä»¤äººæƒŠè®¶ï¼Œå®ƒä»¬åœ¨æ··åˆæ—¶ä¹Ÿä¼šå¤±è´¥ã€‚å†æ¬¡ä¾‹å¤–æ˜¯raggï¼Œä»¥åŠLinuxä¸Šçš„å¼€ç½—ã€‚</p><p>  A part of supporting some of the non-Latin scripts described above is to have support for ligatures (substituting multiple glyphs with a single new glyph). While ligatures are a requirement for the correct rendering of some scripts it is also an optional feature of fonts in general in order to support different text variations. More generally, the OpenType font format describes a long range of features, many optional, that defines specific glyph substitutions (both one-to-one and many-to-one) or position adjustments that can be turned on or off and will affect the look of the final rendered text. Some of these features are turned on automatically for specific scripts (e.g.Â required ligatures for Arabic), while others are left for the user to turn on at their discretion (e.g.Â tabular numerics). As part of the work to add support for non-Latin scripts the infrastructure to support all OpenType features was built. This, of course, requires that the font in use supports the requested feature.</p><p>  æ”¯æŒä¸Šè¿°ä¸€äº›éæ‹‰ä¸è„šæœ¬çš„ä¸€éƒ¨åˆ†æ˜¯æ”¯æŒè¿æ¥çš„æ”¯æŒï¼ˆç”¨å•ä¸ªæ–°å­—å½¢æ›¿æ¢å¤šä¸ªå­—å½¢ï¼‰ã€‚è™½ç„¶Ligaturesæ˜¯å¯¹æŸäº›è„šæœ¬æ­£ç¡®æ¸²æŸ“çš„è¦æ±‚ï¼Œä½†æ˜¯é€šå¸¸æ˜¯å­—ä½“çš„å¯é€‰åŠŸèƒ½ï¼Œä»¥ä¾¿æ”¯æŒä¸åŒçš„æ–‡æœ¬å˜ä½“ã€‚æ›´ä¸€èˆ¬åœ°ï¼ŒOpenTypeå­—ä½“æ ¼å¼æè¿°äº†å¾ˆå¤šåŠŸèƒ½ï¼Œè®¸å¤šå¯é€‰ï¼Œå®ƒå®šä¹‰äº†å¯ä»¥æ‰“å¼€æˆ–å…³é—­çš„ç‰¹å®šå­—å½¢æ›¿æ¢ï¼ˆä¸€å¯¹ä¸€å’Œå¤šå¯¹ä¸€ï¼‰æˆ–ä½ç½®è°ƒæ•´ï¼Œå¹¶å°†å½±å“çœ‹æœ€ç»ˆæ¸²æŸ“çš„æ–‡å­—ã€‚å…¶ä¸­ä¸€äº›åŠŸèƒ½æ˜¯è‡ªåŠ¨æ‰“å¼€ç‰¹å®šè„šæœ¬çš„ï¼ˆä¾‹å¦‚ï¼Œé˜¿æ‹‰ä¼¯è¯­æ‰€éœ€çš„è„±è±¡ï¼‰ï¼Œè€Œå…¶ä»–ç‰¹å¾åˆ™ç•™ä¸‹å…¶ä»–äººä¸ºç”¨æˆ·è‡ªè¡Œå†³å®šï¼ˆä¾‹å¦‚è¡¨æ ¼ç¼–å·ï¼‰ã€‚ä½œä¸ºä¸ºéæ‹‰ä¸è„šæœ¬æ·»åŠ æ”¯æŒçš„å·¥ä½œçš„ä¸€éƒ¨åˆ†ï¼Œæ„å»ºäº†æ”¯æŒæ‰€æœ‰OpenTypeåŠŸèƒ½çš„åŸºç¡€æ¶æ„ã€‚å½“ç„¶ï¼Œè¿™è¦æ±‚ä½¿ç”¨çš„å­—ä½“æ”¯æŒæ‰€è¯·æ±‚çš„åŠŸèƒ½ã€‚ </p><p> Some fonts, like the popular  Fira Code programming font, use ligatures as a main part of their appeal. These now work as expected with ragg:</p><p>ä¸€äº›å­—ä½“ï¼Œå¦‚æµè¡Œçš„Firaä»£ç ç¼–ç¨‹å­—ä½“ï¼Œè¯·ä½¿ç”¨è„±ç¦»å±ä½œä¸ºå…¶å¸å¼•åŠ›çš„ä¸»è¦éƒ¨åˆ†ã€‚è¿™äº›ç°åœ¨æŒ‰ç…§RAGGé¢„æœŸå·¥ä½œï¼š</p><p> code  &lt;-  &#34;x &lt;- y != z&#34; logo  &lt;-  &#34;twitter&#34; p  &lt;-   ggplot ( )  +   geom_text (   aes (x  =  0, y  =  2, label  =  code ), family  =  &#34;Fira Code&#34;  )  +   geom_text (   aes (x  =  0, y  =  1, label  =  logo ), family  =  &#34;Font Awesome 5 brands&#34;  )  +   expand_limits (y  =   c ( 0,  3 ) ) preview_devices ( p,  &#34;def_features&#34; )</p><p> ä»£ç ï¼†lt;  - ï¼†ï¼ƒ34; xï¼†lt;  -  yï¼= zï¼†ï¼ƒ34; logoï¼†lt;  - ï¼†ï¼ƒ34; Twitterï¼†ï¼ƒ34; pï¼†lt;  -  ggplotï¼ˆï¼‰+ geom_textï¼ˆaesï¼ˆx = 0ï¼Œy = 2ï¼Œlabel = codeï¼‰ï¼Œfamily =ï¼†ï¼ƒ34; fira codeï¼†ï¼ƒ34;ï¼‰+ geom_textï¼ˆaesï¼ˆx = 0ï¼Œy = 1ï¼Œ label =å¾½æ ‡ï¼‰ï¼Œfamily =ï¼†ï¼ƒ34;å­—ä½“å¾ˆæ£’5ä¸ªå“ç‰Œï¼†ï¼ƒ34;ï¼‰+ expand_limitsï¼ˆy = cï¼ˆ0,3ï¼‰ï¼‰preview_devicesï¼ˆpï¼Œï¼†ï¼ƒ34; def_featuresï¼†ï¼ƒ34;ï¼‰</p><p>  But what about non-default features? The capabilities of the graphics engine in R presents a problem here. There is very little information that the user is able to send along with the text to be plotted, apart from location and font ( bold and  italic on/off is the extent of it). So, having a device with support for advanced OpenType features in and of itself is nearly useless as there is no way to specify in your plot code that you want to turn a feature on or off.</p><p>  ä½†æ˜¯å…³äºéé»˜è®¤åŠŸèƒ½å‘¢ï¼Ÿ R rä¸­å›¾å½¢å¼•æ“çš„åŠŸèƒ½åœ¨è¿™é‡Œå­˜åœ¨é—®é¢˜ã€‚åœ¨é™¤äº†ä½ç½®å’Œå­—ä½“ä¹‹å¤–ï¼Œç”¨æˆ·èƒ½å¤Ÿä¸è¦ç»˜åˆ¶çš„æ–‡æœ¬ä¸€èµ·å‘é€çš„æ–‡æœ¬éå¸¸å°‘çš„ä¿¡æ¯ï¼Œï¼ˆç²—ä½“å’Œæ–œä½“å¼€/å…³ï¼‰ã€‚å› æ­¤ï¼Œæ‹¥æœ‰æ”¯æŒé«˜çº§OpenTypeåŠŸèƒ½çš„è®¾å¤‡æœ¬èº«å‡ ä¹æ²¡ç”¨ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•åœ¨æ‚¨æƒ³è¦æ‰“å¼€æˆ–å…³é—­åŠŸèƒ½çš„ç»˜å›¾ä»£ç ä¸­æŒ‡å®šã€‚</p><p> To work around this limitation, systemfonts now allows you to register font variants, providing a custom name that you can use to refer to a font with certain features enabled:</p><p> è¦è§£å†³æ­¤é™åˆ¶ï¼Œç³»ç»Ÿç°åœ¨å…è®¸æ‚¨æ³¨å†Œå­—ä½“å˜ä½“ï¼Œæä¾›æ‚¨å¯ä»¥ä½¿ç”¨çš„è‡ªå®šä¹‰åç§°æ¥å¼•ç”¨å¯ç”¨æŸäº›åŠŸèƒ½çš„å­—ä½“ï¼š</p><p> library (  systemfonts )  register_variant ( name  =  &#34;Montserrat Extreme&#34;, family  =  &#34;Montserrat&#34;, weight  =  &#34;semibold&#34;, features  =   font_feature (ligatures  =  &#34;discretionary&#34;, letters  =  &#34;stylistic&#34; ) )</p><p> å›¾ä¹¦é¦†ï¼ˆSystemfontsï¼‰register_variantï¼ˆåç§°=ï¼†ï¼ƒ34;è’™ç‰¹å¡æ‹‰ç‰¹é›·ï¼†ï¼ƒ34;ï¼Œfamily =ï¼†ï¼ƒ34;è’™ç‰¹å¡æ‹‰ç‰¹ï¼†ï¼ƒ34;ï¼Œé‡é‡=ï¼†ï¼ƒ34;åŠoldï¼†ï¼ƒ34; semiboldï¼†ï¼ƒ34;ï¼Œç‰¹å¾= font_featureï¼ˆLigatures =ï¼†ï¼ƒ34;è‡ªç”±åˆ¤é…ï¼†ï¼ƒ34;ï¼Œå­—æ¯=ï¼†ï¼ƒ34;å‹å·ï¼†ï¼ƒ34;ï¼‰ï¼‰ï¼‰</p><p> The code above creates a new font based on Montserrat using a semibold weight and turning on standard ligatures and stylistic letter substitution. Now, in your text plotting code all you have to do is specify  &#34;Montserrat Extreme&#34; as the font family and the features and weights will be used. This only works with ragg, because none of the other devices are build on top of systemfonts, so donâ€™t know how to access the registered font:</p><p> ä¸Šé¢çš„ä»£ç åŸºäºMontserratåˆ›å»ºäº†ä¸€ç§æ–°çš„å­—ä½“ï¼Œä½¿ç”¨åŠä»£ä½“é‡å’Œæ‰“å¼€æ ‡å‡†ç®€æ–­å’Œé£æ ¼å­—æ¯æ›¿æ¢ã€‚ç°åœ¨ï¼Œåœ¨æ‚¨çš„æ–‡æœ¬ç»˜å›¾ä»£ç ä¸­ï¼Œæ‚¨æ‰€è¦åšçš„å°±æ˜¯æŒ‡å®šï¼†ï¼ƒ34;è’™ç‰¹å¡æ‹‰ç‰¹Â·æç«¯ï¼†ï¼ƒ34;ä½œä¸ºå­—ä½“ç³»åˆ—å’ŒåŠŸèƒ½å’Œé‡é‡å°†è¢«ä½¿ç”¨ã€‚è¿™ä»…é€‚ç”¨äºRAGGï¼Œå› ä¸ºå…¶ä»–è®¾å¤‡éƒ½ä¸åœ¨ç³»ç»Ÿå­—ä½“ä¸Šæ„å»ºï¼Œå› æ­¤ä¸çŸ¥é“å¦‚ä½•è®¿é—®æ³¨å†Œå­—ä½“ï¼š</p><p> ggplot ( )  +   geom_text (   aes (x  =  0, y  =  1, label  =  &#34;This text should definitely differ&#34; ), family  =  &#34;Montserrat&#34;, size  =  6  )  +   geom_text (   aes (x  =  0, y  =  0, label  =  &#34;This text should definitely differ&#34; ), family  =  &#34;Montserrat Extreme&#34;, size  =  6  )  +   expand_limits (y  =   c ( - 1,  2 ) )</p><p> ggplotï¼ˆï¼‰+ geom_textï¼ˆaesï¼ˆx = 0ï¼Œy = 1ï¼Œlabel =ï¼†ï¼ƒ34;æœ¬æ–‡è‚¯å®šåº”è¯¥æœ‰æ‰€ä¸åŒï¼†ï¼ƒ34;ï¼‰ï¼Œå®¶åº­=ï¼†ï¼ƒ34;è’™ç‰¹å¡æ‹‰ç‰¹ï¼†ï¼ƒ34;ï¼Œsize = 6ï¼‰+ geom_textï¼ˆ aesï¼ˆx = 0ï¼Œy = 0ï¼Œæ ‡ç­¾=ï¼†ï¼ƒ34;æœ¬æ–‡åº”è¯¥ä¸åŒï¼†ï¼ƒ34;ï¼‰ï¼Œå®¶åº­=ï¼†ï¼ƒ34;è’™ç‰¹å¡æ‹‰ç‰¹é›·ï¼†ï¼ƒ34; size = 6ï¼‰+ expanc_limitsï¼ˆy = cï¼ˆ - 1,2ï¼‰ï¼‰ </p><p> We can see that by using this font registration we not only gain access to weights other than normal and bold, but also to glyph substitutions such as the â€œThâ€ ligature, and the stylistic variations seen with the â€œtâ€, â€œfâ€, â€œlâ€, and â€œeâ€ glyphs.</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä½¿ç”¨æ­¤å­—ä½“æ³¨å†Œï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥è®¿é—®æ­£å¸¸å’Œç²—ä½“ä»¥å¤–çš„æƒé‡ï¼Œè¿˜å¯ä»¥è®¿é—®è¯¸å¦‚â€œThâ€çš„å­—å½¢æ›¿æ¢ï¼Œä»¥åŠç”¨â€œtâ€ï¼Œâ€œfâ€çœ‹åˆ°çš„é£æ ¼å˜åŒ–ï¼Œ â€œLâ€å’Œâ€œEâ€å­—å½¢ã€‚</p><p> While a lot of the optional OpenType features are mainly of interest to achieve a specific stylistic look of the rendered text, some have more importance for data visualizations, such as those related to how numbers are displayed. It is both possible to force even-width numbers, as well as correct display of fractional numbers (using  font_feature(numbers = c(&#34;tabular&#34;, &#34;fractions&#34;)) using OpenType. as long as the font supports it. So this is definitely something to look into when you want to add that final polish to your visualization.</p><p> è™½ç„¶å¾ˆå¤šå¯é€‰çš„OpenTypeåŠŸèƒ½ä¸»è¦æ˜¯å®ç°å‘ˆç°æ–‡æœ¬çš„ç‰¹å®šé£æ ¼å¤–è§‚çš„æ„Ÿå…´è¶£çš„ï¼Œä½†æœ‰äº›äººå¯¹æ•°æ®å¯è§†åŒ–å…·æœ‰æ›´å¤šé‡è¦æ€§ï¼Œä¾‹å¦‚ä¸æ˜¾ç¤ºæ•°å­—ç›¸å…³çš„æ•°æ®å¯è§†åŒ–ã€‚å®ƒæ—¢å¯ä»¥å¼ºåˆ¶å‡åŒ€æ•°å­—ï¼Œä»¥åŠä½¿ç”¨Opotypeçš„Font_featureçš„åˆ†æ•°å·çš„æ­£ç¡®æ˜¾ç¤ºï¼ˆä½¿ç”¨font_featureï¼ˆæ•°å­—= cï¼ˆï¼†ï¼ƒ34;è¡¨æ ¼ï¼†ï¼ƒ34;ï¼†ï¼ƒ34;éƒ¨åˆ†;é›¶ä»¶ï¼†ï¼ƒ34;ï¼‰ï¼‰ã€‚å¦‚åªè¦å­—ä½“æ”¯æŒå®ƒå³å¯ã€‚æ‰€ä»¥å½“æ‚¨æƒ³å°†æœ€ç»ˆæ³¢å…°è¯­æ·»åŠ åˆ°æ‚¨çš„å¯è§†åŒ–æ—¶ï¼Œè¿™ç»å¯¹æ˜¯ä¸ºäº†è°ƒæŸ¥ã€‚</p><p>  A recent (in font technology terms) development is the availability of color fonts, i.e.Â fonts where the glyphs have designated colors. This development is largely driven by the ubiquity of emojis in modern text, and while it may seem that emojis have been around forever, it is recent enough that the world has yet to converge to a single standard for color fonts. The system emoji font on macOS, Windows, and Linux all uses different font technologies for storing the color glyphs, ranging from storing a single bitmap, to storing each glyph as an SVG. This, unsurprisingly, complicates things. To add insult to injury, emojis often get rendered slightly larger than the surrounding text and with a slightly lowered baseline in a very OS-specific way (this does not apply to all color fonts; only emojis).</p><p>  æœ€è¿‘ï¼ˆä»¥å­—ä½“æŠ€æœ¯æœ¯è¯­ï¼‰å¼€å‘æ˜¯å½©è‰²å­—ä½“çš„å¯ç”¨æ€§ï¼Œå³å­—å½¢å…·æœ‰æŒ‡å®šé¢œè‰²çš„å­—ä½“ã€‚è¿™ç§å‘å±•åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå—åˆ°ç°ä»£æ–‡æœ¬ä¸­çš„è¡¨æƒ…ç¬¦å·çš„æ— å¤„ä¸åœ¨çš„æ¨åŠ¨ï¼Œè€Œä¼¼ä¹è¡¨æ˜Emojisä¸€ç›´å­˜åœ¨ï¼Œè€Œä¸”è¿‘æ¥ï¼Œä¸–ç•Œå°šæœªæ”¶æ•›åˆ°å•ä¸€æ ‡å‡†çš„é¢œè‰²å­—ä½“ã€‚ MacoSï¼ŒWindowså’ŒLinuxä¸Šçš„System Emojiå­—ä½“éƒ½ä½¿ç”¨ä¸åŒçš„å­—ä½“æŠ€æœ¯æ¥å­˜å‚¨é¢œè‰²å­—å½¢ï¼ŒèŒƒå›´å­˜å‚¨å•ä¸ªä½å›¾ï¼Œä»¥å°†æ¯ä¸ªå­—å½¢å­˜å‚¨ä¸ºSVGã€‚è¿™æ˜¯ä¸ç¡®å®šçš„ï¼Œä½¿äº‹æƒ…å¤æ‚åŒ–ã€‚ä¸ºäº†å¢åŠ ä¼¤å®³ï¼Œè¡¨æƒ…ç¬¦å·é€šå¸¸ä¼šç•¥å¤§äºå‘¨å›´æ–‡æœ¬ï¼Œå¹¶ä»¥éå¸¸æ“ä½œçš„æ–¹å¼ç•¥å¾®é™ä½çš„åŸºçº¿ï¼ˆè¿™ä¸é€‚ç”¨äºæ‰€æœ‰é¢œè‰²å­—ä½“;åªæœ‰Emojisï¼‰ã€‚</p><p> Why am I telling you this? Well, honestly it is mostly to make you appreciate the labor that went into the fact that color fonts (and by extension, emojis) now just work:</p><p> ä¸ºä»€ä¹ˆæˆ‘å‘Šè¯‰ä½ è¿™ä¸ªï¼Ÿå¥½å§ï¼Œè¯šå®ï¼Œå®ƒä¸»è¦æ˜¯è®©ä½ æ¬£èµåˆ°ç°åœ¨åªæ˜¯å·¥ä½œçš„é¢œè‰²å­—ä½“ï¼ˆå’Œæ‰©å±•ï¼ŒEmojisï¼‰çš„äº‹å®ï¼š</p><p> emojis  &lt;-  &#34;ğŸ‘©ğŸ¾â€ğŸ’»ğŸ”¥ğŸ“Š&#34; p  &lt;-   ggplot ( )  +   geom_label (   aes (x  =  0, y  =  0, label  =  emojis ), family  =  &#34;Apple Color Emoji&#34;  ) preview_devices ( p,  &#34;emoji&#34; )</p><p> Emojisï¼†lt;  - ï¼†ï¼ƒ34;ğŸ‘©ğŸ¾ğŸ’»ğŸ”¥ğŸ“Šï¼†ï¼ƒ34; pï¼†lt; ggplotï¼ˆï¼‰+ geom_labelï¼ˆaesï¼ˆx = 0ï¼Œy = 0ï¼Œlabel = emojisï¼‰ï¼Œfamily =ï¼†ï¼ƒ34;è‹¹æœé¢œè‰²è¡¨æƒ…ç¬¦å·ï¼†ï¼ƒ34;ï¼‰preview_devicesï¼ˆpï¼Œï¼†ï¼ƒ34; emojiï¼†ï¼ƒ34; ï¼‰</p><p>  As one can see, the failures range from not being able to render anything, to rendering in monochrome. Further, it appears as if the devices have trouble figuring out the dimensions of the glyphs. One additional wrinkle is that while Cairo on macOS is capable of rendering in monochrome, it fails to get the correct emoji. This is because emojis rely heavily on ligatures, and the â€œdark-skinned woman at a computerâ€ emoji is actually a ligature of the â€œwomanâ€, â€œdark skinâ€, and â€œcomputerâ€ emojis.</p><p>  å¯ä»¥çœ‹åˆ°ï¼Œå¤±è´¥èŒƒå›´ä»æ— æ³•å‘ˆç°ä»»ä½•ä¸œè¥¿ï¼Œä»¥ä¾¿åœ¨å•è‰²ä¸­æ¸²æŸ“ã€‚æ­¤å¤–ï¼Œçœ‹èµ·æ¥ä¼¼ä¹è®¾å¤‡éš¾ä»¥å¼„æ¸…å‡ºæ ¼æœ¯çš„å°ºå¯¸ã€‚ä¸€ä¸ªé¢å¤–çš„çš±çº¹æ˜¯ï¼Œè™½ç„¶åœ¨MacOSä¸Šçš„å¼€ç½—èƒ½å¤Ÿåœ¨å•è‰²ä¸­æ¸²æŸ“ï¼Œä½†å®ƒæ— æ³•è·å¾—æ­£ç¡®çš„è¡¨æƒ…ç¬¦å·ã€‚è¿™æ˜¯å› ä¸ºemojisä¸¥é‡ä¾èµ–éŸ§çš®ï¼Œè€Œâ€œè®¡ç®—æœºä¸Šçš„é»‘çš®è‚¤â€è¡¨æƒ…ç¬¦å·å®é™…ä¸Šæ˜¯â€œå¥³äººâ€ï¼Œâ€œæš—çš®è‚¤â€å’Œâ€œè®¡ç®—æœºâ€è¡¨æƒ…ç¬¦å·çš„è”ç³»ã€‚</p><p>  In all of the above examples we have been very mindful in setting the font-face to a font that contains all the glyphs we need. This is not always practical, especially when you want to mix emojis and regular text. It is also an absolute requirement when mixing Latin and CJK (Chinese, Japanese, and Korean) text, as it is infeasible to include all CJK glyphs in a single font. However, we are used to things just working at the system level. No matter which font we choose it seems that a glyph is always displayed in e.g.Â browsers and text editors. This is because the OS is employing  font fallback, which is the act of figuring out an alternative font to use when a glyph is not present in the chosen font. Wouldnâ€™t it be great if we could have that in a graphic device? Well, now we do!</p><p>  åœ¨ä¸Šé¢çš„æ‰€æœ‰ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´éå¸¸æ³¨æ„å°†å­—ä½“é¢å¯¹è®¾ç½®ä¸ºåŒ…å«æˆ‘ä»¬æ‰€éœ€è¦çš„æ‰€æœ‰å­—å½¢çš„å­—ä½“ã€‚è¿™å¹¶ä¸æ€»æ˜¯å®ç”¨çš„ï¼Œç‰¹åˆ«æ˜¯å½“æ‚¨æƒ³æ··åˆEmojiså’Œå¸¸è§„æ–‡æœ¬æ—¶ã€‚åœ¨æ··åˆæ‹‰ä¸è¯­å’ŒCJKï¼ˆä¸­æ–‡ï¼Œæ—¥è¯­å’ŒéŸ©è¯­ï¼‰æ–‡æœ¬æ—¶ï¼Œå®ƒä¹Ÿæ˜¯ç»å¯¹çš„è¦æ±‚ï¼Œå› ä¸ºå®ƒåœ¨å•ä¸ªå­—ä½“ä¸­åŒ…å«æ‰€æœ‰CJKå­—å½¢æ˜¯ä¸å¯è¡Œçš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹ æƒ¯äºåœ¨ç³»ç»Ÿçº§åˆ«å·¥ä½œçš„äº‹æƒ…ã€‚æ— è®ºæˆ‘ä»¬é€‰æ‹©å“ªä¸ªå­—ä½“ï¼Œä¼¼ä¹å§‹ç»ˆæ˜¾ç¤ºåœ¨ä¾‹å¦‚æœ¯ä¸­ã€‚æµè§ˆå™¨å’Œæ–‡æœ¬ç¼–è¾‘å™¨ã€‚è¿™æ˜¯å› ä¸ºæ“ä½œç³»ç»Ÿæ­£åœ¨é‡‡ç”¨å­—ä½“å›é€€ï¼Œè¿™æ˜¯å½“åœ¨æ‰€é€‰æ‹©çš„å­—ä½“ä¸­ä¸å­˜åœ¨å­—å½¢æ—¶è¦ç”¨çš„æ›¿ä»£å­—ä½“çš„åŠ¨ä½œã€‚å¦‚æœæˆ‘ä»¬åœ¨å›¾å½¢è®¾å¤‡ä¸­æœ‰è¿™ä¸€ç‚¹ï¼Œé‚£ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿå¥½å§ï¼Œç°åœ¨æˆ‘ä»¬è¿™æ ·åšï¼ </p><p> fallback_text  &lt;-  &#34;This is English, ã“ã®æ–‡ã¯æ—¥æœ¬èªã§ã™ ğŸš€&#34; p  &lt;-   ggplot ( )  +   geom_text (  aes (x  =  0, y  =  0, label  =  fallback_text ), size  =  2.5 ) preview_devices ( p,  &#34;fallback&#34; )</p><p>exprack_textï¼†lt;  - ï¼†ï¼ƒ34;è¿™æ˜¯è‹±è¯­ï¼Œã“ã®æ–‡ã¯æ—¥æœ¬è¯­ã§ã™ï¼†ï¼ƒ34; pï¼†lt;  -  ggplotï¼ˆï¼‰+ geom_textï¼ˆaesï¼ˆx = 0ï¼Œy = 0ï¼Œlabel = suppack_textï¼‰ï¼Œsize = 2.5ï¼‰preview_devicesï¼ˆpï¼Œï¼†ï¼ƒ34;å›é€€å’Œï¼ƒ34;ï¼‰</p><p>  The bottom line is that with ragg, you now donâ€™t need to think about missing glyphs in any font you choose (unless you request a character that is not covered by any font on your system).</p><p>  åº•çº¿ä¸RAGGä¸€èµ·ï¼Œæ‚¨ç°åœ¨ä¸éœ€è¦è€ƒè™‘åœ¨æ‚¨é€‰æ‹©çš„ä»»ä½•å­—ä½“ä¸­ä¸¢å¤±çš„å­—å½¢ï¼ˆé™¤éæ‚¨è¦æ±‚ç³»ç»Ÿä¸Šä»»ä½•å­—ä½“æ¶µç›–çš„å­—ç¬¦ï¼‰ã€‚</p><p>  Most of what we have shown today simply works automagically and may (depending on your prior frustrations with script support in R) seem too good to be true. Is there any catch? Not really. systemfonts, textshaping, and ragg try to be as smart as possible about text shaping and only take additional action if required. Further everything is heavily cached, so the impact on performance is negligible.</p><p>  æˆ‘ä»¬ä»Šå¤©æ‰€è¡¨ç°å‡ºçš„å¤§å¤šæ•°éƒ½æ˜¯è‡ªè‡ªåŠ¨ä½œç”¨çš„ï¼Œå¹¶ä¸”å¯èƒ½ï¼ˆæ ¹æ®æ‚¨åœ¨rä¸­çš„è„šæœ¬æ”¯æŒçš„å…ˆå‰æŒ«æŠ˜ï¼‰ä¼¼ä¹å¤ªå¥½äº†ã€‚æœ‰æ²¡æœ‰æ•è·ï¼Ÿå¹¶ä¸çœŸåœ°ã€‚ SystemFontsï¼ŒTextShapingå’ŒRaggå°½å¯èƒ½æ™ºèƒ½åœ°å¡‘é€ ï¼Œå¹¶ä¸”åªéœ€é‡‡å–é¢å¤–çš„æ“ä½œï¼Œå¦‚æœéœ€è¦ã€‚è¿›ä¸€æ­¥çš„ä¸€åˆ‡éƒ½å¾ˆé«˜é€Ÿç¼“å­˜ï¼Œå› æ­¤å¯¹æ€§èƒ½çš„å½±å“å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p><p> There is something missing though, which we havenâ€™t touched upon. Not all scripts are LtR or RtL. A few, especially Asian scripts, are top-to-bottom. Top-to-bottom scripts are sadly not yet supported. This is not due to any limitation in the underlying shaping technology, but due to limitations in the R graphics engine, which assumes horizontal text in key places of the API. This means that, until the graphics engine is updated, it is outside the grasp of graphic devices to support vertical text. Hopefully, this is an area that will improve in the future.</p><p> æˆ‘ä»¬æ²¡æœ‰è§¦åŠçš„ä¸œè¥¿å¤±è¸ªã€‚å¹¶éæ‰€æœ‰è„šæœ¬éƒ½æ˜¯LTRæˆ–RTLã€‚å°‘æ•°å°¤å…¶æ˜¯äºšæ´²è„šæœ¬ï¼Œæ˜¯é¡¶åˆ°åº•çš„ã€‚æ‚²ä¼¤åœ°å°šæœªæ”¯æŒè‡ªä¸Šè€Œä¸‹çš„è„šæœ¬ã€‚è¿™ä¸æ˜¯ç”±äºåº•å±‚å¡‘é€ æŠ€æœ¯çš„ä»»ä½•é™åˆ¶ï¼Œè€Œæ˜¯ç”±äºRå›¾å½¢å¼•æ“çš„é™åˆ¶ï¼Œè¿™åœ¨APIçš„å…³é”®ä½ç½®å‡è®¾æ°´å¹³æ–‡æœ¬ã€‚è¿™æ„å‘³ç€ï¼Œç›´åˆ°æ›´æ–°å›¾å½¢å¼•æ“ï¼Œå®ƒè¶…å‡ºäº†å›¾å½¢è®¾å¤‡çš„æŒæ¡ä»¥æ”¯æŒå‚ç›´æ–‡æœ¬ã€‚å¸Œæœ›è¿™æ˜¯æœªæ¥ä¼šæ”¹å–„çš„ä¸€ä¸ªåœ°åŒºã€‚</p><p>  I hope youâ€™ll appreciate the new features described here. Iâ€™d like to thank everyone who have helped validate the text rendering on Twitter. A special thanks goes out to Behdad Esfahbod (  http://behdad.org) for his work on HarfBuzz, Fribidi, and almost everything else underlying modern font rendering. He has been especially gracious in his help and support.</p><p>  æˆ‘å¸Œæœ›æ‚¨å°†æ¬£èµè¿™é‡Œæè¿°çš„æ–°åŠŸèƒ½ã€‚æˆ‘è¦æ„Ÿè°¢æ‰€æœ‰å¸®åŠ©éªŒè¯Twitterä¸Šçš„æ–‡æœ¬æ¸²æŸ“çš„äººã€‚ç‰¹åˆ«æ„Ÿè°¢Behdad esfahbodï¼ˆhttp://behdad.orgï¼‰åœ¨Harfbuzzï¼ŒFribidiï¼Œä»¥åŠå‡ ä¹æ‰€æœ‰å…¶ä»–æ½œåœ¨çš„ç°ä»£å­—ä½“æ¸²æŸ“ä¸­çš„å·¥ä½œã€‚ä»–çš„å¸®åŠ©å’Œæ”¯æŒæ˜¯ç‰¹åˆ«ä»æ…ˆçš„ã€‚ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.tidyverse.org/blog/2021/02/modern-text-features/">https://www.tidyverse.org/blog/2021/02/modern-text-features/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/æ–‡æœ¬/">#æ–‡æœ¬</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/text/">#text</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/å­—ä½“/">#å­—ä½“</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ†äº«/">#åˆ†äº«</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>