<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Androidé€†å‘å·¥ç¨‹ä¸ºåˆå­¦è€… -  Dexcalibur Android reverse engineering for beginners â€“ Dexcalibur</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Android reverse engineering for beginners â€“ Dexcalibur<br/>Androidé€†å‘å·¥ç¨‹ä¸ºåˆå­¦è€… -  Dexcalibur </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-03-20 16:16:13</div><div class="page_narrow text-break page_content"><p>In this post I introduce you to  Dexcalibur a great tool that makes dynamic analysis reachable to beginners.This article is special since it was proof-read by Dexcalibur&#39;s developer himself!Thank you  @FrenchYeti for taking this time to read this even though I know you have a million other things to do, including a new and improved version of the tool ;)</p><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å‘ä½ ä»‹ç»äº†ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œä½¿åŠ¨æ€åˆ†æèƒ½å¤Ÿå¯¹åˆå­¦è€…è¿›è¡ŒåŠ¨æ€åˆ†æã€‚è¿™ç¯‡æ–‡ç« æ˜¯ç‰¹æ®Šçš„ï¼Œå› ä¸ºå®ƒè¢«Dexcaliburï¼†ï¼ƒ39æ‰€å†™çš„è¯æ˜é˜…è¯»ã€‚è°¢è°¢@Frenchyetiç”šè‡³éœ€è¦è¯»è¿™æ¬¡è™½ç„¶æˆ‘çŸ¥é“ä½ æœ‰ä¸€ç™¾ä¸‡å…¶ä»–äº‹æƒ…è¦åšï¼ŒåŒ…æ‹¬ä¸€ä¸ªæ–°çš„å’Œæ”¹è¿›çš„å·¥å…·ç‰ˆæœ¬;ï¼‰</p><p> This article is the third of a series where I use the  kbg messenger Android CTF to demonstrate the basics of Android reverse engineering. The KGB messenger CTF contains 3 challenges that should be solved sequentially:</p><p> æœ¬æ–‡æ˜¯æˆ‘ä½¿ç”¨KBG Messenger Android CTFçš„ç¬¬ä¸‰ä¸ªç³»åˆ—ï¼Œä»¥å±•ç¤ºAndroidé€†å‘å·¥ç¨‹çš„åŸºç¡€çŸ¥è¯†ã€‚ KGB Messenger CTFåŒ…å«3ä¸ªåº”æŒ‰é¡ºåºè§£å†³çš„3ä¸ªæŒ‘æˆ˜ï¼š</p><p>  In this series, I use the first challenge  Alerts to introduce you to multiple Android Reverse engineering tools.In  the first post I demonstrated how to solve the challenge by decompiling the apk and patching the smali code with JADX, APKLab and apktool.In  the second post, we solved the challenge using dynamic analysis with  Frida.</p><p>  åœ¨æœ¬ç³»åˆ—ä¸­ï¼Œæˆ‘ä½¿ç”¨ç¬¬ä¸€ä¸ªæŒ‘æˆ˜è­¦æŠ¥å‘æ‚¨ä»‹ç»å¤šä¸ªAndroidé€†å‘å·¥ç¨‹å·¥å…·ã€‚åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ç”¨Jadxï¼ŒAPKLABå’ŒAPKOOLä¿®è¡¥APKå’Œä¿®è¡¥SMALIä»£ç æ¥è§£å†³æŒ‘æˆ˜ã€‚é‚®æ”¿ï¼Œæˆ‘ä»¬ä½¿ç”¨Fridaä½¿ç”¨åŠ¨æ€åˆ†æè§£å†³äº†æŒ‘æˆ˜ã€‚</p><p>  Dexcalibur is a NodeJS tool working on Windows, macOS and GNU/Linux that uses Frida to allow you to inject snippets of code into Android applications.</p><p>  Dexcaliburæ˜¯åœ¨Windowsï¼ŒMacOSå’ŒGNU / Linuxä¸Šå·¥ä½œçš„NodeJSå·¥å…·ï¼Œå®ƒä½¿ç”¨Fridaå…è®¸æ‚¨å°†ä»£ç ç‰‡æ®µæ³¨å…¥Androidåº”ç”¨ç¨‹åºã€‚</p><p> Dexcalibur makes it easy to create hooks but does much more to help you deobfuscate the code:</p><p> Dexcaliburè®©æ‚¨è½»æ¾åˆ›å»ºæŒ‚é’©ï¼Œä½†æ›´å¤šçš„æ˜¯å¸®åŠ©æ‚¨ä½¿ç”¨æ‹†é™¤ä»£ç ï¼š</p><p> it detects code that is dynamically loaded and adds it in the workspace for you to inspect it.</p><p> å®ƒæ£€æµ‹åˆ°åŠ¨æ€åŠ è½½çš„ä»£ç ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°å·¥ä½œåŒºä¸­ä¾›æ‚¨æ£€æŸ¥ã€‚</p><p>    Dexcalibur is built on NodeJS. To make sure you have the correct version, you should install  nvm, a node version manager.</p><p>    Dexcaliburå»ºäºNodeJSã€‚è¦ç¡®ä¿æ‚¨æ‹¥æœ‰æ­£ç¡®çš„ç‰ˆæœ¬ï¼Œæ‚¨åº”è¯¥å®‰è£…NVMï¼Œä¸€ä¸ªèŠ‚ç‚¹ç‰ˆæœ¬ç®¡ç†å™¨ã€‚ </p><p> If you use  zsh like me you can install nvm as a  zsh plugin. Basically you clone the repo with  git clone https://github.com/lukechilds/zsh-nvm ~/.oh-my-zsh/custom/plugins/zsh-nvm and add the plugin  zsh-nvm in your  .zshrc.You can then source your  .zshrc which will perform the install. You can also add the plugin  nvm for the autocompletion.</p><p>å¦‚æœæ‚¨ä½¿ç”¨åƒæˆ‘è¿™æ ·çš„ZSHï¼Œæ‚¨å¯ä»¥å°†NVMå®‰è£…ä¸ºZSHæ’ä»¶ã€‚åŸºæœ¬ä¸Šä½ ç”¨git clone https://github.com/lukechilds/zsh-nvmã€œ/ .oh-my-zsh / custom / plusins / zsh-nvmå…‹éš†å›è´­ï¼Œå¹¶åœ¨ä½ çš„.zshrc.youä¸­æ·»åŠ æ’ä»¶zsh-nvm.youç„¶åå¯ä»¥æºæ‚¨çš„.zshrcï¼Œå®ƒå°†æ‰§è¡Œå®‰è£…ã€‚æ‚¨è¿˜å¯ä»¥æ·»åŠ ç”¨äºè‡ªåŠ¨å®Œæˆçš„æ’ä»¶NVMã€‚</p><p>    The officiall Dexcalibur&#39;s documentation indicates that NodeJS 12 is necessary for the program to work.</p><p>    å®˜æ–¹å¾·é‡Œå…‹è¥¿å°”åšå°”å’Œï¼ƒ39; Sæ–‡æ¡£è¡¨ç¤ºNodeJS 12æ˜¯ç”¨äºå·¥ä½œç¨‹åºæ‰€å¿…éœ€çš„ã€‚</p><p>   In case you have multiple node versions installed, you can list them with  nvm list then select version 12 as the default version with  nvm use v12.</p><p>   å¦‚æœæ‚¨å®‰è£…äº†å¤šä¸ªèŠ‚ç‚¹ç‰ˆæœ¬ï¼Œåˆ™å¯ä»¥ä½¿ç”¨NVMåˆ—è¡¨åˆ—å‡ºå®ƒä»¬ï¼Œç„¶åé€‰æ‹©ç‰ˆæœ¬12ä½œä¸ºä½¿ç”¨NVMä½¿ç”¨V12çš„é»˜è®¤ç‰ˆæœ¬ã€‚</p><p>     Frida is the tool Dexcalibur is using to create hooks. Usually, penetration testers use Frida directly to do their reverse engineering, and this process can be tedious. Dexcalibur gives us an easy way of reversing an Android application without the hassle of setting up the Frida scripts! Check out my  previous article to get started with Frida.</p><p>     Fridaæ˜¯Dexcaliburçš„å·¥å…·æ­£åœ¨ä½¿ç”¨å®ƒæ¥åˆ›å»ºé’©å­ã€‚é€šå¸¸ï¼Œæ¸—é€æµ‹è¯•ä»ªç›´æ¥ä½¿ç”¨Fridaè¿›è¡Œé€†å‘å·¥ç¨‹ï¼Œè¿™ä¸€è¿‡ç¨‹å¯èƒ½æ˜¯ä¹å‘³çš„ã€‚ Dexcaliburä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œå¯ä»¥åœ¨æ²¡æœ‰è®¾ç½®Fridaè„šæœ¬çš„æƒ…å†µä¸‹å€’æ¢Androidåº”ç”¨ç¨‹åºï¼æŸ¥çœ‹æˆ‘ä»¥å‰çš„æ–‡ç« ä»¥å¼€å§‹Fridaã€‚</p><p>        If you get an error like  python not found at the end of the installation, you might need to install a tool to make python point to python3:  sudo apt install python-is-python3.</p><p>        å¦‚æœæ‚¨åœ¨å®‰è£…ç»“æŸæ—¶æ‰¾ä¸åˆ°Pythonç­‰é”™è¯¯ï¼Œåˆ™å¯èƒ½éœ€è¦å®‰è£…ä¸€ä¸ªå·¥å…·ï¼Œä½¿PythonæŒ‡å‘Python3ï¼šsudo aptå®‰è£…python-is-python3ã€‚</p><p>  Start the configuration process. Dexcalibur comes with sane defaults but you might want to change where the workspace is saved.</p><p>  å¯åŠ¨é…ç½®è¿‡ç¨‹ã€‚ Dexcaliburé™„å¸¦Saneé»˜è®¤å€¼ï¼Œä½†æ‚¨å¯èƒ½å¸Œæœ›æ›´æ”¹å·¥ä½œç©ºé—´ä¿å­˜çš„ä½ç½®ã€‚</p><p>    All of our tools are installed, it is time to set up our lab composed of our phone and our test application.</p><p>    æˆ‘ä»¬æ‰€æœ‰çš„å·¥å…·éƒ½å·²å®‰è£…ï¼Œæ˜¯æ—¶å€™è®¾ç½®æˆ‘ä»¬çš„æ‰‹æœºå’Œæµ‹è¯•åº”ç”¨ç¨‹åºçš„å®éªŒå®¤ã€‚ </p><p>  You should refer to the  previous article to learn how to install and use  adb on your test phone.My setup consists of an Ubuntu 18.04 machine and a Samsung Galaxy S7 (SM-G930F) with a rooted LineageOS 14.1-20180712-NIGHTLY-herolte. You could also use an emulator if you don&#39;t have an Android phone to perform your tests.</p><p>æ‚¨åº”è¯¥å‚è€ƒä¸Šä¸€ç¯‡æ–‡ç« å­¦ä¹ å¦‚ä½•åœ¨æµ‹è¯•ç”µè¯ä¸Šå®‰è£…å’Œä½¿ç”¨adb.my Setupç”±Ubuntu 18.04æœºå™¨å’Œä¸‰æ˜ŸGalaxy S7ï¼ˆSM-G930Fï¼‰ç»„æˆï¼Œå¸¦æœ‰æ¤æ ¹çº¿æœç´¢4.1-20180712-noverly-herolteã€‚å¦‚æœæ‚¨å¯ä»¥ä½¿ç”¨ï¼†ï¼ƒ39; Tæœ‰ä¸€ä¸ªAndroidæ‰‹æœºæ¥æ‰§è¡Œæµ‹è¯•ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ¨¡æ‹Ÿå™¨ã€‚</p><p> Make sure the  kgb messenger application is installed on your phone.You can install it with:</p><p> ç¡®ä¿åœ¨æ‰‹æœºä¸Šå®‰è£…äº†KGB Messengeråº”ç”¨ç¨‹åºã€‚æ‚¨å¯ä»¥ä½¿ç”¨ï¼š</p><p>   You also need to run frida-server on the phone.You have to make sure that the major version of frida-server matches the major version of frida-node used by Dexcalibur.If you have a bash shell you can get the version used by Dexcalibur with this command:</p><p>   æ‚¨è¿˜éœ€è¦åœ¨æ‰‹æœºä¸Šè¿è¡ŒFrida-Server.Youå¿…é¡»ç¡®ä¿FIDA-Serverçš„ä¸»è¦ç‰ˆæœ¬ä¸Dexcaliburä½¿ç”¨çš„Frida-nodeçš„ä¸»è¦ç‰ˆæœ¬åŒ¹é…ã€‚å¦‚æœæ‚¨æœ‰ä¸€ä¸ªbash shellï¼Œæ‚¨å¯ä»¥è·å¾—ä½¿ç”¨çš„ç‰ˆæœ¬Dexcaliburä½¿ç”¨æ­¤å‘½ä»¤ï¼š</p><p>  Here Dexcalibur uses the version 14.2.13 of frida-node, so on the  frida releases page I download the latest  frida-server with a version starting with  14, which also happens to be  14.2.13 in this case.</p><p>  åœ¨è¿™é‡Œï¼ŒDexcaliburä½¿ç”¨FIDA-Nodeçš„ç‰ˆæœ¬14.2.13ï¼Œå› æ­¤åœ¨Fridaå‘è¡Œé¡µé¢ä¸Šï¼Œæˆ‘ä¸‹è½½äº†æœ€æ–°çš„Frida-Serverï¼Œå…¶ä¸­ä¸€ä¸ªç‰ˆæœ¬ä»14å¼€å§‹ï¼Œå®ƒä¹Ÿå‘ç”Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º14.2.13ã€‚</p><p> Once you have the correct version of frida-server, uncompress the archive and rename the server to &#34;frida-server&#34;</p><p> æœ‰ä¸€ä¸ªæ­£ç¡®ç‰ˆæœ¬çš„Frida-Serverï¼Œè§£å‹ç¼©å­˜æ¡£å¹¶å°†æœåŠ¡å™¨é‡å‘½åä¸ºï¼†ï¼ƒ34; Frida-Serverï¼†ï¼ƒ34;</p><p>    Next you have to start the server. This last step must be done as root:</p><p>    æ¥ä¸‹æ¥ï¼Œæ‚¨å¿…é¡»å¯åŠ¨æœåŠ¡å™¨ã€‚æœ€åä¸€æ­¥å¿…é¡»æŒ‰rootå®Œæˆï¼š</p><p>  Finally run  adb devices -l to make sure the adb daemon is running.You now have a phone with adb, the target application and frida-server installed.We&#39;re ready to do some reversing!</p><p>  æœ€åè¿è¡Œadb devices -lä»¥ç¡®ä¿adbå®ˆæŠ¤ç¨‹åºæ­£åœ¨è¿è¡Œã€‚æ‚¨ç°åœ¨æœ‰ä¸€ä¸ªå¸¦æœ‰adbçš„æ‰‹æœºï¼Œç›®æ ‡åº”ç”¨ç¨‹åºå’Œfrida-server .weï¼†ï¼ƒ39;å‡†â€‹â€‹å¤‡å¥½æ¢ä¹˜æŠ˜ç£¨ï¼ </p><p>  The purpose of this article is to get started with the tool, so I used a very simple application to do the demonstration.You&#39;ll find the detailed static analysis in the  previous article, but as quick reminder, when we open the app, we are greeted with an error message saying:</p><p>æœ¬æ–‡çš„ç›®çš„æ˜¯å¼€å§‹ä½¿ç”¨è¯¥å·¥å…·ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨äº†ä¸€ä¸ªéå¸¸ç®€å•çš„åº”ç”¨ç¨‹åºæ¥åšæ¼”ç¤ºã€‚æ‚¨å¯ä»¥åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æ‰¾åˆ°è¯¦ç»†çš„é™æ€åˆ†æï¼Œä½†éšç€æˆ‘ä»¬æ‰“å¼€åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯ä»¥å¿«é€Ÿæé†’ã€‚ ï¼Œæˆ‘ä»¬è¢«æ‰“æ‹›å‘¼äº†ä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼Œè¯´æ˜ï¼š</p><p>       public  void  onCreate (  bundle )  {  super . onCreate (bundle ) ;  setContentView ( ( int )   .layout .activity_main ) ;   property  =   . getProperty ( &#34;user.home&#34; ) ;   str  =   . getenv ( &#34;USER&#34; ) ;  if  (property  ==  null  || property . isEmpty ( )  ||  !property . equals ( &#34;Russia&#34; ) )  {  a ( &#34;Integrity Error&#34; ,  &#34;This app can only run on Russian devices.&#34; ) ;  }  else  if  (str  ==  null  || str . isEmpty ( )  ||  !str . equals ( getResources ( ) . getString (  .string .User ) ) )  {  a ( &#34;Integrity Error&#34; ,  &#34;Must be on the user whitelist.&#34; ) ;  }  else  { a . a ( this ) ;  startActivity ( new   ( this ,   . class ) ) ;  } }</p><p>       å…¬å…±ç©ºç™½oncreateï¼ˆæ†ç»‘ï¼‰{è¶…çº§ã€‚ oncreateï¼ˆæ†ç»‘ï¼‰; setContentViewï¼ˆï¼ˆintï¼‰.layout .act.actity_mainï¼‰;å±æ€§=ã€‚ getPropertyï¼ˆï¼†ï¼ƒ34; user.homeï¼†ï¼ƒ34;ï¼‰; str =ã€‚ GetEnvï¼ˆï¼†ï¼ƒ34;ç”¨æˆ·ï¼†ï¼ƒ34;ï¼‰; ifï¼ˆproperty == null ||å±æ€§ã€‚isemptyï¼ˆï¼‰||ï¼å±æ€§ã€‚ç­‰äºï¼ˆï¼†ï¼ƒ34;ä¿„ç½—æ–¯ï¼†ï¼ƒ34;ï¼‰ï¼‰{aï¼ˆï¼†ï¼ƒ34;å®Œæ•´æ€§é”™è¯¯ï¼†ï¼ƒ34;ï¼Œï¼†ï¼ƒ34;è¿™ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥åªåœ¨ä¿„ç½—æ–¯è®¾å¤‡ä¸Šè¿è¡Œã€‚ï¼†ï¼ƒ34;ï¼‰; }å¦åˆ™å¦‚æœï¼ˆstr == null || strã€‚isemptyï¼ˆï¼‰||ï¼strã€‚ç­‰äºï¼ˆgetresourcesï¼ˆï¼‰ã€‚getstringï¼ˆ.string .userï¼‰ï¼‰ï¼‰{aï¼ˆï¼†ï¼ƒ34;å®Œæ•´æ€§é”™è¯¯ï¼†ï¼ƒ34;ï¼Œï¼†ï¼ƒ 34;å¿…é¡»åœ¨ç”¨æˆ·ç™½åå•ä¸Šã€‚ï¼†ï¼ƒ34;ï¼‰; }åˆ«çš„{aã€‚åœ¨ä»–çš„ ï¼‰ ;å¼€å§‹æ´»åŠ¨ï¼ˆæ–°ï¼ˆç­çº§ï¼‰ï¼‰; }}</p><p>    Let&#39;s start by enrolling our device in Dexcalibur.Visit  http://localhost:8000 and go into the  Device manager tab.There you should see your phone, if not try to disconnect and reconnect your phone and click refresh.</p><p>    é¦–å…ˆé€šè¿‡åœ¨dexcalibur.visit httpï¼š// localhostï¼š8000ä¸­æ³¨å†Œæˆ‘ä»¬çš„è®¾å¤‡å¹¶è¿›å…¥Device Manageré€‰é¡¹å¡ã€‚å¦‚æœä¸å°è¯•æ–­å¼€å¹¶é‡æ–°è¿æ¥æ‰‹æœºï¼Œè¯·å•å‡»â€œåˆ·æ–°â€å¹¶é‡æ–°è¿æ¥æ‰‹æœºï¼Œç„¶åå•å‡»â€œåˆ·æ–°â€ï¼Œç„¶åè¿›å…¥â€œè®¾å¤‡ç®¡ç†å™¨â€é€‰é¡¹å¡ã€‚</p><p>   Next, switch to the  Select an application tab and in the drop down menu choose your phone.</p><p>   æ¥ä¸‹æ¥ï¼Œåˆ‡æ¢åˆ°â€œé€‰æ‹©â€åº”ç”¨ç¨‹åºâ€œé€‰é¡¹å¡ï¼Œç„¶ååœ¨â€ä¸‹æ‹‰èœå•ä¸­â€œé€‰æ‹©æ‰‹æœºã€‚</p><p>    Dexcalibur will start analyzing your package. Once this process is finished, you should land on the Overview page.This page just gives you a basic overview of which packages are used in the application and how much.</p><p>    Dexcaliburå°†å¼€å§‹åˆ†ææ‚¨çš„åŒ…è£¹ã€‚å®Œæˆæ­¤è¿‡ç¨‹åï¼Œæ‚¨åº”è¯¥åœ¨æ¦‚è¿°é¡µé¢ä¸Šé™è½ã€‚æ­¤é¡µé¢åªä¼šä¸ºæ‚¨æä¾›åº”ç”¨ç¨‹åºåœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„åŸºæœ¬æ¦‚è¿°ã€‚</p><p>   Let&#39;s move on to the  Hook &gt; Dashboard view.On this view you have the list of every hook already created by the application.</p><p>   è®©ï¼†ï¼ƒ39;ç»§ç»­å‰è¿›åˆ°é’©å­ï¼†gt;ä»ªè¡¨æ¿View.onæ­¤è§†å›¾æ‚¨æ‹¥æœ‰åº”ç”¨ç¨‹åºå·²åˆ›å»ºçš„æ¯ä¸ªé’©å­çš„åˆ—è¡¨ã€‚</p><p>  For instance Dexcalibur has already created the hook for  java.security.KeyStore.getInstance().Every time this method will be called, we will have a log showing us the parameters of this function and the return value.</p><p>  ä¾‹å¦‚ï¼ŒDexcaliburå·²ç»åˆ›å»ºäº†java.security.keystore.getInstanceï¼ˆï¼‰çš„é’©å­ã€‚æ¯æ¬¡è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæœ‰ä¸€ä¸ªæ—¥å¿—å‘æˆ‘ä»¬å±•ç¤ºæ­¤åŠŸèƒ½çš„å‚æ•°å’Œè¿”å›å€¼ã€‚ </p><p>  Let&#39;s try to run the application with these default hooks to see what happens.In the dashboard, click on  âš¡ Run (spawn).</p><p>è®©ï¼†ï¼ƒ39; så°è¯•ä½¿ç”¨è¿™äº›é»˜è®¤æŒ‚é’©è¿è¡Œåº”ç”¨ç¨‹åºï¼Œä»¥æŸ¥çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚åœ¨ä»ªè¡¨æ¿ä¸­ï¼Œå•å‡»â€œâ¤â€è¿è¡Œï¼ˆSPAWNï¼‰â€œã€‚</p><p>  The application should launch on your phone, and Dexcalibur automatically changes the view to  Hooks &gt; Logs.There you will see all the hooked methods that were called during the execution:</p><p>  åº”ç”¨ç¨‹åºåº”åœ¨æ‰‹æœºä¸Šå¯åŠ¨ï¼ŒDexcaliburè‡ªåŠ¨å°†è§†å›¾æ›´æ”¹ä¸ºæŒ‚é’©ï¼†gt;æ—¥å¿—ã€‚æ‚¨å°†çœ‹åˆ°åœ¨æ‰§è¡ŒæœŸé—´è°ƒç”¨çš„æ‰€æœ‰æŒ‚é’©æ–¹æ³•ï¼š</p><p>  Here is an excerpt of the logs where we can see that the constructor  File() was called with the arguments:</p><p>  ä»¥ä¸‹æ˜¯æ—¥å¿—çš„æ‘˜å½•ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä½¿ç”¨å‚æ•°è°ƒç”¨æ„é€ å‡½æ•°æ–‡ä»¶ï¼ˆï¼‰ï¼š</p><p>    Since we have already done a static analysis of the app, we know that one of the checks looks up the property  user.home with  System.getProperty to verify that the result is &#34;Russia&#34;.Let&#39;s hook this function to bypass the first check.</p><p>    ç”±äºæˆ‘ä»¬å·²ç»å®Œæˆäº†å¯¹åº”ç”¨ç¨‹åºçš„é™æ€åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“å…¶ä¸­ä¸€ä¸ªæ£€æŸ¥å°†ä½¿ç”¨System.getPropertyæŸ¥æ‰¾å±æ€§User.Homeä»¥éªŒè¯ç»“æœæ˜¯ï¼†ï¼ƒ34;ä¿„ç½—æ–¯ï¼†ï¼ƒ34; .letï¼†ï¼ƒ39; sæŒ‚é’©æ­¤åŠŸèƒ½ä»¥ç»•è¿‡ç¬¬ä¸€ä¸ªæ£€æŸ¥ã€‚</p><p> We start by going into the  Static analysis &gt; Search engine view.Dexcalibur provides a search utility with filters. You won&#39;t find a documentation about how to search with Dexcalibur at the moment, but the interface provides utilities to help you search methods and classes in the form of little pills acting like search wizards.</p><p> æˆ‘ä»¬é¦–å…ˆè¿›å…¥é™æ€åˆ†æï¼†gt;æœç´¢å¼•æ“View.dexcaliburæä¾›å¸¦æœ‰æ»¤æ³¢å™¨çš„æœç´¢å®ç”¨ç¨‹åºã€‚æ‚¨èµ¢äº†ï¼†ï¼ƒ39;ç›®å‰æŸ¥æ‰¾æœ‰å…³å¦‚ä½•ä½¿ç”¨Dexcaliburæœç´¢çš„æ–‡æ¡£ï¼Œä½†è¯¥ç•Œé¢æä¾›äº†å®ç”¨ç¨‹åºä»¥å¸®åŠ©æ‚¨ä»¥è¡Œä¸ºæœç´¢å‘å¯¼çš„å°è¯ä¸¸çš„å½¢å¼æœç´¢æ–¹æ³•å’Œè¯¾ç¨‹ã€‚</p><p> Here we want to hook a method called  getProperty so click on the soft orange pill  find method by name:</p><p> åœ¨è¿™é‡Œæˆ‘ä»¬æƒ³é’©é’©ä¸€ä¸ªåä¸ºgetPropertyçš„æ–¹æ³•ï¼Œæ‰€ä»¥ç‚¹å‡»è½¯æ©™è‰²è¯ä¸¸æŒ‰åç§°æ‰¾åˆ°ï¼š</p><p>  This opens a popup where you can fill in the name of the function you are looking for.Note that you can enter a regular expression here like  getProp.* for instance.For now let&#39;s fill in  getProperty.</p><p>  è¿™å°†æ‰“å¼€ä¸€ä¸ªå¼¹å‡ºçª—å£ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­å¡«å†™æ‚¨æ­£åœ¨å¯»æ‰¾çš„å‡½æ•°çš„åç§°ã€‚æ‚¨å¯ä»¥åœ¨æ­¤è¾“å…¥çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚GetPropã€‚*ä¾‹å¦‚ï¼Œå¦‚æœç°åœ¨è®©ï¼†ï¼ƒ39;å¡«å†™GetPropertyã€‚ </p><p>  Because I have already run the Dexcalibur analysis, this gives me 31 results.Notice how Dexcalibur automatically fills in the filter syntax that you could have used manually in the search box.</p><p>å› ä¸ºæˆ‘å·²ç»è¿è¡Œäº†Dexcaliburåˆ†æï¼Œè¿™ç»™äº†æˆ‘31ä¸ªç»“æœ.Noticeå¦‚ä½•åœ¨æœç´¢æ¡†ä¸­è‡ªåŠ¨å¡«å……æ‚¨å¯ä»¥åœ¨æœç´¢æ¡†ä¸­æ‰‹åŠ¨ä½¿ç”¨çš„è¿‡æ»¤å™¨è¯­æ³•ã€‚</p><p>  I&#39;ll show you some tricks to speed up your search later. For now let&#39;s do a good old  CTRL+F and search for  System:</p><p>  æˆ‘ï¼†ï¼ƒ39; LLå‘æ‚¨ç¨åå‘æ‚¨å±•ç¤ºä¸€äº›è¯€çªæ¥åŠ å¿«æœç´¢ã€‚ç°åœ¨è®©ï¼†ï¼ƒ39; såšä¸€ä¸ªå¾ˆå¥½çš„æ—§CTRL + Få¹¶æœç´¢ç³»ç»Ÿï¼š</p><p>  Now comes the magic, if we want to hook these functions, all we have to do is click on the blue button  Probe.Once we have done that, the button switches to green with the text  Probe ON.</p><p>  ç°åœ¨æ˜¯é­”æœ¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³é’©è¿™äº›åŠŸèƒ½ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯ç‚¹å‡»è“è‰²æŒ‰é’®æ¢æµ‹å™¨ã€‚æˆ‘ä»¬å·²ç»å®Œæˆäº†ï¼ŒæŒ‰é’®ä¸æ–‡æœ¬æ¢æµ‹å™¨åˆ‡æ¢åˆ°ç»¿è‰²ã€‚</p><p>  If we go back in the view  Hook &gt; Logs and use the  ğŸ—˜ Re-spawn button, the application will restart and we will see the data that passed through our new hooks.</p><p>  å¦‚æœæˆ‘ä»¬è¿”å›View Hookï¼†gt;æ—¥å¿—å’Œä½¿ç”¨ğŸ—˜é‡æ–°ç”ŸæˆæŒ‰é’®ï¼Œåº”ç”¨ç¨‹åºå°†é‡æ–°å¯åŠ¨ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°é€šè¿‡æˆ‘ä»¬æ–°é’©å­ä¼ é€’çš„æ•°æ®ã€‚</p><p>   In this case the function  java.lang.System.getProperty() was called with the argument  user.home (as expected) and returned an empty string.</p><p>   åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‡½æ•°java.lang.system.getPropertyï¼ˆï¼‰è¢«ç§°ä¸ºArgument User.Homeï¼ˆæŒ‰é¢„æœŸï¼‰å¹¶è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</p><p>    We managed to hook  System.getProperty to display its parameters and its return value.What if we wanted to modify the return value so that it always returns &#34;Russia&#34;?</p><p>    æˆ‘ä»¬è®¾æ³•æŒ‚é’©system.getPropertyä»¥æ˜¾ç¤ºå…¶å‚æ•°åŠå…¶è¿”å›å€¼ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ä¿®æ”¹è¿”å›å€¼ï¼Œé‚£ä¹ˆå®ƒæ€»æ˜¯è¿”å›ï¼†ï¼ƒ34;ä¿„ç½—æ–¯ï¼†ï¼ƒ34;</p><p> To do so, let&#39;s go back to the view  Hook &gt; Dashboard. You will see that our new hooks are listed at the bottom as  custom.In the first column, you will find a green  + button that you can click. This will open an editor where we can customise our hook.</p><p> è¦è¿™æ ·åšï¼Œè®©ï¼†ï¼ƒ39;è¿”å›View Hookï¼†Gt;ä»ªè¡¨æ¿ã€‚æ‚¨å°†çœ‹åˆ°æˆ‘ä»¬çš„æ–°é’©å­åœ¨åº•éƒ¨åˆ—ä¸ºè‡ªå®šä¹‰ã€‚åœ¨ç¬¬ä¸€åˆ—ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç»¿è‰²+æŒ‰é’®ï¼Œæ‚¨å¯ä»¥å•å‡»ã€‚è¿™å°†æ‰“å¼€ä¸€ä¸ªç¼–è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æˆ‘ä»¬çš„é’©å­ã€‚ </p><p>   Dexcalibur is built on top of Frida, a tool allowing us to inject QuickJS code into processes.Your JS gets executed with full access to memory, hooking functions and even calling native functions inside the process. Thereâ€™s also a bi-directional communication channel that is used to talk between your app and the JS running inside the target process.</p><p>Dexcaliburå»ºäºFIDAçš„é¡¶éƒ¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå…è®¸æˆ‘ä»¬å°†QuickJSä»£ç æ³¨å…¥è¿›ç¨‹çš„å·¥å…·ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å®Œå…¨è®¿é—®å†…å­˜ï¼ŒæŒ‚é’©åŠŸèƒ½ç”šè‡³è°ƒç”¨æ­¤è¿‡ç¨‹ä¸­çš„æœ¬æœºå‡½æ•°æ¥æ‰§è¡Œã€‚è¿˜æœ‰ä¸€ä¸ªåŒå‘é€šä¿¡é€šé“ï¼Œç”¨äºåœ¨æ‚¨çš„åº”ç”¨ç¨‹åºå’Œç›®æ ‡è¿‡ç¨‹ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚</p><p> The editor you see allows you to modify this JS code. If you&#39;d like to learn more about Frida, check out  my previous article.</p><p> æ‚¨çœ‹åˆ°çš„ç¼–è¾‘å™¨å…è®¸æ‚¨ä¿®æ”¹æ­¤JSä»£ç ã€‚å¦‚æœæ‚¨ï¼†ï¼ƒ39; dæƒ³äº†è§£æ›´å¤šå…³äºFridaçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¥å‰çš„æ–‡ç« ã€‚</p><p>      Then click on &#34;Save change&#34; (the button without the refresh icon).Now go back on the  Hook &gt; Logs view and click on  ğŸ—˜Respawn.The application loads with a new error message:</p><p>      ç„¶åç‚¹å‡»ï¼†ï¼ƒ34;ä¿å­˜æ›´æ”¹ï¼†ï¼ƒ34; ï¼ˆæ²¡æœ‰åˆ·æ–°å›¾æ ‡çš„æŒ‰é’®ï¼‰.Nowè¿”å›é’©å­ï¼†gt;æ—¥å¿—è§†å›¾å¹¶å•å‡»â€œğŸ—˜respawnâ€ã€‚å…·æœ‰æ–°é”™è¯¯æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºåŠ è½½ï¼š</p><p>      As stated before, Frida offers a bi-directional communication channel used to talk between your app and the JS running inside the target process. Dexcalibur uses this channel to send log data with the function  send:</p><p>      å¦‚å‰æ‰€è¿°ï¼ŒFridaæä¾›äº†ä¸€ä¸ªç”¨äºåœ¨æ‚¨çš„åº”ç”¨ç¨‹åºå’Œç›®æ ‡è¿‡ç¨‹å†…éƒ¨è¿è¡Œçš„APçš„åŒå‘é€šä¿¡é€šé“ã€‚ dexcaliburä½¿ç”¨æ­¤é¢‘é“å°†æ—¥å¿—æ•°æ®å‘é€åˆ°å‡½æ•°å‘é€ï¼š</p><p>  send ( { id : &#34;YTYwOTRkNGU4M2ViYjlmMzRjZjg5NmQ3YThlODQ1Njg&#34; , msg : &#34;java.lang.System.getProperty(&lt;java.lang.String&gt;)&lt;java.lang.String&gt;&#34; , data : {arg0 :arg0 , } , action : &#34;None before&#34; , after : false } ) ; var ret  = meth_f7b4eb07417e35b66dd2fc9687dd2fd3 . call ( this  , arg0 ) ; send ( { id : &#34;YTYwOTRkNGU4M2ViYjlmMzRjZjg5NmQ3YThlODQ1Njg&#34; , msg : &#34;java.lang.System.getProperty(&lt;java.lang.String&gt;)&lt;java.lang.String&gt;&#34; , data : {ret :ret } , action : &#34;None before&#34; , after : true } ) ;</p><p>  å‘é€ï¼ˆ{idï¼šï¼†ï¼ƒ34; ytywotrkngu4m2viyjlmmzrjzjg5nmq3ythlodq1njgï¼†ï¼ƒ34;ï¼Œmsgï¼šï¼†ï¼ƒ34; java.lang.system.getpropertyï¼ˆï¼†lt; java.lang.stringï¼†gt;ï¼‰ï¼†gt;ï¼†ï¼ƒ34;ï¼Œæ•°æ®ï¼š{arg0ï¼šarg0ï¼Œ}ï¼Œactionï¼šï¼†ï¼ƒ34;åœ¨ä¹‹å‰å’Œï¼ƒ34ä¹‹å‰;ï¼Œä¹‹åï¼šfalse}ï¼‰; var ret = meth_f7b4eb07417e35b66dd2fc9687dd2fd3ã€‚è‡´ç”µï¼ˆè¿™ï¼Œarg0ï¼‰;å‘é€ï¼ˆ{idï¼šï¼†ï¼ƒ34; ytywotrkngu4m2viyjlmmzrjzjg5nmq3ythlodq1njgï¼†ï¼ƒ34;ï¼Œmsgï¼šï¼†ï¼ƒ34; java.lang.system.getpropertyï¼ˆï¼†lt; java.lang.stringï¼†gt;ï¼‰ï¼†gt;ï¼†ï¼ƒ34;ï¼Œæ•°æ®ï¼š{RETï¼šRET}ï¼ŒåŠ¨ä½œï¼šï¼†ï¼ƒ34;æ²¡æœ‰ä¹‹å‰åˆ™æ²¡æœ‰*ï¼Œä¹‹åï¼šçœŸå®}ï¼‰;</p><p> If you wish to send back additional data, the creator of Dexcalibur recommends to reuse the existing send functions and update the  data attribute with your additional information.</p><p> å¦‚æœè¦å‘é€è¿”å›å…¶ä»–æ•°æ®ï¼Œåˆ™Dexcaliburçš„åˆ›å»ºè€…å»ºè®®é‡ç”¨ç°æœ‰çš„å‘é€åŠŸèƒ½å¹¶ä½¿ç”¨å…¶ä»–ä¿¡æ¯æ›´æ–°æ•°æ®å±æ€§ã€‚</p><p>  I didn&#39;t have a relevant example in mind so I just decided to list all the methods of the class  Resources and show them in the logs. Here is the modified hook of  getProperty, I added comments delimiting the added code to make it easier to read:</p><p>  æˆ‘æ²¡æœ‰è€ƒè™‘åˆ°ç›¸å…³çš„ç¤ºä¾‹ï¼Œæ‰€ä»¥æˆ‘åˆšåˆšå†³å®šåˆ—å‡ºç±»èµ„æºçš„æ‰€æœ‰æ–¹æ³•ï¼Œå¹¶åœ¨æ—¥å¿—ä¸­æ˜¾ç¤ºå®ƒä»¬ã€‚è¿™æ˜¯GetPropertyçš„ä¿®æ”¹æŒ‚é’©ï¼Œæˆ‘æ·»åŠ äº†è¯„è®ºç•Œå®šçš„è¯„è®ºï¼Œä»¥ä¾¿æ›´å®¹æ˜“é˜…è¯»ï¼š </p><p> var cls_68cfa6743909fdea9bcb71194c415681  =   . use ( &#39;java.lang.System&#39; ) ; var meth_f7b4eb07417e35b66dd2fc9687dd2fd3  = cls_68cfa6743909fdea9bcb71194c415681 . getProperty . overload ( &#39;java.lang.String&#39; ) ;meth_f7b4eb07417e35b66dd2fc9687dd2fd3 . implementation  =  function ( arg0 )  {  // -----------------START ADDITIONAL CODE -------------------------------  // We retrieve all the methods of the class Resources as a string array  const    =   . use ( &#34;android.content.res.Resources&#34; ) ;  const methods  =   . class . getMethods ( ) . map ( function ( m ) {  return m . toString ( ) ;  } ) ;  // -----------------END ADDITIONAL CODE ---------------------------------  send ( { id : &#34;YTYwOTRkNGU4M2ViYjlmMzRjZjg5NmQ3YThlODQ1Njg=&#34; , msg : &#34;java.lang.System.getProperty(&lt;java.lang.String&gt;)&lt;java.lang.String&gt;&#34; ,  // -----------------START ADDITIONAL CODE -----------------------------  // Here we add the object &#34;methods&#34; data : {arg0 :arg0 ,methods :methods } ,  // -----------------END ADDITIONAL CODE ------------------------------- action : &#34;None before&#34; , after : false  } ) ;  var ret  = meth_f7b4eb07417e35b66dd2fc9687dd2fd3 . call ( this  , arg0 ) ;  send ( { id : &#34;YTYwOTRkNGU4M2ViYjlmMzRjZjg5NmQ3YThlODQ1Njg=&#34; , msg : &#34;java.lang.System.getProperty(&lt;java.lang.String&gt;)&lt;java.lang.String&gt;&#34; , data : {ret :ret } , action : &#34;None before&#34; , after : true  } ) ;  return  &#34;Russia&#34; ; }</p><p>var cls_68cfa6743909fdea9bcb71194c415681 =ã€‚ä½¿ç”¨ï¼ˆï¼†ï¼ƒ39; java.lang.systemï¼†ï¼ƒ39;ï¼‰; var meth_f7b4eb07417e35b66dd2fc9687dd2fd3 = cls_68cfa6743909fdea9bcb71194c415681ã€‚ getPropertyã€‚è¿‡è½½ï¼ˆï¼†ï¼ƒ39; java.lang.stringï¼†ï¼ƒ39;ï¼‰; meth_f7b4eb07417e35b66dd2fc9687dd2fd3ã€‚å®ç°=å‡½æ•°ï¼ˆarg0ï¼‰{// -------------------------------------- ---------- //æˆ‘ä»¬å°†ç±»èµ„æºçš„æ‰€æœ‰æ–¹æ³•æ£€ç´¢ä¸ºå­—ç¬¦ä¸²é˜µåˆ—const =ã€‚ä½¿ç”¨ï¼ˆï¼†ï¼ƒ34; android.content.res.resourcesï¼†ï¼ƒ34;ï¼‰; constæ–¹æ³•=ã€‚ç­çº§ ã€‚ getmethodsï¼ˆï¼‰ã€‚æ˜ å°„ï¼ˆå‡½æ•°ï¼ˆmï¼‰{return mã€‚toStringï¼ˆï¼‰;}ï¼‰; // ----------------ç»“æŸé¢å¤–çš„ä»£ç ------------------------------- -----å‘é€ï¼ˆ{idï¼šï¼†ï¼ƒ34; ytywotrkngu4m2viyjlmmzrjzjg5nmq3ythlodq1njg =ï¼†ï¼ƒ34;ï¼Œmsgï¼šï¼†ï¼ƒ34; java.lang.system.getpropertyï¼ˆï¼†lt; java.lang.stringï¼†gt;ï¼‰ï¼†lt; java.langã€‚å­—ç¬¦ä¸²ï¼†gt;ï¼†ï¼ƒ34; ------------------------------------- -------- //æˆ‘ä»¬åœ¨è¿™é‡Œæ·»åŠ å¯¹è±¡ï¼†ï¼ƒ34;æ–¹æ³•ï¼†ï¼ƒ34;æ•°æ®ï¼š{arg0ï¼šarg0ï¼Œæ–¹æ³•ï¼šæ–¹æ³•}ï¼Œ// --------------- ----ç»“æŸé¢å¤–çš„ä»£ç ---------------------------  - è¡ŒåŠ¨ï¼šï¼†ï¼ƒ34;æ²¡æœ‰ä¹‹å‰å’Œï¼ƒ34;ï¼Œä¹‹åï¼šfalse}ï¼‰; var ret = meth_f7b4eb07417e35b66dd2fc9687dd2fd3ã€‚è‡´ç”µï¼ˆè¿™ï¼Œarg0ï¼‰;å‘é€ï¼ˆ{idï¼šï¼†ï¼ƒ34; ytywotrkngu4m2viyjlmmzrjzjg5nmq3ythlodq1njg =ï¼†ï¼ƒ34;ï¼Œmsgï¼šï¼†ï¼ƒ34; java.lang.system.getpropertyï¼ˆï¼†lt; java.lang.stringï¼†gt;ï¼‰ï¼†gt;ï¼†ï¼ƒ34 ;ï¼Œæ•°æ®ï¼š{RETï¼šRET}ï¼ŒåŠ¨ä½œï¼šï¼†ï¼ƒ34;æ²¡æœ‰ä¹‹å‰åˆ™æ²¡æœ‰*ï¼Œä¹‹åï¼šçœŸå®}ï¼‰;è¿”å›ï¼†ï¼ƒ34;ä¿„ç½—æ–¯ï¼†ï¼ƒ34; ; }</p><p>    Earlier, when we wanted to hook  System.getProperty we used the search function in the view  Static analysis &gt; Search engine. In this section I will list some additional tips to search a function.</p><p>    æ—©äº›æ—¶å€™ï¼Œå½“æˆ‘ä»¬æƒ³è¦å‹¾å–System.getPropertyï¼Œæˆ‘ä»¬åœ¨è§†å›¾ä¸­ä½¿ç”¨äº†æœç´¢åŠŸèƒ½é™æ€åˆ†æï¼†gt;æœç´¢å¼•æ“ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†åˆ—å‡ºä¸€äº›é¢å¤–çš„æç¤ºæ¥æœç´¢å‡½æ•°ã€‚</p><p>  In our case we knew exactly the signature of your function:  java.lang.System.getProperty.We can search by signature with the filter  method(&#34;__signature__:&lt;signature_here_as_regex&gt;).</p><p>  åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç¡®åˆ‡åœ°äº†è§£å‡½æ•°çš„ç­¾åï¼šjava.lang.System.getProperty.weå¯ä»¥é€šè¿‡å‰ªè¾‘æœç´¢ç­›é€‰æ–¹æ³•ï¼ˆï¼†ï¼ƒ34; __ç­¾å__ï¼šï¼†lt; signature_hey_here_regexï¼†gt;ï¼‰ã€‚</p><p>   Initially we searched for all methods named  getProperty with  method(&#34;name:getProperty&#34;).We can add another filter to select methods whose enclosing class is named  System:</p><p>   æœ€åˆï¼Œæˆ‘ä»¬æœç´¢äº†ä¸æ–¹æ³•ï¼ˆï¼†ï¼ƒ34;åç§°ï¼šgetPropertyï¼†ï¼ƒ34;ï¼‰çš„æ‰€æœ‰æ–¹æ³•éƒ½æœç´¢äº†åä¸ºgetPropertyçš„æ‰€æœ‰æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥æ·»åŠ å¦ä¸€ä¸ªè¿‡æ»¤å™¨æ¥é€‰æ‹©å…¶æ‹¬å·ç±»çš„å‘½åä¸ºç³»ç»Ÿçš„æ–¹æ³•ï¼š</p><p>  We can use the same logic and select all methods named &#34;getProperty&#34; whose enclosing class are in the package  lang:</p><p>  æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸åŒçš„é€»è¾‘ï¼Œç„¶åé€‰æ‹©åä¸ºï¼†ï¼ƒ34; getPropertyï¼†ï¼ƒ34çš„æ‰€æœ‰æ–¹æ³•;è°çš„å°é—­ç±»æ˜¯åœ¨åŒ…ä¸­çš„å›´ç±»ï¼š</p><p>   The kgb-messenger app is easy to decompile and reverse, and as such, using Dexcalibur to solve this kind of challenge is obviously an overkill. The purpose of this article was to introduce you to the tool and the concepts of dynamic analysis. Even though we mostly relied on static analysis to solve the challenge, you should now have the basics to use Dexcalibur and perform dynamic analyses on obfuscated applications.</p><p>   KGB-Messengeråº”ç”¨ç¨‹åºæ˜“äºåˆ†è§£å’Œåå‘ï¼Œå› æ­¤ï¼Œä½¿ç”¨Dexcaliburæ¥è§£å†³è¿™ç§æŒ‘æˆ˜æ˜¾ç„¶æ˜¯ä¸€ä¸ªçŸ«æ‰è¿‡æ­£ã€‚æœ¬æ–‡çš„ç›®çš„æ˜¯å‘æ‚¨ä»‹ç»åŠ¨æ€åˆ†æçš„å·¥å…·å’Œæ¦‚å¿µã€‚å°½ç®¡æˆ‘ä»¬ä¸»è¦ä¾èµ–äºè§£å†³æŒ‘æˆ˜çš„é™æ€åˆ†æï¼Œä½†æ‚¨ç°åœ¨åº”è¯¥æœ‰åŸºç¡€ä½¿ç”¨Dexcaliburå¹¶å¯¹æ··æ·†åº”ç”¨ç¨‹åºè¿›è¡ŒåŠ¨æ€åˆ†æã€‚ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://braincoke.fr/blog/2021/03/android-reverse-engineering-for-beginners-dexcalibur/">https://braincoke.fr/blog/2021/03/android-reverse-engineering-for-beginners-dexcalibur/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/é€†å‘å·¥ç¨‹/">#é€†å‘å·¥ç¨‹</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/android/">#android</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/é€†å‘/">#é€†å‘</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/reverse/">#reverse</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ†äº«/">#åˆ†äº«</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>