<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Kyæ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨è·å–APIçš„å°å·§ä¼˜é›…çš„HTTPå®¢æˆ·ç«¯Ky is a tiny and elegant HTTP client based on the browser Fetch API</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Ky is a tiny and elegant HTTP client based on the browser Fetch API<br/>Kyæ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨è·å–APIçš„å°å·§ä¼˜é›…çš„HTTPå®¢æˆ·ç«¯</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-25 15:16:46</div><div class="page_narrow text-break page_content"><p>Ky targets  modern browsers and  Deno. For older browsers, you will need to transpile and use a   fetch polyfill and   globalThis polyfill. For Node.js, check out  Got. For isomorphic needs (like SSR), check out   ky-universal.</p><p>Kyçš„ç›®æ ‡æ˜¯ç°ä»£æµè§ˆå™¨å’ŒDenoã€‚å¯¹äºè¾ƒæ—§çš„æµè§ˆå™¨ï¼Œæ‚¨éœ€è¦ä¼ è¾“å¹¶ä½¿ç”¨fetch polyfillå’ŒglobalThis polyfillã€‚ç”¨äºèŠ‚ç‚¹ã€‚jsï¼Œçœ‹çœ‹æˆ‘æœ‰ä»€ä¹ˆã€‚å¯¹äºåŒæ„éœ€æ±‚ï¼ˆå¦‚SSRï¼‰ï¼Œè¯·æŸ¥çœ‹ky universalã€‚</p><p>           import  ky  from  &#39;ky&#39; ; const  json  =  await  ky . post ( &#39;https://example.com&#39; ,  { json:  { foo:  true } } ) . json ( ) ; console . log ( json ) ; //=&gt; `{data: &#39;ğŸ¦„&#39;}`</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›const json=wait kyã€‚å¸–å­ï¼ˆ&#39ï¼›https://example.com&#39; ,  {json:{foo:true}}ï¼‰ã€‚jsonï¼ˆï¼‰ï¼›å®‰æ…°æ—¥å¿—ï¼ˆjsonï¼‰//=&gt`{æ•°æ®ï¼š&#39ï¼›ğŸ¦„&#39;}`</p><p>  class  HTTPError  extends  Error  { } const  response  =  await  fetch ( &#39;https://example.com&#39; ,  {	 method:  &#39;POST&#39; ,	 body:  JSON . stringify ( { foo:  true } ) ,	 headers:  {		 &#39;content-type&#39;:  &#39;application/json&#39;	 } } ) ; if  ( ! response . ok )  {	 throw  new  HTTPError ( `Fetch error:   ${ response . statusText }` ) ; } const  json  =  await  response . json ( ) ; console . log ( json ) ; //=&gt; `{data: &#39;ğŸ¦„&#39;}`</p><p>ç±»HTTPErroræ‰©å±•äº†é”™è¯¯{}const response=wait fetchï¼ˆ&#39ï¼›https://example.com&#39; ,  {method:&#39ï¼›POST&#39ï¼›ï¼Œbody:JSON.stringifyï¼ˆ{foo:true}ï¼‰ï¼Œheaders:{&#39ï¼›content type&#39ï¼›ï¼š&#39ï¼›application/JSON&#39ï¼›}ï¼‰ï¼›å¦‚æœï¼ˆï¼response.okï¼‰{throw new HTTPErrorï¼ˆ`Fetch error:${response.statusText}`ï¼‰ï¼›}const json=ç­‰å¾…å“åº”ã€‚jsonï¼ˆï¼‰ï¼›å®‰æ…°æ—¥å¿—ï¼ˆjsonï¼‰//=&gt`{æ•°æ®ï¼š&#39ï¼›ğŸ¦„&#39;}`</p><p> If you are using  Deno, import Ky from a URL. For example, using a CDN:</p><p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Denoï¼Œè¯·ä»URLå¯¼å…¥Kyã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨CDNï¼š</p><p>     The  credentials option is  same-origin by default, which is the default in the spec too, but not all browsers have caught up yet.</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œcredentialsé€‰é¡¹æ˜¯åŒæºçš„ï¼Œè¿™ä¹Ÿæ˜¯è§„èŒƒä¸­çš„é»˜è®¤é€‰é¡¹ï¼Œä½†å¹¶éæ‰€æœ‰æµè§ˆå™¨éƒ½èƒ½è·Ÿä¸Šã€‚</p><p> Returns a   Response object with   Body methods added for convenience. So you can, for example, call  ky.get(input).json() directly without having to await the  Response first. When called like that, an appropriate  Accept header will be set depending on the body method used. Unlike the  Body methods of  window.Fetch; these will throw an  HTTPError if the response status is not in the range of  200...299. Also,  .json() will return an empty string if the response status is  204 instead of throwing a parse error due to an empty body.</p><p>è¿”å›ä¸€ä¸ªå“åº”å¯¹è±¡ï¼Œä¸ºæ–¹ä¾¿èµ·è§æ·»åŠ äº†Bodyæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥è°ƒç”¨ky.getï¼ˆè¾“å…¥ï¼‰ã€‚ç›´æ¥ä½¿ç”¨jsonï¼ˆï¼‰ï¼Œè€Œä¸å¿…å…ˆç­‰å¾…å“åº”ã€‚å½“è¿™æ ·è°ƒç”¨æ—¶ï¼Œå°†æ ¹æ®æ‰€ä½¿ç”¨çš„bodyæ–¹æ³•è®¾ç½®é€‚å½“çš„Acceptå¤´ã€‚ä¸çª—å£çš„ä¸»ä½“æ–¹æ³•ä¸åŒã€‚å–æ¥å¦‚æœå“åº”çŠ¶æ€ä¸åœ¨200ã€‚ã€‚ã€‚299.æ­¤å¤–ã€‚å¦‚æœå“åº”çŠ¶æ€ä¸º204ï¼Œjsonï¼ˆï¼‰å°†è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ç”±äºæ­£æ–‡ä¸ºç©ºè€Œå¼•å‘è§£æé”™è¯¯ã€‚</p><p>        When using a  Request instance as  input, any URL altering options (such as  prefixUrl) will be ignored.</p><p>å½“ä½¿ç”¨è¯·æ±‚å®ä¾‹ä½œä¸ºè¾“å…¥æ—¶ï¼Œä»»ä½•URLæ›´æ”¹é€‰é¡¹ï¼ˆå¦‚prefixUrlï¼‰éƒ½å°†è¢«å¿½ç•¥ã€‚</p><p>      Internally, the standard methods ( GET,  POST,  PUT,  PATCH,  HEAD and  DELETE) are uppercased in order to avoid server errors due to case sensitivity.</p><p>åœ¨å†…éƒ¨ï¼Œæ ‡å‡†æ–¹æ³•ï¼ˆGETã€POSTã€PUTã€PATCHã€HEADå’ŒDELETEï¼‰æ˜¯å¤§å†™çš„ï¼Œä»¥é¿å…å› åŒºåˆ†å¤§å°å†™è€Œå¯¼è‡´æœåŠ¡å™¨é”™è¯¯ã€‚</p><p>   Shortcut for sending JSON. Use this instead of the  body option. Accepts any plain object or value, which will be  JSON.stringify()&#39;d and sent in the body with the correct header set.</p><p>å‘é€JSONçš„å¿«æ·æ–¹å¼ã€‚ä½¿ç”¨æ­¤é€‰é¡¹è€Œä¸æ˜¯bodyé€‰é¡¹ã€‚æ¥å—ä»»ä½•ç®€å•çš„å¯¹è±¡æˆ–å€¼ï¼Œå³JSONã€‚stringifyï¼ˆï¼‰&#39ï¼›dï¼Œå¹¶ä»¥æ­£ç¡®çš„æ ‡é¢˜é›†å‘é€åˆ°æ­£æ–‡ä¸­ã€‚</p><p>  Type:  string | object&lt;string, string | number | boolean&gt; | Array&lt;Array&lt;string | number | boolean&gt;&gt; | URLSearchParams Default:  &#39;&#39;</p><p>ç±»å‹ï¼šå­—ç¬¦ä¸²|å¯¹è±¡&ltï¼›å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²|æ•°å­—|å¸ƒå°”å€¼&gtï¼›|é˜µåˆ—&ltï¼›é˜µåˆ—&ltï¼›å­—ç¬¦ä¸²|æ•°å­—|å¸ƒå°”å€¼&gt&gtï¼›|URLSearchParamsé»˜è®¤å€¼ï¼š&#39&#39;</p><p> Search parameters to include in the request URL. Setting this will override all existing search parameters in the input URL.</p><p>æœç´¢è¦åŒ…å«åœ¨è¯·æ±‚URLä¸­çš„å‚æ•°ã€‚è®¾ç½®æ­¤é€‰é¡¹å°†è¦†ç›–è¾“å…¥URLä¸­çš„æ‰€æœ‰ç°æœ‰æœç´¢å‚æ•°ã€‚</p><p>    A prefix to prepend to the  input URL when making the request. It can be any valid URL, either relative or absolute. A trailing slash  / is optional and will be added automatically, if needed, when it is joined with  input. Only takes effect when  input is a string. The  input argument cannot start with a slash  / when using this option.</p><p>å‘å‡ºè¯·æ±‚æ—¶åœ¨è¾“å…¥URLå‰åŠ å‰ç¼€ã€‚å®ƒå¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„URLï¼Œæ— è®ºæ˜¯ç›¸å¯¹çš„è¿˜æ˜¯ç»å¯¹çš„ã€‚å°¾éšæ–œæ /æ˜¯å¯é€‰çš„ï¼Œå¦‚æœéœ€è¦ï¼Œå°†åœ¨ä¸è¾“å…¥è¿æ¥æ—¶è‡ªåŠ¨æ·»åŠ ã€‚ä»…å½“è¾“å…¥ä¸ºå­—ç¬¦ä¸²æ—¶ç”Ÿæ•ˆã€‚ä½¿ç”¨æ­¤é€‰é¡¹æ—¶ï¼Œè¾“å…¥å‚æ•°ä¸èƒ½ä»¥æ–œæ /å¼€å¤´ã€‚</p><p>  import  ky  from  &#39;ky&#39; ; // On https://example.com const  response  =  await  ky ( &#39;unicorn&#39; ,  { prefixUrl:  &#39;/api&#39; } ) ; //=&gt; &#39;https://example.com/api/unicorn&#39; const  response2  =  await  ky ( &#39;unicorn&#39; ,  { prefixUrl:  &#39;https://cats.com&#39; } ) ; //=&gt; &#39;https://cats.com/unicorn&#39;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·&#39ï¼›ï¼›//åœ¨â€¦ä¸Šhttps://example.comconst response=wait kyï¼ˆ&#39ï¼›unicorn&#39ï¼›ï¼Œ{prefixUrl:&#39ï¼›/api&#39ï¼›}ï¼‰//=&gt&#39;https://example.com/api/unicorn&#39; const response2=wait kyï¼ˆ&#39ï¼›ç‹¬è§’å…½&#39ï¼›ï¼Œ{prefixUrl:&#39ï¼›https://cats.com&#39; } ) ; //=&gt&#39;https://cats.com/unicorn&#39;</p><p>  After  prefixUrl and  input are joined, the result is resolved against the  base URL of the page (if any).</p><p>prefixUrlå’Œinputè¿æ¥åï¼Œæ ¹æ®é¡µé¢çš„åŸºæœ¬URLï¼ˆå¦‚æœæœ‰ï¼‰è§£æç»“æœã€‚</p><p> Leading slashes in  input are disallowed when using this option to enforce consistency and avoid confusion about how the  input URL is handled, given that  input will not follow the normal URL resolution rules when  prefixUrl is being used, which changes the meaning of a leading slash.</p><p>å¦‚æœä½¿ç”¨æ­¤é€‰é¡¹æ¥å¢å¼ºä¸€è‡´æ€§å¹¶é¿å…å¯¹è¾“å…¥URLçš„å¤„ç†æ–¹å¼äº§ç”Ÿæ··æ·†ï¼Œåˆ™ä¸å…è®¸åœ¨è¾“å…¥ä¸­ä½¿ç”¨å‰å¯¼æ–œæ ï¼Œå› ä¸ºåœ¨ä½¿ç”¨prefixUrlæ—¶ï¼Œè¾“å…¥ä¸ä¼šéµå¾ªæ­£å¸¸çš„URLè§£æè§„åˆ™ï¼Œè¿™ä¼šæ›´æ”¹å‰å¯¼æ–œæ çš„å«ä¹‰ã€‚</p><p>    An object representing  limit,  methods,  statusCodes and  maxRetryAfter fields for maximum retry count, allowed methods, allowed status codes and maximum   Retry-After time.</p><p>è¡¨ç¤ºæœ€å¤§é‡è¯•æ¬¡æ•°ã€å…è®¸çš„æ–¹æ³•ã€å…è®¸çš„çŠ¶æ€ä»£ç å’Œæœ€å¤§é‡è¯•æ—¶é—´çš„é™åˆ¶ã€æ–¹æ³•ã€çŠ¶æ€ä»£ç å’ŒmaxRetryAfterå­—æ®µçš„å¯¹è±¡ã€‚</p><p> If  retry is a number, it will be used as  limit and other defaults will remain in place.</p><p>å¦‚æœretryæ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå®ƒå°†è¢«ç”¨ä½œé™åˆ¶ï¼Œå…¶ä»–é»˜è®¤å€¼å°†ä¿æŒä¸å˜ã€‚</p><p> If  maxRetryAfter is set to  undefined, it will use  options.timeout. If   Retry-After header is greater than  maxRetryAfter, it will cancel the request.</p><p>å¦‚æœmaxRetryAfterè®¾ç½®ä¸ºundefinedï¼Œå®ƒå°†ä½¿ç”¨é€‰é¡¹ã€‚æš‚åœã€‚å¦‚æœRetry Afteræ ‡å¤´å¤§äºmaxRetryAfterï¼Œå®ƒå°†å–æ¶ˆè¯·æ±‚ã€‚</p><p> Delays between retries is calculated with the function  0.3 * (2 ** (retry - 1)) * 1000, where  retry is the attempt number (starts from 1).</p><p>ä½¿ç”¨å‡½æ•°0.3*ï¼ˆ2**ï¼ˆretry-1ï¼‰ï¼‰*1000è®¡ç®—é‡è¯•ä¹‹é—´çš„å»¶è¿Ÿï¼Œå…¶ä¸­retryæ˜¯å°è¯•æ¬¡æ•°ï¼ˆä»1å¼€å§‹ï¼‰ã€‚</p><p>  import  ky  from  &#39;ky&#39; ; const  json  =  await  ky ( &#39;https://example.com&#39; ,  {	 retry:  {		 limit:  10 ,		 methods:  [ &#39;get&#39; ] ,		 statusCodes:  [ 413 ]	 } } ) . json ( ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›const json=wait kyï¼ˆ&#39ï¼›https://example.com&#39; ,  {é‡è¯•ï¼š{limit:10ï¼Œmethods:[&#39ï¼›get&#39ï¼›]ï¼ŒçŠ¶æ€ä»£ç ï¼š[413]}ï¼‰ã€‚jsonï¼ˆï¼‰ï¼›</p><p>   Timeout in milliseconds for getting a response, including any retries. Can not be greater than 2147483647.If set to  false, there will be no timeout.</p><p>è·å–å“åº”ï¼ˆåŒ…æ‹¬é‡è¯•ï¼‰çš„è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰ã€‚ä¸èƒ½å¤§äº2147483647ã€‚å¦‚æœè®¾ç½®ä¸ºfalseï¼Œåˆ™ä¸ä¼šè¶…æ—¶ã€‚</p><p>   Hooks allow modifications during the request lifecycle. Hook functions may be async and are run serially.</p><p>é’©å­å…è®¸åœ¨è¯·æ±‚ç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œä¿®æ”¹ã€‚é’©å­å‡½æ•°å¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”å¯ä»¥ä¸²è¡Œè¿è¡Œã€‚</p><p>   This hook enables you to modify the request right before it is sent. Ky will make no further changes to the request after this. The hook function receives  request and  options as arguments. You could, for example, modify the  request.headers here.</p><p>è¿™ä¸ªé’©å­ä½¿æ‚¨èƒ½å¤Ÿåœ¨å‘é€è¯·æ±‚ä¹‹å‰ä¿®æ”¹è¯·æ±‚ã€‚åœ¨è¿™ä¹‹åï¼ŒKyä¸ä¼šå¯¹è¯·æ±‚åšè¿›ä¸€æ­¥çš„æ›´æ”¹ã€‚é’©å­å‡½æ•°æ¥æ”¶è¯·æ±‚å’Œé€‰é¡¹ä½œä¸ºå‚æ•°ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹è¯·æ±‚ã€‚è¿™é‡Œæ˜¯æ ‡é¢˜ã€‚</p><p> The hook can return a   Request to replace the outgoing request, or return a   Response to completely avoid making an HTTP request. This can be used to mock a request, check an internal cache, etc. An  important consideration when returning a request or response from this hook is that any remaining  beforeRequest hooks will be skipped, so you may want to only return them from the last hook.</p><p>é’©å­å¯ä»¥è¿”å›ä¸€ä¸ªè¯·æ±‚æ¥æ›¿æ¢ä¼ å‡ºçš„è¯·æ±‚ï¼Œæˆ–è€…è¿”å›ä¸€ä¸ªå“åº”æ¥å®Œå…¨é¿å…å‘å‡ºHTTPè¯·æ±‚ã€‚è¿™å¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿè¯·æ±‚ã€æ£€æŸ¥å†…éƒ¨ç¼“å­˜ç­‰ã€‚ä»è¿™ä¸ªé’©å­è¿”å›è¯·æ±‚æˆ–å“åº”æ—¶ï¼Œä¸€ä¸ªé‡è¦çš„è€ƒè™‘å› ç´ æ˜¯ï¼Œå°†è·³è¿‡æ‰€æœ‰å‰©ä½™çš„beforeRequesté’©å­ï¼Œå› æ­¤æ‚¨å¯èƒ½åªå¸Œæœ›ä»æœ€åä¸€ä¸ªé’©å­è¿”å›å®ƒä»¬ã€‚</p><p> import  ky  from  &#39;ky&#39; ; const  api  =  ky . extend ( {	 hooks:  {		 beforeRequest:  [			 request  =&gt;  {				 request . headers . set ( &#39;X-Requested-With&#39; ,  &#39;ky&#39; ) ;			 }		 ]	 } } ) ; const  response  =  await  api . get ( &#39;https://example.com/api/users&#39; ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›å¸¸æ•°api=kyã€‚æ‰©å±•ï¼ˆ{hooks:{beforeRequest:[request=&gtï¼›{request.headers.setï¼ˆ&#39ï¼›X-request-With&#39ï¼›ï¼Œ&#39ï¼›ky&#39ï¼›ï¼‰ï¼›			 }		 ]	 } } ) ; const response=ç­‰å¾…apiã€‚è·å¾—ï¼ˆ&#39ï¼›https://example.com/api/users&#39; ) ;</p><p>   This hook enables you to modify the request right before retry. Ky will make no further changes to the request after this. The hook function receives an object with the normalized request and options, an error instance, and the retry count. You could, for example, modify  request.headers here.</p><p>è¿™ä¸ªé’©å­å…è®¸æ‚¨åœ¨é‡è¯•ä¹‹å‰ä¿®æ”¹è¯·æ±‚ã€‚åœ¨è¿™ä¹‹åï¼ŒKyä¸ä¼šå¯¹è¯·æ±‚åšè¿›ä¸€æ­¥çš„æ›´æ”¹ã€‚é’©å­å‡½æ•°æ¥æ”¶ä¸€ä¸ªå¸¦æœ‰è§„èŒƒåŒ–è¯·æ±‚å’Œé€‰é¡¹çš„å¯¹è±¡ã€ä¸€ä¸ªé”™è¯¯å®ä¾‹å’Œé‡è¯•è®¡æ•°ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹è¯·æ±‚ã€‚è¿™é‡Œæ˜¯æ ‡é¢˜ã€‚</p><p> If the request received a response, the error will be of type  HTTPError and the  Response object will be available at  error.response. Be aware that some types of errors, such as network errors, inherently mean that a response was not received. In that case, the error will not be an instance of  HTTPError.</p><p>å¦‚æœè¯·æ±‚æ”¶åˆ°å“åº”ï¼Œåˆ™é”™è¯¯ç±»å‹ä¸ºHTTPErrorï¼Œå¹¶ä¸”å“åº”å¯¹è±¡åœ¨å‡ºç°é”™è¯¯æ—¶å¯ç”¨ã€‚å›ç­”è¯·æ³¨æ„ï¼ŒæŸäº›ç±»å‹çš„é”™è¯¯ï¼ˆå¦‚ç½‘ç»œé”™è¯¯ï¼‰æœ¬è´¨ä¸Šæ„å‘³ç€æœªæ”¶åˆ°å“åº”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé”™è¯¯å°†ä¸æ˜¯HTTPErrorçš„å®ä¾‹ã€‚</p><p> You can prevent Ky from retrying the request by throwing an error. Ky will not handle it in any way and the error will be propagated to the request initiator. The rest of the  beforeRetry hooks will not be called in this case. Alternatively, you can return the   ky.stop symbol to do the same thing but without propagating an error (this has some limitations, see  ky.stop docs for details).</p><p>æ‚¨å¯ä»¥é€šè¿‡æŠ›å‡ºé”™è¯¯æ¥é˜²æ­¢Kyé‡è¯•è¯·æ±‚ã€‚Kyä¸ä¼šä»¥ä»»ä½•æ–¹å¼å¤„ç†å®ƒï¼Œé”™è¯¯å°†ä¼ æ’­åˆ°è¯·æ±‚å‘èµ·æ–¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ä¼šè°ƒç”¨beforeRetryé’©å­çš„å…¶ä½™éƒ¨åˆ†ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥è¿”å›ky.stopç¬¦å·æ¥æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œä½†ä¸ä¼šä¼ æ’­é”™è¯¯ï¼ˆè¿™æœ‰ä¸€äº›é™åˆ¶ï¼Œè¯·å‚é˜…ky.stop docsäº†è§£è¯¦ç»†ä¿¡æ¯ï¼‰ã€‚</p><p> import  ky  from  &#39;ky&#39; ; const  response  =  await  ky ( &#39;https://example.com&#39; ,  {	 hooks:  {		 beforeRetry:  [			 async  ( {request , options , error , retryCount } )  =&gt;  {				 const  token  =  await  ky ( &#39;https://example.com/refresh-token&#39; ) ;				 request . headers . set ( &#39;Authorization&#39; ,  `token   ${ token }` ) ;			 }		 ]	 } } ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›const response=wait kyï¼ˆ&#39ï¼›https://example.com&#39; ,  {hooks:{beforetry:[asyncï¼ˆ{requestï¼Œoptionsï¼Œerrorï¼ŒretryCount}ï¼‰=&gtï¼›{const token=wait kyï¼ˆ&#39ï¼›https://example.com/refresh-token&#39; ) ;è¦æ±‚æ ‡é¢˜ã€‚setï¼ˆ&#39ï¼›Authorization&#39ï¼›ï¼Œ`token${token}`ï¼‰ï¼›			 }		 ]	 } } ) ;</p><p>   This hook enables you to modify the  HTTPError right before it is thrown. The hook function receives a  HTTPError as an argument and should return an instance of  HTTPError.</p><p>è¿™ä¸ªé’©å­å…è®¸æ‚¨åœ¨æŠ›å‡ºHTTPErrorä¹‹å‰ä¿®æ”¹å®ƒã€‚é’©å­å‡½æ•°æ¥æ”¶HTTPErrorä½œä¸ºå‚æ•°ï¼Œå¹¶åº”è¿”å›HTTPErrorçš„å®ä¾‹ã€‚</p><p> import  ky  from  &#39;ky&#39; ; await  ky ( &#39;https://example.com&#39; ,  {	 hooks:  {		 beforeError:  [			 error  =&gt;  {				 const  {response }  =  error ;				 if  ( response  &amp;&amp;  response . body )  {					 error . name  =  &#39;GitHubError&#39; ;					 error . message  =  `  ${ response . body . message } (  ${ response . statusCode })` ;				 }				 return  error ;			 }		 ]	 } } ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›ç­‰å¾…kyï¼ˆ&#39ï¼›https://example.com&#39; ,  {hooks:{beforeError:[error=&gtï¼›{const{response}=errorï¼›ifï¼ˆresponse&ampï¼›response.bodyï¼‰{error.name=&#39ï¼›GitHubError&#39ï¼›error.message=`response.body.message}ï¼ˆ${response.statusCode}ï¼‰`return errorï¼›}ï¼‰ï¼›</p><p>   This hook enables you to read and optionally modify the response. The hook function receives normalized request, options, and a clone of the response as arguments. The return value of the hook function will be used by Ky as the response object if it&#39;s an instance of   Response.</p><p>è¿™ä¸ªé’©å­ä½¿æ‚¨èƒ½å¤Ÿè¯»å–å¹¶æœ‰é€‰æ‹©åœ°ä¿®æ”¹å“åº”ã€‚é’©å­å‡½æ•°æ¥æ”¶è§„èŒƒåŒ–çš„è¯·æ±‚ã€é€‰é¡¹å’Œå“åº”çš„å…‹éš†ä½œä¸ºå‚æ•°ã€‚Kyå°†ä½¿ç”¨é’©å­å‡½æ•°çš„è¿”å›å€¼ä½œä¸ºå“åº”å¯¹è±¡ï¼Œå¦‚æœå®ƒ&#39ï¼›è¿™æ˜¯ä¸€ä¸ªå›åº”çš„ä¾‹å­ã€‚</p><p> import  ky  from  &#39;ky&#39; ; const  response  =  await  ky ( &#39;https://example.com&#39; ,  {	 hooks:  {		 afterResponse:  [			 ( _request ,  _options ,  response )  =&gt;  {				 // You could do something with the response, for example, logging.				 log ( response ) ;				 // Or return a `Response` instance to overwrite the response.				 return  new  Response ( &#39;A different response&#39; ,  { status:  200 } ) ;			 } ,			 // Or retry with a fresh token on a 403 error			 async  ( request ,  options ,  response )  =&gt;  {				 if  ( response . status  ===  403 )  {					 // Get a fresh token					 const  token  =  await  ky ( &#39;https://example.com/token&#39; ) . text ( ) ;					 // Retry with the token					 request . headers . set ( &#39;Authorization&#39; ,  `token   ${ token }` ) ;					 return  ky ( request ) ;				 }			 }		 ]	 } } ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›const response=wait kyï¼ˆ&#39ï¼›https://example.com&#39; ,  {hooks:{afterResponse:[ï¼ˆ_-requestï¼Œ_-optionsï¼Œresponseï¼‰=&gtï¼›{//æ‚¨å¯ä»¥å¯¹å“åº”æ‰§è¡Œä¸€äº›æ“ä½œï¼Œä¾‹å¦‚logging.logï¼ˆresponseï¼‰ï¼›//æˆ–è€…è¿”å›ä¸€ä¸ª'response'å®ä¾‹æ¥è¦†ç›–å“åº”ã€‚è¿”å›æ–°çš„å“åº”ï¼ˆ&#39ï¼›å¦ä¸€ä¸ªå“åº”&#39ï¼›ï¼Œ{status:200}ï¼‰ ;}ã€//æˆ–åœ¨403é”™è¯¯å¼‚æ­¥ï¼ˆè¯·æ±‚ã€é€‰é¡¹ã€å“åº”ï¼‰=&gtï¼›{ifï¼ˆresponse.status==403ï¼‰{//Get a fresh token const token=wait kyï¼ˆ&#39ï¼›https://example.com/token&#39; ) . æ–‡æœ¬ï¼ˆï¼‰ï¼›//ä½¿ç”¨ä»¤ç‰Œè¯·æ±‚é‡è¯•ã€‚æ ‡é¢˜ã€‚setï¼ˆ&#39ï¼›Authorization&#39ï¼›ï¼Œ`token${token}`ï¼‰ï¼›è¿”å›kyï¼ˆè¯·æ±‚ï¼‰ï¼›				 }			 }		 ]	 } } ) ;</p><p>   Throw an  HTTPError when, after following redirects, the response has a non-2xx status code. To also throw for redirects instead of following them, set the   redirect option to  &#39;manual&#39;.</p><p>åœ¨æ‰§è¡Œé‡å®šå‘åï¼Œå¦‚æœå“åº”å…·æœ‰é2xxçŠ¶æ€ä»£ç ï¼Œåˆ™æŠ›å‡ºHTTPErrorã€‚è¦åŒæ—¶æŠ›å‡ºé‡å®šå‘è€Œä¸æ˜¯è·Ÿéšé‡å®šå‘ï¼Œè¯·å°†é‡å®šå‘é€‰é¡¹è®¾ç½®ä¸º&#39ï¼›æ‰‹å†Œ&#39ï¼›ã€‚</p><p> Setting this to  false may be useful if you are checking for resource availability and are expecting error responses.</p><p>å¦‚æœæ‚¨æ­£åœ¨æ£€æŸ¥èµ„æºå¯ç”¨æ€§ï¼Œå¹¶ä¸”å¸Œæœ›å¾—åˆ°é”™è¯¯å“åº”ï¼Œé‚£ä¹ˆå°†æ­¤è®¾ç½®ä¸ºfalseå¯èƒ½ä¼šå¾ˆæœ‰ç”¨ã€‚</p><p> Note: If  false, error responses are considered successful and the request will not be retried.</p><p>æ³¨æ„ï¼šå¦‚æœä¸ºfalseï¼Œåˆ™é”™è¯¯å“åº”è¢«è§†ä¸ºæˆåŠŸï¼Œè¯·æ±‚å°†ä¸ä¼šé‡è¯•ã€‚</p><p>     The  progress object contains the following elements:  percent,  transferredBytes and  totalBytes. If it&#39;s not possible to retrieve the body size,  totalBytes will be  0.</p><p>progresså¯¹è±¡åŒ…å«ä»¥ä¸‹å…ƒç´ ï¼špercentã€transferredByteså’ŒtotalBytesã€‚å¦‚æœæ˜¯&#39ï¼›å¦‚æœæ— æ³•æ£€ç´¢æ­£æ–‡å¤§å°ï¼Œåˆ™totalByteså°†ä¸º0ã€‚</p><p> import  ky  from  &#39;ky&#39; ; const  response  =  await  ky ( &#39;https://example.com&#39; ,  {	 onDownloadProgress:  ( progress ,  chunk )  =&gt;  {		 // Example output:		 // `0% - 0 of 1271 bytes`		 // `100% - 1271 of 1271 bytes`		 console . log ( `  ${ progress . percent  *  100 }% -   ${ progress . transferredBytes } of   ${ progress . totalBytes } bytes` ) ;	 } } ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›const response=wait kyï¼ˆ&#39ï¼›https://example.com&#39; ,  {onDownloadProgress:ï¼ˆprogressï¼Œchunkï¼‰=&gtï¼›{//ç¤ºä¾‹è¾“å‡ºï¼š//`0%-0/1271å­—èŠ‚`/`100%-1271å­—èŠ‚`æ§åˆ¶å°.logï¼ˆ${progress.percent*100}%-${progress.transferredBytes}çš„${progress.totalBytes}å­—èŠ‚`ï¼‰ï¼›	 } } ) ;</p><p>      import  ky  from  &#39;ky&#39; ; import  bourne  from  &#39;@hapijs/bourne&#39; ; const  json  =  await  ky ( &#39;https://example.com&#39; ,  {	 parseJson:  text  =&gt;  bourne ( text ) } ) . json ( ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›ä»&#39è¿›å£ä¼¯æ©@å“ˆçš®å…‹æ–¯/ä¼¯æ©&#39ï¼›const json=wait kyï¼ˆ&#39ï¼›https://example.com&#39; ,  {parseJson:text=&gtï¼›ä¼¯æ©ï¼ˆtextï¼‰}ï¼‰ã€‚jsonï¼ˆï¼‰ï¼›</p><p>           You can remove a header with  .extend() by passing the header with an  undefined value.Passing  undefined as a string removes the header only if it comes from a  Headers instance.</p><p>å¯ä»¥ä½¿ç”¨åˆ é™¤æ ‡é¢˜ã€‚extendï¼ˆï¼‰é€šè¿‡ä¼ é€’å¸¦æœ‰æœªå®šä¹‰å€¼çš„æ ‡å¤´ã€‚ä»…å½“å¤´æ¥è‡ªHeaderså®ä¾‹æ—¶ï¼Œä»¥å­—ç¬¦ä¸²å½¢å¼ä¼ é€’undefinedä¼šç§»é™¤å¤´ã€‚</p><p> import  ky  from  &#39;ky&#39; ; const  url  =  &#39;https://sindresorhus.com&#39; ; const  original  =  ky . create ( {	 headers:  {		 rainbow:  &#39;rainbow&#39; ,		 unicorn:  &#39;unicorn&#39;	 } } ) ; const  extended  =  original . extend ( {	 headers:  {		 rainbow:  undefined	 } } ) ; const  response  =  await  extended ( url ) . json ( ) ; console . log ( &#39;rainbow&#39;  in  response ) ; //=&gt; false console . log ( &#39;unicorn&#39;  in  response ) ; //=&gt; true</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›const url=&#39ï¼›https://sindresorhus.com&#39; ; const original=kyã€‚åˆ›å»ºï¼ˆ{headers:{rainbow:&#39ï¼›rainbow&#39ï¼›ï¼Œunicorn:&#39ï¼›unicorn&#39ï¼›}ï¼‰ï¼›å¸¸é‡æ‰©å±•=åŸå§‹ã€‚æ‰©å±•ï¼ˆ{headers:{rainbow:undefined}}ï¼‰ï¼›const response=await extendedï¼ˆurlï¼‰ã€‚jsonï¼ˆï¼‰ï¼›å®‰æ…°æ—¥å¿—ï¼ˆ&#39ï¼›å½©è™¹&#39ï¼›å›åº”ï¼‰//=&gtï¼›å‡æ§åˆ¶å°ã€‚æ—¥å¿—ï¼ˆ&#39ï¼›ç‹¬è§’å…½&#39ï¼›å›åº”ï¼‰//=&gtï¼›ç¬¦åˆäº‹å®çš„</p><p>   import  ky  from  &#39;ky&#39; ; // On https://my-site.com const  api  =  ky . create ( { prefixUrl:  &#39;https://example.com/api&#39; } ) ; const  response  =  await  api . get ( &#39;users/123&#39; ) ; //=&gt; &#39;https://example.com/api/users/123&#39; const  response  =  await  api . get ( &#39;/status&#39; ,  { prefixUrl:  &#39;&#39; } ) ; //=&gt; &#39;https://my-site.com/status&#39;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·&#39ï¼›ï¼›//åœ¨â€¦ä¸Šhttps://my-site.comå¸¸æ•°api=kyã€‚åˆ›å»ºï¼ˆ{prefixUrl:&#39ï¼›https://example.com/api&#39; } ) ; const response=ç­‰å¾…apiã€‚è·å–ï¼ˆ&#39ï¼›ç”¨æˆ·/123&#39ï¼›ï¼‰//=&gt&#39;https://example.com/api/users/123&#39; const response=ç­‰å¾…apiã€‚getï¼ˆ&#39ï¼›/status&#39ï¼›ï¼Œ{prefixUrl:&#39ï¼›&#39ï¼›}ï¼‰//=&gt&#39;https://my-site.com/status&#39;</p><p>    A  Symbol that can be returned by a  beforeRetry hook to stop the retry. This will also short circuit the remaining  beforeRetry hooks.</p><p>å¯ç”±beforeRetryæŒ‚é’©è¿”å›ä»¥åœæ­¢é‡è¯•çš„ç¬¦å·ã€‚è¿™ä¹Ÿä¼šåœ¨é‡è¯•å‰ä½¿å‰©ä½™çš„æŒ‚é’©çŸ­è·¯ã€‚</p><p> Note: Returning this symbol makes Ky abort and return with an  undefined response. Be sure to check for a response before accessing any properties on it or use  optional chaining. It is also incompatible with body methods, such as  .json() or  .text(), because there is no response to parse. In general, we recommend throwing an error instead of returning this symbol, as that will cause Ky to abort and then throw, which avoids these limitations.</p><p>æ³¨æ„ï¼šè¿”å›æ­¤ç¬¦å·å°†å¯¼è‡´Kyä¸­æ­¢ï¼Œå¹¶è¿”å›æœªå®šä¹‰çš„å“åº”ã€‚åœ¨è®¿é—®å“åº”ä¸Šçš„ä»»ä½•å±æ€§æˆ–ä½¿ç”¨å¯é€‰é“¾æ¥ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ£€æŸ¥å“åº”ã€‚å®ƒä¹Ÿä¸èº«ä½“æ–¹æ³•ä¸å…¼å®¹ï¼Œä¾‹å¦‚ã€‚jsonï¼ˆï¼‰æˆ–ã€‚textï¼ˆï¼‰ï¼Œå› ä¸ºæ²¡æœ‰è§£æå“åº”ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å»ºè®®æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè€Œä¸æ˜¯è¿”å›è¿™ä¸ªç¬¦å·ï¼Œå› ä¸ºè¿™å°†å¯¼è‡´Kyä¸­æ­¢ï¼Œç„¶åæŠ›å‡ºï¼Œä»è€Œé¿å…è¿™äº›é™åˆ¶ã€‚</p><p> A valid use-case for  ky.stop is to prevent retries when making requests for side effects, where the returned data is not important. For example, logging client activity to the server.</p><p>ky.stopçš„ä¸€ä¸ªæœ‰æ•ˆç”¨ä¾‹æ˜¯é˜²æ­¢åœ¨è¯·æ±‚å‰¯ä½œç”¨æ—¶é‡è¯•ï¼Œå› ä¸ºè¿”å›çš„æ•°æ®å¹¶ä¸é‡è¦ã€‚ä¾‹å¦‚ï¼Œå°†å®¢æˆ·ç«¯æ´»åŠ¨è®°å½•åˆ°æœåŠ¡å™¨ã€‚</p><p> import  ky  from  &#39;ky&#39; ; const  options  =  {	 hooks:  {		 beforeRetry:  [			 async  ( {request , options , error , retryCount } )  =&gt;  {				 const  shouldStopRetry  =  await  ky ( &#39;https://example.com/api&#39; ) ;				 if  ( shouldStopRetry )  {					 return  ky . stop ;				 }			 }		 ]	 } } ; // Note that response will be `undefined` in case `ky.stop` is returned. const  response  =  await  ky . post ( &#39;https://example.com&#39; ,  options ) ; // Using `.text()` or other body methods is not supported. const  text  =  await  ky ( &#39;https://example.com&#39; ,  options ) . text ( ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›const options={hooks:{beforeRetry:[asyncï¼ˆ{requestï¼Œoptionsï¼Œerrorï¼ŒretryCount}ï¼‰=&gtï¼›{const shouldStopRetry=wait kyï¼ˆ&#39ï¼›https://example.com/api&#39; ) ;ifï¼ˆshouldStopRetryï¼‰{return ky.stopï¼›}}}]}ï¼›//è¯·æ³¨æ„ï¼Œå¦‚æœè¿”å›'ky.stop'ï¼Œå“åº”å°†ä¸º'undefined'ã€‚const response=wait kyã€‚å¸–å­ï¼ˆ&#39ï¼›https://example.com&#39; ,  é€‰é¡¹ï¼‰ï¼›//ä½¿ç”¨`ã€‚textï¼ˆï¼‰`æˆ–å…¶ä»–æ­£æ–‡æ–¹æ³•ä¸å—æ”¯æŒã€‚const text=wait kyï¼ˆ&#39ï¼›https://example.com&#39; ,  é€‰é¡¹ï¼‰ã€‚æ–‡æœ¬ï¼ˆï¼‰ï¼›</p><p>  Exposed for  instanceof checks. The error has a  response property with the   Response object,  request property with the   Request object, and  options property with normalized options (either passed to  ky when creating an instance with  ky.create() or directly when performing the request).</p><p>æš´éœ²åœ¨æ£€æŸ¥çš„ç¬é—´ã€‚è¯¥é”™è¯¯å…·æœ‰å“åº”å¯¹è±¡çš„responseå±æ€§ã€è¯·æ±‚å¯¹è±¡çš„requestå±æ€§å’Œè§„èŒƒåŒ–é€‰é¡¹çš„optionså±æ€§ï¼ˆåœ¨ä½¿ç”¨ky.createï¼ˆï¼‰åˆ›å»ºå®ä¾‹æ—¶ä¼ é€’ç»™kyï¼Œæˆ–è€…åœ¨æ‰§è¡Œè¯·æ±‚æ—¶ç›´æ¥ä¼ é€’ç»™kyï¼‰ã€‚</p><p>  The error thrown when the request times out. It has a  request property with the   Request object.</p><p>è¯·æ±‚è¶…æ—¶æ—¶å¼•å‘çš„é”™è¯¯ã€‚å®ƒå…·æœ‰è¯·æ±‚å¯¹è±¡çš„è¯·æ±‚å±æ€§ã€‚</p><p>   Sending form data in Ky is identical to  fetch. Just pass a   FormData instance to the  body option. The  Content-Type header will be automatically set to  multipart/form-data.</p><p>ä»¥Kyæ ¼å¼å‘é€è¡¨å•æ•°æ®ä¸è·å–ç›¸åŒã€‚åªéœ€å°†FormDataå®ä¾‹ä¼ é€’ç»™bodyé€‰é¡¹ã€‚å†…å®¹ç±»å‹æ ‡é¢˜å°†è‡ªåŠ¨è®¾ç½®ä¸ºå¤šéƒ¨åˆ†/è¡¨å•æ•°æ®ã€‚</p><p> import  ky  from  &#39;ky&#39; ; // `multipart/form-data` const  formData  =  new  FormData ( ) ; formData . append ( &#39;food&#39; ,  &#39;fries&#39; ) ; formData . append ( &#39;drink&#39; ,  &#39;icetea&#39; ) ; const  response  =  await  ky . post ( url ,  { body:  formData } ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·&#39ï¼›ï¼›//`å¤šéƒ¨åˆ†/è¡¨å•æ•°æ®`const formData=new formDataï¼ˆï¼‰ï¼›formDataã€‚é™„åŠ ï¼ˆ&#39ï¼›é£Ÿç‰©&#39ï¼›ï¼Œ&#39ï¼›è–¯æ¡&#39ï¼›ï¼‰ï¼›formDataã€‚è¿½åŠ ï¼ˆ&#39ï¼›é¥®æ–™&#39ï¼›ï¼Œ&#39ï¼›å†°èŒ¶&#39ï¼›ï¼‰ï¼›const response=wait kyã€‚postï¼ˆurlï¼Œ{body:formData}ï¼‰ï¼›</p><p> If you want to send the data in  application/x-www-form-urlencoded format, you will need to encode the data with   URLSearchParams.</p><p>å¦‚æœè¦ä»¥application/x-www-form-urlencodedæ ¼å¼å‘é€æ•°æ®ï¼Œåˆ™éœ€è¦ä½¿ç”¨urlsearchparmså¯¹æ•°æ®è¿›è¡Œç¼–ç ã€‚</p><p> import  ky  from  &#39;ky&#39; ; // `application/x-www-form-urlencoded` const  searchParams  =  new  URLSearchParams ( ) ; searchParams . set ( &#39;food&#39; ,  &#39;fries&#39; ) ; searchParams . set ( &#39;drink&#39; ,  &#39;icetea&#39; ) ; const  response  =  await  ky . post ( url ,  { body:  searchParams } ) ;</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·&#39ï¼›ï¼›//`application/x-www-form-urlencoded`const searchParams=new URLSearchParamsï¼ˆï¼‰ï¼›æœç´¢å‚æ•°ã€‚å¥—é¤ï¼ˆ&#39ï¼›é£Ÿç‰©&#39ï¼›&#39ï¼›è–¯æ¡&#39ï¼›ï¼‰ï¼›æœç´¢å‚æ•°ã€‚å¥—é¤ï¼ˆ&#39ï¼›é¥®æ–™&#39ï¼›&#39ï¼›å†°èŒ¶&#39ï¼›ï¼‰ï¼›const response=wait kyã€‚postï¼ˆurlï¼Œ{body:searchParams}ï¼‰ï¼›</p><p>  Fetch (and hence Ky) has built-in support for request cancellation through the   AbortController API.  Read more.</p><p>Fetchï¼ˆå› æ­¤ä¹Ÿæ˜¯Kyï¼‰é€šè¿‡AbortController APIå†…ç½®äº†å¯¹è¯·æ±‚å–æ¶ˆçš„æ”¯æŒã€‚é˜…è¯»æ›´å¤šã€‚</p><p>  import  ky  from  &#39;ky&#39; ; const  controller  =  new  AbortController ( ) ; const  {signal }  =  controller ; setTimeout ( ( )  =&gt;  {	 controller . abort ( ) ; } ,  5000 ) ; try  {	 console . log ( await  ky ( url ,  {signal } ) . text ( ) ) ; }  catch  ( error )  {	 if  ( error . name  ===  &#39;AbortError&#39; )  {		 console . log ( &#39;Fetch aborted&#39; ) ;	 }  else  {		 console . error ( &#39;Fetch error:&#39; ,  error ) ;	 } }</p><p>ä»&#39è¿›å£kyï¼›è‚¯å¡”åŸºå·ï¼›const controller=new AbortControllerï¼ˆï¼‰ï¼›const{signal}=æ§åˆ¶å™¨ï¼›è®¾ç½®è¶…æ—¶ï¼ˆï¼ˆï¼‰=&gtï¼›{controller.abortï¼ˆï¼‰ï¼›}ï¼Œ5000 ) ; å°è¯•{console.logï¼ˆç­‰å¾…kyï¼ˆurlï¼Œ{signal}ï¼‰ã€‚textï¼ˆï¼‰ï¼›}catchï¼ˆerrorï¼‰{ifï¼ˆerror.name==&#39ï¼›abortror&#39ï¼›ï¼‰{console.logï¼ˆ&#39ï¼›Fetch aborted&#39ï¼›ï¼‰ï¼›}else{console.errorï¼ˆ&#39ï¼›Fetch error:&#39ï¼›errorï¼‰ï¼›}</p><p>    How do I use this with a web app (React, Vue.js, etc.) that uses server-side rendering (SSR)?</p><p>å¦‚ä½•å°†å…¶ç”¨äºä½¿ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰çš„webåº”ç”¨ç¨‹åºï¼ˆReactã€Vue.jsç­‰ï¼‰ï¼Ÿ</p><p>   Either use a test runner that can run in the browser, like Mocha, or use  AVA with  ky-universal.  Read more.</p><p>è¦ä¹ˆä½¿ç”¨å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„æµ‹è¯•è¿è¡Œç¨‹åºï¼Œæ¯”å¦‚Mochaï¼Œè¦ä¹ˆä½¿ç”¨AVAå’Œky universalã€‚é˜…è¯»æ›´å¤šã€‚</p><p>  Make sure your code is running as a JavaScript module (ESM), for example by using a  &lt;script type=&#34;module&#34;&gt; tag in your HTML document. Then Ky can be imported directly by that module without a bundler or other tools.</p><p>ç¡®ä¿ä»£ç ä½œä¸ºJavaScriptæ¨¡å—ï¼ˆESMï¼‰è¿è¡Œï¼Œä¾‹å¦‚ä½¿ç”¨&ltï¼›è„šæœ¬ç±»å‹=&#34ï¼›æ¨¡å—34&gtï¼›åœ¨HTMLæ–‡æ¡£ä¸­æ·»åŠ æ ‡ç­¾ã€‚ç„¶åï¼Œè¯¥æ¨¡å—å¯ä»¥ç›´æ¥å¯¼å…¥Kyï¼Œè€Œæ— éœ€ç»‘å®šå™¨æˆ–å…¶ä»–å·¥å…·ã€‚</p><p>         It&#39;s just a random short npm package name I managed to get. It does, however, have a meaning in Japanese:</p><p>å®ƒ&#39ï¼›è¿™åªæ˜¯æˆ‘è®¾æ³•å¾—åˆ°çš„ä¸€ä¸ªéšæœºç®€çŸ­çš„npmåŒ…åã€‚ç„¶è€Œï¼Œå®ƒåœ¨æ—¥è¯­ä¸­æœ‰ä¸€ä¸ªå«ä¹‰ï¼š</p><p> A form of text-able slang, KY is an abbreviation for ç©ºæ°—èª­ã‚ãªã„ (kuuki yomenai), which literally translates into â€œcannot read the air.â€ It&#39;s a phrase applied to someone who misses the implied meaning.</p><p>KYæ˜¯ä¸€ç§å¯ç”¨äºæ–‡æœ¬çš„ä¿šè¯­ï¼Œæ˜¯ç©ºæ°—èª­ã‚ãªã„ ï¼ˆkuuki yomenaiï¼‰ï¼Œå­—é¢æ„æ€æ˜¯â€œçœ‹ä¸è§ç©ºæ°”â€å®ƒ&#39ï¼›è¿™æ˜¯ä¸€ä¸ªçŸ­è¯­ï¼Œç”¨æ¥å½¢å®¹æ²¡æœ‰é¢†ä¼šå…¶ä¸­éšå«çš„æ„æ€çš„äººã€‚</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/è·å–/">#è·å–</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tiny/">#tiny</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/è¯·æ±‚/">#è¯·æ±‚</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è°·æ­Œ/">#è°·æ­Œ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>