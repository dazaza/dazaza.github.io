<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用JavaScript和Twilio在9分钟内构建和部署视频应用</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用JavaScript和Twilio在9分钟内构建和部署视频应用</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-29 19:59:03</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/5/378170328701625b3cb383faba4b4f59.png"><img src="http://img.diglog.com/img/2020/5/378170328701625b3cb383faba4b4f59.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>由于我们中的许多人现在都在远程工作，视频聊天现在非常流行。以下是如何使用Twilio可编程视频工具和JavaScript格式的Twilio无服务器工具包，在9分钟内启动并运行视频聊天室。</p><p>将API密钥保存在某个位置以便很快使用它们，然后通过运行以下命令通过Twilio CLI安装Twilio无服务器工具包(如果您尚未安装。</p><p>将{insert-project-name}替换为您的项目名称--我调用了我的tfvideo。该命令完成后，将在当前目录下创建一个具有项目名称的目录。</p><p>项目目录中包含一些现成的文件夹。在函数中，添加一个名为video-token.js的文件，在资源中添加两个文件：Video.html和index.js。在.env中设置环境变量。您可以不使用包含ACCOUNT_SID和AUTH_TOKEN的前两行。在它们下面，添加您的帐户SID、API密钥和API密钥：</p><p>在函数/video-token.js中，添加以下代码以生成访问令牌。在这里，我们设置环境变量、固定的房间名称和ACCESS_TOKEN_IDENTITY，这对于每个用户都是不同的。所有用户都将被授予对房间TF的访问权限。此代码是从此页面修改的，该页面还包含有关访问令牌的更多信息。</p><p>出口。处理程序=Function(Context，Event，Callback){const Twilio_Account_SID=Context。Twilio_Account_SID；Const Twilio_API_Key=上下文。Twilio_API_Key；Const Twilio_API_SECRET=上下文。Twilio_API_Secure；Const Access_Token_Identity=Math。随机()。toString(36)。子串(2，15)+数学。随机()。toString(36)。substring(2，15)；//随机客户端名称const room_name=&#39；tf&#39；；//固定房间名称const AccessToken=Twilio。JWT。AccessToken；const VideoGrant=AccessToken。VideoGrant；//参与房间只提供Token//创建一个Video Grant让客户端可以使用Video，只对这个房间const VideoGrant=new VideoGrant({room：room_name})；//创建一个访问令牌，将我们刚刚创建的权限const accessToken=new AccessToken(Twilio_Account_SID，Twilio_API_Key，Twilio_API_Secret)；accesToken签名并返回给客户端，我们刚刚创建的权限const accessToken=new AccessToken(Twilio_Account_SID，Twilio_API_Key，Twilio_API_Secret)；accessToken。addGrant(VideoGrant)；//将授权添加到Token accessToken中。IDENTITY=ACCESS_TOKEN_IDENTITY；callback(NULL，{Token：accessToken.。toJwt()//将令牌序列化为JWT字符串})；}；</p><p>现在打开您创建的空白资产/Video.html文件。我们将编写一些基本的HTML，包括进入和离开房间的按钮、将自动显示用户相机预览的视频标签、Axios和Twilio Video.js库以及我们即将通过脚本标签创建的资源/index.js文件：</p><p>&lt；！DOCTYPE html&gt；&lt；html&gt；&lt；head&gt；&lt；meta charset=&#34；utf-8&#34；&gt；&lt；meta http-equv=&#34；X-UA兼容&#34；&gt；&lt；meta name=&#34；viewport&#34；content=&#34；width=device-width，initial-scale=。/title&gt；&lt；/head&gt；&lt；body&gt；&lt；div id=&#34；房间控制&#34；&gt；&lt；video id=&#34；video&#34；autoplay muted=&#34；true&#34；width=&#34；320&#34；high=&#34；240&#34；&gt；&lt；/video&gt；&lt；按钮ID。&gt；加入房间&lt；/BUTTON&&gt;&lt；BUTTON id=&#34；BUTTON-LEVE&#34；/BUTTON&&gt;&lt；/BUTTON&&gt;&lt；/div&&gt;t；&lt；script src=&#34；//media.twiliocdn.com/sdk/js/video/releases/2.3.0/twilio-video.min.js&#34；&gt；&lt；/script&gt；&lt；script src=&#34；https://unpkg.com/axios@0.19.0/dist/axios.min.js&#34；&gt；&lt；/script&gt；&lt；script src=&#34；index.js&#34；&gt；&lt；/script&gt；&lt；/BODY&gt；&lt；/html&gt；</p><p>将无服务器域名(这将是基本URL)设置为您使用CLI模板对项目进行的任何命名。</p><p>当用户进入房间时，通过axios调用函数/video-token.js文件生成访问令牌。</p><p>通过附加事件侦听器来订阅或取消订阅远程参与者的曲目到TF会议室，从而显示远程参与者的视频。如果他们已经在房间中，我们迭代现有参与者并将事件侦听器附加到trackSubscribed。</p><p>最后，如果更改房间名称，还必须更改生成的令牌。</p><p>(()=&gt；{&#39；使用严格的；const Twilio_domain=location。主机；//用户独有，将是视频应用程序const room_name=&#39；tf&#39；；const Video=Twilio访问的网站。video；let VideoRoom，localStream；const video=document。getElementById(&#34；video&#34；)；//预览屏幕导航器。媒体设备。getUserMedia({VIDEO：TRUE，AUDIO：TRUE})。然后(VID=&gt；{视频。srcObject=vid；localStream=vid；})//按钮常量联合RoomButton=document。getElementById(&#34；button-Join&#34；)；const leaveRoomButton=document。getElementById(&#34；button-Leave&#34；)；var site=`https：//${Twilio_domain}/video-token`；console。log(`Site${site}`)；joinRoomButton。onClick=()=&gt；{//获取访问令牌axios。get(`https：//${Twilio_domain}/video-token`)。则(Async(Body)=&gt；{Const Token=Body。数据。令牌；控制台。log(Token)；//接入房间视频。connect(Token，{name：room_name})。那么((房间)=&gt；{控制台。日志(`已连接到房间${room。name}`)；VideoRoom=房间；房间。参与者。for Each(ParticipantConnected)；房间。在(&#34；ParticipantConnected&#34；，ParticipantConnected)；房间上。在(&#34；参与人断开连接&#34；，参与人断开连接)；房间上。一次(&#34；断开&#34；，(错误)=&gt；房间。参与者。forEach(ArticipantDisconnected))；joinRoomButton。Disabled=true；leaveRoomButton。Disabled=false；})；})；}；//离开房间leveRoomButton。onClick=()=&gt；{VideoRoom。断开连接()；控制台。log(`与房间${VideoRoom断开连接。name}`)；joinRoomButton。Disabled=false；leaveRoomButton。Disabled=true；}；})()；//连接参与者常量ParticipantConnected=(Participant)=&gt；{Console。日志(`Participant${Participant。标识}已连接&#39；`)；const div=文档。createElement(&#39；div&#39；)；//为新参与者div创建div。ID=参与者。SID；参与者。在(&#39；trackSubscribed&#39；，Track=&gt；trackSubscribed(div，Track))；参与者上。在(&#39；trackUnscribed&#39；，trackUnscribed)；参与者上。脚印。forEach(发布=&gt；{IF(发布。isSubscribed){trackSubscribed(div，Publication.。音轨)；}})；文档。身体。appendChild(Div)；}Const ParticipantDisconnected=(Participant)=&gt；{Console.。日志(`Participant${Participant。Identity}已断开连接。`)；文档。getElementById(参与者。SID)。Remove()；}const trackSubscribed=(div，Track)=&gt；{div.。appendChild(轨迹。Attach())；}const trackUnscribed=(跟踪)=&gt；{跟踪。分离()。forEach(元素=&gt；元素。Remove())；}。</p><p>在命令行上，运行Twilio Serverless：Deploy。CLI将祝贺您成功部署了无服务器项目以及其他一些部署细节。抓取Assets下的Assets/Video.html URL，与您的朋友分享，然后Tada！当您需要快速视频通话时，您可以使用和共享您自己的视频室。</p><p>这个应用程序非常简单，但考虑到没有CSS编写，它绝对不错，对吧？完整的代码可以在GitHub上找到。</p><p>Twilio的无服务器工具包可以方便地托管应用程序，并使其快速启动和运行。接下来，你可以编写更多的CSS来美化应用程序，添加可编程的聊天功能，或者更多的Twilio视频功能，获得用户的名字并在他们聊天时显示他们，等等。请在网上或评论中让我知道您正在构建什么。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.twilio.com/blog/build-a-video-app-javascript-twilio-cli-quickly">https://www.twilio.com/blog/build-a-video-app-javascript-twilio-cli-quickly</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/java/">#java</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/deploy/">#deploy</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/房间/">#房间</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1004152.html"><img src="http://img.diglog.com/img/2020/5/thumb_8fb6ba72ad8d059c8f97495f22f8a707.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1004152.html">选择2FA验证器应用程序可能很困难。Ars做的，所以你不必</a></div><span class="my_story_list_date">2020-5-29 6:25</span></div><div class="col-sm"><div><a target="_blank" href="/story/1004151.html"><img src="http://img.diglog.com/img/2020/5/thumb_8f0051878553b355209e91336b6b392e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1004151.html">为什么你不应该养成强制退出iOS应用或重启iOS设备的习惯</a></div><span class="my_story_list_date">2020-5-29 6:11</span></div><div class="col-sm"><div><a target="_blank" href="/story/1004086.html"><img src="http://img.diglog.com/img/2020/5/thumb_08f5b71612225eaeb5a80c85268c908f.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1004086.html">神秘名单出现人们在哪里相遇，个人信息，数千万</a></div><span class="my_story_list_date">2020-5-28 22:56</span></div><div class="col-sm"><div><a target="_blank" href="/story/1004045.html"><img src="http://img.diglog.com/img/2020/5/thumb_b64cbbc11ed152f6750f8f443c417c5a.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1004045.html">我构建了另一个写作应用程序</a></div><span class="my_story_list_date">2020-5-28 15:25</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>