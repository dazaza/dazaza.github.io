<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>æˆ‘å¯¹Rubyç±»ä¸€æ— æ‰€çŸ¥What I didn't know about Ruby Classes</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">What I didn't know about Ruby Classes<br/>æˆ‘å¯¹Rubyç±»ä¸€æ— æ‰€çŸ¥</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-22 08:57:28</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/11c826cfa4b68a0727ed56dfc94a9e82.jpeg"><img src="http://img2.diglog.com/img/2020/11/11c826cfa4b68a0727ed56dfc94a9e82.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Iâ€™ve always had this feeling that while learning Ruby and Rails, there were tons of little notions that I didnâ€™t really understood. Iâ€™m used to write things in order to learn them so here is a series of short articles about what I didnâ€™t know.</p><p>æˆ‘ä¸€ç›´æœ‰è¿™æ ·çš„æ„Ÿè§‰ï¼Œåœ¨å­¦ä¹ Rubyå’ŒRailsæ—¶ï¼Œæœ‰å¾ˆå¤šæˆ‘ä¸å¤ªäº†è§£çš„å°æ¦‚å¿µã€‚æˆ‘ä¹ æƒ¯äºå†™ä¸œè¥¿ä»¥å­¦ä¹ å®ƒä»¬ï¼Œæ‰€ä»¥è¿™é‡Œæœ‰ä¸€äº›ç®€çŸ­çš„æ–‡ç« ï¼Œä»‹ç»äº†æˆ‘æ‰€ä¸äº†è§£çš„å†…å®¹ã€‚</p><p>  The class Class inherits directly from Module, and adds to it all the behavior related to instances. Long story short, Modules are used to add methods to one or several Classes of your app, and Classes are used to managed your objectsâ€™ properties.</p><p>  ç±»Classç›´æ¥ä»Moduleç»§æ‰¿ï¼Œå¹¶å‘å…¶æ·»åŠ ä¸å®ä¾‹ç›¸å…³çš„æ‰€æœ‰è¡Œä¸ºã€‚é•¿è¯çŸ­è¯´ï¼Œæ¨¡å—ç”¨äºå‘åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªæˆ–å‡ ä¸ªç±»æ·»åŠ æ–¹æ³•ï¼Œè€Œç±»åˆ™ç”¨äºç®¡ç†å¯¹è±¡çš„å±æ€§ã€‚</p><p>  Ps: This dia  gram is very very very minimalist and focus on Class, but Module and Object have a lot of other children.</p><p>  é™„è¨€ï¼šæ­¤å›¾éå¸¸éå¸¸ç®€å•ï¼Œä¸“æ³¨äºClassï¼Œä½†æ˜¯Moduleå’ŒObjectè¿˜æœ‰å¾ˆå¤šå…¶ä»–å­å…ƒç´ ã€‚</p><p>  In order to see the the ancestor of a Class, you can use the .superclass method :</p><p>  ä¸ºäº†æŸ¥çœ‹ç±»çš„ç¥–å…ˆï¼Œå¯ä»¥ä½¿ç”¨.superclassæ–¹æ³•ï¼š</p><p>  And if you want to see all the superclasses of a particular class, you can use the .ancestors method :</p><p>  å¦‚æœè¦æŸ¥çœ‹ç‰¹å®šç±»çš„æ‰€æœ‰è¶…ç±»ï¼Œå¯ä»¥ä½¿ç”¨.ancestorsæ–¹æ³•ï¼š</p><p>  Here, the array includes all the superclasses of Class and this is what we call the  ancestor chain in ruby.</p><p>åœ¨è¿™é‡Œï¼Œæ•°ç»„åŒ…æ‹¬Classçš„æ‰€æœ‰è¶…ç±»ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è°“çš„rubyä¸­çš„ç¥–å…ˆé“¾ã€‚</p><p>  In Ruby, when you define a new class, you are actually creating an instance of the class Class.</p><p>  åœ¨Rubyä¸­ï¼Œå½“æ‚¨å®šä¹‰æ–°ç±»æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨åˆ›å»ºClassç±»çš„å®ä¾‹ã€‚</p><p>  For example, here, we have just created a new class named Foo, which is an instance of the class Class and we can access to this instance by using the contant Foo. Following this logic, we can see that we could have created Foo like a casual object :</p><p>  ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆšåˆšåˆ›å»ºäº†ä¸€ä¸ªåä¸ºFooçš„æ–°ç±»ï¼Œå®ƒæ˜¯Classç±»çš„å®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç«äº‰çš„Fooæ¥è®¿é—®è¯¥å®ä¾‹ã€‚æŒ‰ç…§è¿™ç§é€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯ä»¥åƒå¶ç„¶å¯¹è±¡ä¸€æ ·åˆ›å»ºFooï¼š</p><p>   class MyExample   def say_hello  puts &#39;hello world&#39;  end end &gt;&gt; MyExample.ancestors =&gt; [MyExample, Object, Kernel, BasicObject] &gt;&gt; MyExample.new.say_hello =&gt; hello world &gt;&gt; MyExample.new.say_good_bye =&gt; NoMethodError</p><p>   class MyExample def say_helloå°†â€œ hello worldâ€æ”¾ç½®åœ¨æœ«å°¾>> MyExample.ancestors => [MyExampleï¼ŒObjectï¼ŒKernelï¼ŒBasicObject] >> MyExample.new.say_hello => hello world >> MyExample.new.say_good_bye => NoMethodError</p><p> say_hello : When we call the  say_hello method on an instance of the  MyExample class, Ruby looks through the  MyExample class for a method named  say_hello, it finds it and return the appropriate result.</p><p> say_helloï¼šå½“æˆ‘ä»¬åœ¨MyExampleç±»çš„å®ä¾‹ä¸Šè°ƒç”¨say_helloæ–¹æ³•æ—¶ï¼ŒRubyä¼šåœ¨MyExampleç±»ä¸­æŸ¥æ‰¾åä¸ºsay_helloçš„æ–¹æ³•ï¼Œå®ƒå°†æ‰¾åˆ°å¹¶è¿”å›é€‚å½“çš„ç»“æœã€‚</p><p> say_good_bye : If I call a  say_good_bye method, ruby will look into  MyExample for this method, it will not find it and then it will goes through the  ancestor chain passing through each parent at a time until  BasicObject to find a method called  say_good_bye.</p><p>say_good_byeï¼šå¦‚æœæˆ‘è°ƒç”¨say_good_byeæ–¹æ³•ï¼Œrubyå°†åœ¨MyExampleä¸­æŸ¥æ‰¾è¯¥æ–¹æ³•ï¼Œå®ƒå°†æ‰¾ä¸åˆ°å®ƒï¼Œç„¶åå®ƒå°†ä¸€æ¬¡éå†æ¯ä¸ªçˆ¶å¯¹è±¡çš„ç¥–å…ˆé“¾ï¼Œç›´åˆ°BasicObjectæ‰¾åˆ°ä¸€ä¸ªåä¸ºsay_good_byeçš„æ–¹æ³•ã€‚</p><p> Because the  say_good_bye method doesnâ€™t exist in the  MyExample class or any of the ancestors, Ruby will return a NoMethodError.</p><p> ç”±äºMyExampleç±»æˆ–ä»»ä½•ç¥–å…ˆéƒ½ä¸å­˜åœ¨say_good_byeæ–¹æ³•ï¼Œå› æ­¤Rubyå°†è¿”å›NoMethodErrorã€‚</p><p>  Adding a Moduleâ€™s code to a Class can be done using the include, extend and prepend methods. Letâ€™s focus on the two firsts as they are much more commons.</p><p>  å¯ä»¥ä½¿ç”¨includeï¼Œextendå’Œprependæ–¹æ³•å°†æ¨¡å—çš„ä»£ç æ·»åŠ åˆ°Classä¸­ã€‚è®©æˆ‘ä»¬å…³æ³¨ä¸¤ä¸ªç¬¬ä¸€ï¼Œå› ä¸ºå®ƒä»¬æ¯”è¾ƒå¸¸è§ã€‚</p><p>  As the doc says  When a class includes a module, moduleâ€™s instance methods become available as instance methods of the class.</p><p>  å°±åƒåŒ»ç”Ÿè¯´çš„é‚£æ ·ï¼Œå½“ä¸€ä¸ªç±»åŒ…å«ä¸€ä¸ªæ¨¡å—æ—¶ï¼Œæ¨¡å—çš„å®ä¾‹æ–¹æ³•å°±å¯ä»¥ç”¨ä½œè¯¥ç±»çš„å®ä¾‹æ–¹æ³•ã€‚</p><p> module RandomModule  def say_thank_you  puts &#39;thank you&#39;   end end class RandomClass    include RandomModule end &gt;&gt; RandomClass.new.say_thank_you =&gt; thank you &gt;&gt; RandomClass.ancestors =&gt; [RandomClass, RandomModule, Object, Kernel, BasicObject]</p><p> æ¨¡å—RandomModule def say_thank_youè¡¨ç¤ºâ€œè°¢è°¢â€ç»“æŸç«¯ç±»RandomClassåŒ…æ‹¬RandomModuleç»“æŸ>> RandomClass.new.say_thank_you =>è°¢è°¢>> RandomClass.ancestors => [RandomClassï¼ŒRandomModuleï¼ŒObjectï¼ŒKernelï¼ŒBasicObject]</p><p> Here you can also see that if we check the  ancestor chain of our  RandomClass, the  RandomModule appears !</p><p>åœ¨è¿™é‡Œï¼Œæ‚¨è¿˜å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæˆ‘ä»¬æ£€æŸ¥RandomClassçš„ç¥–å…ˆé“¾ï¼Œåˆ™ä¼šæ˜¾ç¤ºRandomModuleï¼</p><p> As we saw earlier, when we call the moduleâ€™s method ( say_thank_you), Ruby will check in our  RandomClass class for the method, it will not find it so Ruby will go through each of the ancestors of the  RandomClass class in order to find the method.</p><p> å¦‚æˆ‘ä»¬å…ˆå‰æ‰€è§ï¼Œå½“æˆ‘ä»¬è°ƒç”¨æ¨¡å—çš„æ–¹æ³•ï¼ˆsay_thank_youï¼‰æ—¶ï¼ŒRubyå°†åœ¨æˆ‘ä»¬çš„RandomClassç±»ä¸­æŸ¥æ‰¾è¯¥æ–¹æ³•ï¼Œä½†æ‰¾ä¸åˆ°å®ƒï¼Œå› æ­¤Rubyå°†éå†RandomClassç±»çš„æ¯ä¸ªç¥–å…ˆä»¥æ‰¾åˆ°è¯¥æ–¹æ³•ã€‚ ã€‚</p><p>  Iâ€™ve always found obscure the difference between  extend and  include, but they are actually very different : extend adds the moduleâ€™s method as class methods and not instance methods.</p><p>  æˆ‘ä¸€ç›´å‘ç°æ¨¡ç³Šå’Œæ‰©å±•å’ŒåŒ…å«ä¹‹é—´çš„åŒºåˆ«ï¼Œä½†æ˜¯å®ƒä»¬å®é™…ä¸Šæ˜¯éå¸¸ä¸åŒçš„ï¼šæ‰©å±•å°†æ¨¡å—çš„æ–¹æ³•æ·»åŠ ä¸ºç±»æ–¹æ³•ï¼Œè€Œä¸æ˜¯å®ä¾‹æ–¹æ³•ã€‚</p><p> module RandomModule  def say_thank_you  puts &#39;thank you&#39;   end end class RandomClass    extend RandomModule end &gt;&gt; RandomClass.new.say_thank_you =&gt;  NoMethodError &gt;&gt; RandomClass.say_thank_you =&gt; thank you &gt;&gt; RandomClass.ancestors =&gt; [RandomClass, Object, Kernel, BasicObject]</p><p> æ¨¡å—RandomModule def say_thank_youå°†'è°¢è°¢'ç»“æŸç«¯ç±»RandomClassæ‰©å±•RandomModuleç»“æŸ>> RandomClass.new.say_thank_you => NoMethodError >> RandomClass.say_thank_you =>è°¢è°¢>> RandomClass.ancestors => [RandomClassï¼ŒObjectï¼ŒKernelï¼ŒBasicObject ]</p><p> As you can see, the module is mixed with our  RandomClass, and itâ€™s methods are not accessible at the instance level (RandomClass.new.method) but at the class level (RandomClass.method).</p><p> å¦‚æ‚¨æ‰€è§ï¼Œè¯¥æ¨¡å—ä¸æˆ‘ä»¬çš„RandomClassæ··åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”å…¶æ–¹æ³•ä¸èƒ½åœ¨å®ä¾‹çº§åˆ«ï¼ˆRandomClass.new.methodï¼‰ä¸Šè®¿é—®ï¼Œè€Œå¯ä»¥åœ¨ç±»çº§åˆ«ï¼ˆRandomClass.methodï¼‰ä¸Šè®¿é—®ã€‚</p><p>  module RandomModule  def say_thank_you  puts &#39;thank you&#39;   end end class RandomClass end &gt;&gt; RandomClass.new.say_thank_you =&gt;  NoMethodError &gt;&gt; new_instance = RandomClass.new &gt;&gt; new_instance.extend RandomModule &gt;&gt; new_instance.say_thank_you =&gt; thank you</p><p>æ¨¡å—RandomModule def say_thank_youå°†'è°¢è°¢'ç»“æŸç»“æŸç±»RandomClassç»“æŸ>> RandomClass.new.say_thank_you => NoMethodError >> new_instance = RandomClass.new >> new_instance.extend RandomModule >> new_instance.say_thank_you =>è°¢è°¢</p><p>  It means that you can always add and edit methods of a particular ancestor class. You can do it for classes that you have created yourself or even from classes which are part of Ruby.</p><p>  è¿™æ„å‘³ç€æ‚¨å§‹ç»ˆå¯ä»¥æ·»åŠ å’Œç¼–è¾‘ç‰¹å®šç¥–å…ˆç±»çš„æ–¹æ³•ã€‚æ‚¨å¯ä»¥å¯¹è‡ªå·±åˆ›å»ºçš„ç±»ç”šè‡³æ˜¯Rubyçš„ç±»è¿›è¡Œæ­¤æ“ä½œã€‚</p><p> class String   def tell_my_size   self.size  end    def reverse  self.size  end end &gt;&gt; my_string = &#39;hello world&#39;  &gt;&gt; my_string.tell_my_size =&gt; 11 &gt;&gt; my_string.reverse =&gt; 11</p><p> ç±»å­—ç¬¦ä¸²def tell_my_size self.size end defåå‘self.size end end >> my_string ='hello world'>> my_string.tell_my_size => 11 >> my_string.reverse => 11</p><p> We have added a new method to the String class and we have changed the behavior of the reverse method.  Note that it is of course dangerous to override other Classes this way ! Be very careful by doing so and always prefer to edit the existing classes directly.</p><p> æˆ‘ä»¬åœ¨Stringç±»ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå¹¶ä¸”æ›´æ”¹äº†reverseæ–¹æ³•çš„è¡Œä¸ºã€‚æ³¨æ„ï¼Œç”¨è¿™ç§æ–¹æ³•è¦†ç›–å…¶ä»–ç±»å½“ç„¶æ˜¯å±é™©çš„ï¼è¿™æ ·åšè¦éå¸¸å°å¿ƒï¼Œå¹¶ä¸”æ€»æ˜¯å–œæ¬¢ç›´æ¥ç¼–è¾‘ç°æœ‰çš„ç±»ã€‚</p><p>  I know there are lots of other concepts around Classes but thatâ€™s all for this article, feel free to improve my explanation in the comments, I might add more concepts here in the future ğŸ‘€</p><p>  æˆ‘çŸ¥é“è¯¾ç¨‹å‘¨å›´è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ¦‚å¿µï¼Œä½†è¿™ä»…æ˜¯æœ¬æ–‡çš„å†…å®¹ï¼Œè¯·éšæ—¶åœ¨æ³¨é‡Šä¸­å®Œå–„æˆ‘çš„è§£é‡Šï¼Œä»¥åæˆ‘å¯èƒ½ä¼šåœ¨æ­¤å¤„æ·»åŠ æ›´å¤šæ¦‚å¿µğŸ‘€</p><p> ğŸ‘‰ Iâ€™am also the maker of  stanza.dev that helps developers to learn coding concepts faster. Feel free to have a look ğŸ‘¨â€ğŸ’» ğŸ‘©â€ğŸ’»</p><p>alsoæˆ‘è¿˜æ˜¯stanza.devçš„åˆ¶é€ å•†ï¼Œè¯¥å…¬å¸å¯å¸®åŠ©å¼€å‘äººå‘˜æ›´å¿«åœ°å­¦ä¹ ç¼–ç æ¦‚å¿µã€‚éšæ„çœ‹çœ‹ğŸ‘¨â€ğŸ’» ğŸ‘©â€ğŸ’»</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://dumas-olivier.medium.com/what-i-didnt-know-about-ruby-classes-9de64ee40d4d">https://dumas-olivier.medium.com/what-i-didnt-know-about-ruby-classes-9de64ee40d4d</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/ruby/">#ruby</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/æ–¹æ³•/">#æ–¹æ³•</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ†äº«/">#åˆ†äº«</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>