<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>æ”»å‡»Rokuæ£å­æ˜¯ä¸ºäº†å¥½ç©å’Œè·åˆ©</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">æ”»å‡»Rokuæ£å­æ˜¯ä¸ºäº†å¥½ç©å’Œè·åˆ©</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-02 12:19:51</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/7cf484ceeae6bc7fc2161eddc603cd15.jpg"><img src="http://img2.diglog.com/img/2020/11/7cf484ceeae6bc7fc2161eddc603cd15.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Itâ€™s really been quite a while, but here Iâ€™m back, and this time weâ€™re going to explore Roku and video ads.</p><p>è¿™çœŸçš„æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œä½†æˆ‘åˆå›æ¥äº†ï¼Œè¿™æ¬¡æˆ‘ä»¬å°†æ¢ç´¢Rokuå’Œè§†é¢‘å¹¿å‘Šã€‚</p><p>  For those who are unfamiliar, Roku is a line of popular media streamers that allow media streaming from different sources, i.e. â€œchannelsâ€, such as Netflix, Apple TV and more. Channels are developed by 3d party developers and can be found on the â€œ channel storeâ€œ. They arenâ€™t just playing media, but actually feature rich apps (much like mobile apps) in terms of capabilities: they can respond to user interactions and input from sensors , so you can find games, Reddit clients, etc.</p><p>å¯¹äºé‚£äº›ä¸ç†Ÿæ‚‰çš„äººæ¥è¯´ï¼ŒRokuæ˜¯ä¸€ç³»åˆ—æµè¡Œçš„åª’ä½“æµåª’ä½“ï¼Œå…è®¸æ¥è‡ªä¸åŒæ¥æºçš„åª’ä½“æµï¼Œå³â€œé¢‘é“â€ï¼Œå¦‚Netflixï¼ŒApple TVç­‰ã€‚é¢‘é“ç”±3Dæ´¾å¯¹å¼€å‘è€…å¼€å‘ï¼Œå¯ä»¥åœ¨â€œé¢‘é“å•†åº—â€æ‰¾åˆ°ã€‚å®ƒä»¬ä¸ä»…ä»…æ˜¯æ’­æ”¾åª’ä½“ï¼Œå°±åŠŸèƒ½è€Œè¨€ï¼Œå®ƒä»¬å®é™…ä¸Šå…·æœ‰ä¸°å¯Œçš„åº”ç”¨ç¨‹åº(å¾ˆåƒç§»åŠ¨åº”ç”¨ç¨‹åº)ï¼šå®ƒä»¬å¯ä»¥å“åº”ç”¨æˆ·äº¤äº’å’Œæ¥è‡ªä¼ æ„Ÿå™¨çš„è¾“å…¥ï¼Œæ‰€ä»¥ä½ å¯ä»¥æ‰¾åˆ°æ¸¸æˆã€Redditå®¢æˆ·ç«¯ç­‰ã€‚</p><p>  Roku offers channel developers both subscriptions and ads as monetization mechanisms. Roku devices are capable of displaying video ads using various industry standard formats, most notably  VAST. For the developer side, they offer both  Roku Advertising Framework (RAF) which is an SDK for requesting and rendering video ads, and a  self serve platform to promote the channel and increase the audience. For the advertiser side, they offer  OneView, which is based on their  DataXu acquisition. In order to be eligible for ads monetization, a channel must be  approved by Roku, based on its  content and engagement metrics.</p><p>Rokuå‘æ¸ é“å¼€å‘å•†æä¾›è®¢é˜…å’Œå¹¿å‘Šä¸¤ç§ç›ˆåˆ©æœºåˆ¶ã€‚Rokuè®¾å¤‡èƒ½å¤Ÿä½¿ç”¨å„ç§è¡Œä¸šæ ‡å‡†æ ¼å¼æ˜¾ç¤ºè§†é¢‘å¹¿å‘Šï¼Œæœ€å¼•äººæ³¨ç›®çš„æ˜¯å¤§é‡ã€‚åœ¨å¼€å‘è€…æ–¹é¢ï¼Œä»–ä»¬æä¾›äº†Roku Advertising Framework(Roku Advertising Frameworkï¼ŒRAF)ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºè¯·æ±‚å’Œå‘ˆç°è§†é¢‘å¹¿å‘Šçš„SDKï¼Œä»¥åŠä¸€ä¸ªç”¨äºæ¨å¹¿é¢‘é“å’Œå¢åŠ å—ä¼—çš„è‡ªåŠ©å¼å¹³å°ã€‚å¯¹äºå¹¿å‘Šä¸»æ–¹é¢ï¼Œä»–ä»¬æä¾›OneViewï¼Œè¿™æ˜¯åŸºäºä»–ä»¬æ”¶è´­çš„DataXuã€‚ä¸ºäº†æœ‰èµ„æ ¼è·å¾—å¹¿å‘Šè´§å¸åŒ–ï¼Œæ¸ é“å¿…é¡»æ ¹æ®å…¶å†…å®¹å’Œå‚ä¸åº¦æ ‡å‡†è·å¾—Rokuçš„æ‰¹å‡†ã€‚</p><p> According to industry  rumors, CPM on Roku are significantly higher than traditional web display and are in the rage of tens of dollar, depends on the channelâ€™s  content genre and  ad type (pre / mid roll) and the deviceâ€™s IP geolocation. Funnily enough, sometimes the ads CPM can, in fact, be higher then the cost of the Roku device itself, which fits perfectly their strategy, as put out by  AdExchanger:</p><p>æ ¹æ®ä¸šå†…ä¼ è¨€ï¼ŒRokuä¸Šçš„CPMæ˜æ˜¾é«˜äºä¼ ç»Ÿçš„ç½‘ç»œå±•ç¤ºï¼Œä»·æ ¼åœ¨å‡ åç¾å…ƒå·¦å³ï¼Œè¿™å–å†³äºé¢‘é“çš„å†…å®¹ç±»å‹å’Œå¹¿å‘Šç±»å‹(å‰æ»š/ä¸­æ»š)å’Œè®¾å¤‡çš„IPåœ°ç†ä½ç½®ã€‚æœ‰è¶£çš„æ˜¯ï¼Œæ­£å¦‚AdExchangeæå‡ºçš„é‚£æ ·ï¼Œæœ‰æ—¶ADS CPMå®é™…ä¸Šå¯èƒ½æ¯”Rokuè®¾å¤‡æœ¬èº«çš„æˆæœ¬æ›´é«˜ï¼Œè¿™å®Œå…¨ç¬¦åˆä»–ä»¬çš„æˆ˜ç•¥ï¼š</p><p> Rokuâ€™s go-to-market strategy is simple: Get as many streaming devices into as many homes as cheaply as possible, and monetize them through advertising.</p><p>Rokuçš„å…¥å¸‚æˆ˜ç•¥å¾ˆç®€å•ï¼šè®©å°½å¯èƒ½å¤šçš„æµåª’ä½“è®¾å¤‡ä»¥å°½å¯èƒ½ä½çš„ä»·æ ¼è¿›å…¥æ›´å¤šçš„å®¶åº­ï¼Œå¹¶é€šè¿‡å¹¿å‘Šå°†å…¶è´§å¸åŒ–ã€‚</p><p> Alison Weissbrot</p><p>è‰¾è‰æ£®Â·é­æ–¯å¸ƒç½—ç‰¹ã€‚</p><p>  Everybody in adtech knows that high CPMs attracts fraudsters, and Rokuâ€™s case is not different. In the past,  several  schemes  were  found and disclosed.</p><p>å¹¿å‘Šç•Œçš„æ¯ä¸ªäººéƒ½çŸ¥é“ï¼Œé«˜CPMä¼šå¸å¼•æ¬ºè¯ˆè€…ï¼ŒRokuçš„æƒ…å†µä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨è¿‡å»ï¼Œå‘ç°å¹¶æŠ«éœ²äº†å‡ ä¸ªè®¡åˆ’ã€‚</p><p> But itâ€™s not just high CPMs. Roku (and Connected TVs in general) has weaker threat model and is easier to manipulate without getting caught. Since Roku ads arenâ€™t rendered inside a browser or webview of any kind but rather in the platformâ€™s  native player, traditional JavasScript based verification tag simply arenâ€™t relevant.</p><p>ä½†è¿™ä¸ä»…ä»…æ˜¯é«˜CPMã€‚Roku(å’Œä¸€èˆ¬çš„è”ç½‘ç”µè§†)çš„å¨èƒæ¨¡å‹è¾ƒå¼±ï¼Œæ›´å®¹æ˜“æ“çºµï¼Œè€Œä¸ä¼šè¢«æŠ“åˆ°ã€‚ç”±äºRokuå¹¿å‘Šä¸æ˜¯åœ¨ä»»ä½•ç±»å‹çš„æµè§ˆå™¨æˆ–Webviewä¸­å‘ˆç°ï¼Œè€Œæ˜¯åœ¨å¹³å°çš„æœ¬åœ°æ’­æ”¾å™¨ä¸­å‘ˆç°ï¼Œå› æ­¤ä¼ ç»Ÿçš„åŸºäºJavasScriptçš„éªŒè¯æ ‡è®°æ ¹æœ¬æ— å…³ç´§è¦ã€‚</p><p> Furthermore, RAF only supports VAST 2 and 3, which doesnâ€™t even include the AdVerification element, nor even the Server Side Ad Insertion verification headers. Generally speaking, whatâ€™s left to verification vendor to do is to stuff their pixels inside the VAST Impression and TrackingEvents elements, which only allows them to performs basic checks against the requests timings and device IP, similarly to what Iâ€™ve described in the past in  my overview of pre-bid filtering solutions. All other values are declared and cloud be easily spoofed by malicious actor.</p><p>æ­¤å¤–ï¼ŒRAFåªæ”¯æŒVavast 2å’ŒVast 3ï¼Œå®ƒç”šè‡³ä¸åŒ…å«AdVerifyå…ƒç´ ï¼Œç”šè‡³ä¸åŒ…å«æœåŠ¡å™¨ç«¯å¹¿å‘Šæ’å…¥éªŒè¯å¤´ã€‚ä¸€èˆ¬è¯´æ¥ï¼ŒéªŒè¯ä¾›åº”å•†è¦åšçš„å°±æ˜¯å°†ä»–ä»¬çš„åƒç´ å¡«å……åˆ°å¤§é‡Impressionå’ŒTrackingEventså…ƒç´ ä¸­ï¼Œè¿™åªå…è®¸ä»–ä»¬é’ˆå¯¹è¯·æ±‚æ—¶é—´å’Œè®¾å¤‡IPæ‰§è¡ŒåŸºæœ¬æ£€æŸ¥ï¼Œç±»ä¼¼äºæˆ‘è¿‡å»åœ¨æŠ•æ ‡å‰è¿‡æ»¤è§£å†³æ–¹æ¡ˆæ¦‚è¿°ä¸­æ‰€æè¿°çš„ã€‚æ‰€æœ‰å…¶ä»–å€¼éƒ½å·²å£°æ˜ï¼Œå¹¶ä¸”äº‘å¾ˆå®¹æ˜“è¢«æ¶æ„æ”»å‡»è€…æ¬ºéª—ã€‚</p><p>  Channel spoofing (aka counterfeit inventory): thereâ€™s no  Ads.txt equivalent, so thereâ€™s no way to verify the the parameters in the bid request, which means esoteric channels can pretend to be Netflix, NBA, or whoever, in order to attract higher bids.</p><p>é¢‘é“æ¬ºéª—(ä¹Ÿå°±æ˜¯å‡å†’åº“å­˜)ï¼šæ²¡æœ‰ç›¸å½“äºAds.txtçš„å¹¿å‘Šï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•éªŒè¯ç«æ ‡è¯·æ±‚ä¸­çš„å‚æ•°ï¼Œè¿™æ„å‘³ç€æ·±å¥¥çš„é¢‘é“å¯ä»¥ä¼ªè£…æˆNetflixã€NBAæˆ–ä»»ä½•äººï¼Œä»¥å¸å¼•æ›´é«˜çš„å‡ºä»·ã€‚</p><p> Device spoofing: Itâ€™s possible to initiate ad requests with Roku user agent from other agents (apps / browsers). Although detectable by TCP/HTTP fingerprints, Roku supports Server Side Ad Insertion which is ideal for fraud: Only one IP is needed as both requests and tracking events (such as mid quartile of the ad was played) are initiated by design from the publisherâ€™s server.</p><p>è®¾å¤‡æ¬ºéª—ï¼šå¯ä»¥ä½¿ç”¨Rokuç”¨æˆ·ä»£ç†ä»å…¶ä»–ä»£ç†(åº”ç”¨ç¨‹åº/æµè§ˆå™¨)å‘èµ·å¹¿å‘Šè¯·æ±‚ã€‚è™½ç„¶Rokuå¯ä»¥é€šè¿‡TCP/HTTPæŒ‡çº¹æ£€æµ‹åˆ°ï¼Œä½†Rokuæ”¯æŒæœåŠ¡å™¨ç«¯å¹¿å‘Šæ’å…¥ï¼Œè¿™æ˜¯æ¬ºè¯ˆçš„ç†æƒ³é€‰æ‹©ï¼šåªéœ€è¦ä¸€ä¸ªIPï¼Œå› ä¸ºè¯·æ±‚å’Œè·Ÿè¸ªäº‹ä»¶(ä¾‹å¦‚æ’­æ”¾å¹¿å‘Šçš„å››åˆ†ä¹‹ä¸€)éƒ½æ˜¯ä»å‘è¡Œå•†çš„æœåŠ¡å™¨è®¾è®¡å‘èµ·çš„ã€‚</p><p> Impression spoofing: with the lack of viewability measurements in CTV, itâ€™s technically possible to initiate ad requests and fire the impression and event pixels with even drawing anything to the screen. All you need is an HTTP and XML parser libraries.</p><p>å°è±¡æ¬ºéª—ï¼šç”±äºCTVç¼ºä¹å¯çœ‹æ€§æµ‹é‡ï¼Œä»æŠ€æœ¯ä¸Šè®²ï¼Œå¯ä»¥å‘èµ·å¹¿å‘Šè¯·æ±‚å¹¶æ¿€å‘å°è±¡å’Œäº‹ä»¶åƒç´ ï¼Œç”šè‡³å¯ä»¥åœ¨å±å¹•ä¸Šç»˜åˆ¶ä»»ä½•å†…å®¹ã€‚æ‚¨æ‰€éœ€è¦çš„åªæ˜¯ä¸€ä¸ªHTTPå’ŒXMLè§£æå™¨åº“ã€‚</p><p>  All the ad fraud risks detailed above arenâ€™t really Roku specific but rather apply to CTV advertising in general. However, I got myself a Roku stick for the purpose of specifically analyze it, and I found rather interesting findings: Roku exposes â€œ External Control Protocolâ€ over the local network, as described in their docs:</p><p>ä¸Šé¢è¯¦è¿°çš„æ‰€æœ‰å¹¿å‘Šæ¬ºè¯ˆé£é™©å¹¶ä¸æ˜¯Rokuæ‰€ç‰¹æœ‰çš„ï¼Œè€Œæ˜¯é€‚ç”¨äºä¸€èˆ¬çš„æœ‰çº¿ç”µè§†å¹¿å‘Šã€‚ç„¶è€Œï¼Œæˆ‘ç»™è‡ªå·±ä¹°äº†ä¸€æ ¹Rokuæ£’æ¥ä¸“é—¨åˆ†æå®ƒï¼Œæˆ‘å‘ç°äº†ç›¸å½“æœ‰è¶£çš„å‘ç°ï¼šRokuåœ¨æœ¬åœ°ç½‘ç»œä¸Šæš´éœ²äº†â€œå¤–éƒ¨æ§åˆ¶åè®®â€ï¼Œå¦‚ä»–ä»¬çš„æ–‡æ¡£ä¸­æ‰€è¿°ï¼š</p><p> The External Control Protocol (ECP) enables a Roku device to be controlled over a local area network by providing a number of external control services. The Roku devices offering these external control services are discoverable using SSDP (Simple Service Discovery Protocol). ECP is a simple RESTful API that can be accessed by programs in virtually any programming environment.</p><p>å¤–éƒ¨æ§åˆ¶åè®®(ECP)é€šè¿‡æä¾›å¤šä¸ªå¤–éƒ¨æ§åˆ¶æœåŠ¡ä½¿Rokuè®¾å¤‡èƒ½å¤Ÿåœ¨å±€åŸŸç½‘ä¸Šè¢«æ§åˆ¶ã€‚å¯ä»¥ä½¿ç”¨SSDP(ç®€å•æœåŠ¡å‘ç°åè®®)å‘ç°æä¾›è¿™äº›å¤–éƒ¨æ§åˆ¶æœåŠ¡çš„Rokuè®¾å¤‡ã€‚ECPæ˜¯ä¸€ä¸ªç®€å•çš„RESTful APIï¼Œå‡ ä¹å¯ä»¥ç”±ä»»ä½•ç¼–ç¨‹ç¯å¢ƒä¸­çš„ç¨‹åºè®¿é—®ã€‚</p><p> While very convenient for the users, who can install things such as mobile Roku remote apps and they just work, this mechanism does not include any authentication mechanism, which means anything inside the LAN could use it to issue ECP commands to the Roku device.</p><p>è™½ç„¶å¯¹äºç”¨æˆ·æ¥è¯´éå¸¸æ–¹ä¾¿ï¼Œä»–ä»¬å¯ä»¥å®‰è£…ç§»åŠ¨Rokuè¿œç¨‹åº”ç”¨ç¨‹åºï¼Œä½†ä»–ä»¬åªæ˜¯å·¥ä½œï¼Œä½†è¿™ç§æœºåˆ¶ä¸åŒ…æ‹¬ä»»ä½•èº«ä»½éªŒè¯æœºåˆ¶ï¼Œè¿™æ„å‘³ç€LANå†…çš„ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨å®ƒå‘Rokuè®¾å¤‡å‘å‡ºECPå‘½ä»¤ã€‚</p><p> So at least in theory, itâ€™s possible to control Roku devices by executing JavaScript code on a browser that is running on the same LAN. Sounds great, isnâ€™t it? Luckily, the default ECP port, 8060, is not blocked by browsers (some  other ports are blocked, such as 22 for SSH, because of the exact same attack could be used on other sensitive services).</p><p>å› æ­¤ï¼Œè‡³å°‘åœ¨ç†è®ºä¸Šï¼Œå¯ä»¥é€šè¿‡åœ¨åŒä¸€LANä¸Šè¿è¡Œçš„æµè§ˆå™¨ä¸Šæ‰§è¡ŒJavaScriptä»£ç æ¥æ§åˆ¶Rokuè®¾å¤‡ã€‚å¬èµ·æ¥ä¸é”™ï¼Œä¸æ˜¯å—ï¼Ÿå¹¸è¿çš„æ˜¯ï¼Œé»˜è®¤çš„ECPç«¯å£8060æ²¡æœ‰è¢«æµè§ˆå™¨é˜»æ­¢(å…¶ä»–ä¸€äº›ç«¯å£è¢«é˜»æ­¢ï¼Œä¾‹å¦‚SSHçš„22ç«¯å£ï¼Œå› ä¸ºå®Œå…¨ç›¸åŒçš„æ”»å‡»å¯èƒ½åœ¨å…¶ä»–æ•æ„ŸæœåŠ¡ä¸Šä½¿ç”¨)ã€‚</p><p> It means an attacker could, for example, run the malicious JavaScript code through ad networks, i.e.  malvertising campaign, and send ECP commands to Roku devices, if the user behind the browser has one (and the attacker is able to locate its IP address, more on that later). I wanted to focus on this specific attack because itâ€™s fairly easy to get your JS running cheaply, in large volumes, by (ab)using ad networks, which is important in order to make the attack practical and economically feasible by having reasonable cost of â€œuser acquisitionâ€ relative to its monetization potential.</p><p>ä¾‹å¦‚ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥é€šè¿‡å¹¿å‘Šç½‘ç»œ(å³æ¶æ„å¹¿å‘Šæ´»åŠ¨)è¿è¡Œæ¶æ„JavaScriptä»£ç ï¼Œå¹¶å‘Rokuè®¾å¤‡å‘é€ECPå‘½ä»¤(å¦‚æœæµè§ˆå™¨åé¢çš„ç”¨æˆ·æœ‰ECPå‘½ä»¤çš„è¯)(å¹¶ä¸”æ”»å‡»è€…èƒ½å¤Ÿæ‰¾åˆ°å…¶IPåœ°å€ï¼Œç¨åå°†è¯¦ç»†ä»‹ç»)ã€‚æˆ‘ä¹‹æ‰€ä»¥å°†é‡ç‚¹æ”¾åœ¨è¿™ä¸ªç‰¹å®šçš„æ”»å‡»ä¸Šï¼Œæ˜¯å› ä¸ºé€šè¿‡(Ab)ä½¿ç”¨å¹¿å‘Šç½‘ç»œï¼Œå¾ˆå®¹æ˜“è®©æ‚¨çš„JSå¤§é‡å»‰ä»·è¿è¡Œï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå› ä¸ºç›¸å¯¹äºå…¶è´§å¸åŒ–æ½œåŠ›è€Œè¨€ï¼Œæ‹¥æœ‰åˆç†çš„â€œç”¨æˆ·è·å–â€æˆæœ¬ï¼Œæ‰èƒ½ä½¿æ”»å‡»å˜å¾—å®ç”¨å’Œç»æµå¯è¡Œã€‚</p><p> I wanted to see whatâ€™s possible with ECP, and going over the â€œgeneral commandsâ€ in the docs (linked above), and two of them immediately jumped: install/&lt;APP_ID&gt; and keypress/&lt;KEY&gt;. As their names suggests, the former lets you launch the install screen of arbitrary app (channel) id, and the latter allows you to press whatever key you want to, as if youâ€™re holding the Rokuâ€™s remote in your hand. Together, they are a powerful combination, since you can install (and lauch) any app on the victimâ€™s device.</p><p>æˆ‘æƒ³çœ‹çœ‹ECPèƒ½åšäº›ä»€ä¹ˆï¼Œå¹¶æµè§ˆäº†æ–‡æ¡£ä¸­çš„â€œä¸€èˆ¬å‘½ä»¤â€(ä¸Šé¢é“¾æ¥)ï¼Œå…¶ä¸­ä¸¤ä¸ªå‘½ä»¤ç«‹å³è·³è¿‡ï¼šinstall/&ltï¼›APP_ID&gtï¼›å’Œkeypress/&ltï¼›key&gtï¼›(å®‰è£…/&ltï¼›APP_ID&gtï¼›å’ŒKEYPRESS/&ltï¼›é”®&gtï¼›)ã€‚é¡¾åæ€ä¹‰ï¼Œå‰è€…å¯ä»¥è®©ä½ å¯åŠ¨ä»»æ„app(Channel)idçš„å®‰è£…å±å¹•ï¼Œè€Œåè€…å¯ä»¥è®©ä½ éšå¿ƒæ‰€æ¬²åœ°æŒ‰ä»»ä½•é”®ï¼Œå°±åƒä½ æ‰‹é‡Œæ‹¿ç€Rokuçš„é¥æ§å™¨ä¸€æ ·ã€‚æ€»è€Œè¨€ä¹‹ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç»„åˆï¼Œå› ä¸ºä½ å¯ä»¥åœ¨å—å®³è€…çš„è®¾å¤‡ä¸Šå®‰è£…(å’Œå¯åŠ¨)ä»»ä½•åº”ç”¨ç¨‹åºã€‚</p><p> Now, letâ€™s assume we have developed and uploaded an app to the Roku channel store, and we want to install it on as many users as possible. We want to do so because we can:</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬å·²ç»å¼€å‘äº†ä¸€ä¸ªåº”ç”¨ç¨‹åºå¹¶å°†å…¶ä¸Šä¼ åˆ°Rokué¢‘é“å•†åº—ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›åœ¨å°½å¯èƒ½å¤šçš„ç”¨æˆ·ä¸Šå®‰è£…å®ƒã€‚æˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬å¯ä»¥ï¼š</p><p> Create a paid channel and collect the payments from the victims. Remember, they didnâ€™t choose to install anything, we will force their device to install our app with ECP. Easy, but considered as CC fraud and the FBI will find you ğŸ™‚</p><p>åˆ›å»ºä»˜è´¹é¢‘é“å¹¶å‘å—å®³è€…æ”¶å–æ¬¾é¡¹ã€‚è®°ä½ï¼Œä»–ä»¬æ²¡æœ‰é€‰æ‹©å®‰è£…ä»»ä½•ä¸œè¥¿ï¼Œæˆ‘ä»¬å°†å¼ºåˆ¶ä»–ä»¬çš„è®¾å¤‡ä½¿ç”¨ECPå®‰è£…æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚å¾ˆç®€å•ï¼Œä½†è¢«è®¤ä¸ºæ˜¯CCè¯ˆéª—ï¼Œè”é‚¦è°ƒæŸ¥å±€ä¼šæ‰¾åˆ°ä½ çš„ğŸ™‚ã€‚</p><p> Create free channel and monetize it with ads. The challenge is that in order to display ads, the channel must be launched. Although itâ€™s possible to launch it with ECP, itâ€™s not stealthy. The user will notice that an unwanted channel is running and will close it and probably remove it. One solution to this problem is to find a bug in BrightScript (Rokuâ€™s app programming language) or other system component and exploit it for privileges escalation, then installing a daemon directly on the OS (Roku OS is Linux), but thatâ€™s hard. A much easier solution would be to install a  screensaver, which, according to the docs, â€œis a channel which is run automatically when the system has been idle for a period of time.â€</p><p>åˆ›å»ºå…è´¹é¢‘é“ï¼Œå¹¶é€šè¿‡å¹¿å‘Šå°†å…¶è´§å¸åŒ–ã€‚æŒ‘æˆ˜åœ¨äºï¼Œä¸ºäº†å±•ç¤ºå¹¿å‘Šï¼Œå¿…é¡»æ¨å‡ºè¯¥é¢‘é“ã€‚è™½ç„¶å¯ä»¥ç”¨ECPå‘å°„ï¼Œä½†å®ƒä¸æ˜¯éšå½¢çš„ã€‚ç”¨æˆ·å°†æ³¨æ„åˆ°ä¸€ä¸ªä¸éœ€è¦çš„é€šé“æ­£åœ¨è¿è¡Œï¼Œå¹¶å°†å…³é—­è¯¥é€šé“å¹¶å¯èƒ½å°†å…¶ç§»é™¤ã€‚è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯æ‰¾åˆ°BrightScript(Rokuçš„åº”ç”¨ç¨‹åºç¼–ç¨‹è¯­è¨€)æˆ–å…¶ä»–ç³»ç»Ÿç»„ä»¶ä¸­çš„é”™è¯¯ï¼Œå¹¶åˆ©ç”¨å®ƒè¿›è¡Œæƒé™æå‡ï¼Œç„¶åç›´æ¥åœ¨æ“ä½œç³»ç»Ÿ(Roku OSæ˜¯Linux)ä¸Šå®‰è£…ä¸€ä¸ªå®ˆæŠ¤ç¨‹åºï¼Œä½†è¿™å¾ˆå›°éš¾ã€‚ä¸€ä¸ªæ›´ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯å®‰è£…ä¸€ä¸ªå±å¹•ä¿æŠ¤ç¨‹åºï¼Œæ ¹æ®æ–‡æ¡£çš„è¯´æ³•ï¼Œå®ƒâ€œæ˜¯ä¸€ä¸ªåœ¨ç³»ç»Ÿç©ºé—²ä¸€æ®µæ—¶é—´åè‡ªåŠ¨è¿è¡Œçš„é€šé“ã€‚â€</p><p> Now that we have two viable monetization options which we can execute by (ab)using ECP, the next missing step is finding the Rokuâ€™s IP address. Normally we would use  SSDP search request, but unfortunately in our malvertising scenario, we can not read the SSDP response due to the browserâ€™s  Same Origin Policy, so another approach is needed â€“ we have to do local network scanning in JavaScript, from the browser ğŸ™‚</p><p>ç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ä¸ªå¯è¡Œçš„è´§å¸åŒ–é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ECPé€šè¿‡(Ab)æ‰§è¡Œï¼Œä¸‹ä¸€ä¸ªç¼ºå¤±çš„æ­¥éª¤æ˜¯æŸ¥æ‰¾Rokuçš„IPåœ°å€ã€‚é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨ssdpæœç´¢è¯·æ±‚ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œåœ¨æˆ‘ä»¬çš„æ¶æ„å¹¿å‘Šåœºæ™¯ä¸­ï¼Œç”±äºæµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œæˆ‘ä»¬æ— æ³•è¯»å–ssdpå“åº”ï¼Œå› æ­¤éœ€è¦å¦ä¸€ç§æ–¹æ³•-æˆ‘ä»¬å¿…é¡»åœ¨æµè§ˆå™¨ğŸ™‚ä¸­ä½¿ç”¨javascriptè¿›è¡Œæœ¬åœ°ç½‘ç»œæ‰«æã€‚</p><p> The first step would be to find the address range that we need to scan, so  WebRTC Peer Connection immediately comes to mind, because it uses  ICE for  NAT traversal and used the expose the internal IP of the client through  SDP. This feature was abused in the past by fingerprinting vendors, even  famously on NYTimes website by WhiteOps. Unfortunately (or fortunately, depends on how you look at this), not so long ago relative to time of this writing, browsers started to implement  a proposal to use mDNS to protect users privacy when exposing ICE candidates, which means youâ€™ll get an address that looks like 1f528c83-551f-4f34-ad3a-67524d2fed83.local instead of 192.168.1.4.</p><p>ç¬¬ä¸€æ­¥æ˜¯æ‰¾åˆ°æˆ‘ä»¬éœ€è¦æ‰«æçš„åœ°å€èŒƒå›´ï¼Œå› æ­¤ä¼šç«‹å³æƒ³åˆ°WebRTCå¯¹ç­‰è¿æ¥ï¼Œå› ä¸ºå®ƒä½¿ç”¨ICEè¿›è¡ŒNATç©¿è¶Šï¼Œå¹¶é€šè¿‡SDPæš´éœ²å®¢æˆ·ç«¯çš„å†…éƒ¨IPã€‚è¿™ä¸€åŠŸèƒ½è¿‡å»æ›¾è¢«æŒ‡çº¹è¯†åˆ«ä¾›åº”å•†æ»¥ç”¨ï¼Œç”šè‡³åœ¨çº½çº¦æ—¶æŠ¥ç½‘ç«™ä¸Šè¢«WhiteOpsæ»¥ç”¨ä¹Ÿæ˜¯å‡ºäº†åçš„ã€‚ä¸å¹¸çš„æ˜¯(æˆ–è€…å¹¸è¿çš„æ˜¯ï¼Œè¿™å–å†³äºæ‚¨æ˜¯å¦‚ä½•çœ‹å¾…è¿™ä¸ªé—®é¢˜çš„)ï¼Œå°±åœ¨ä¸ä¹…ä¹‹å‰ï¼Œç›¸å¯¹äºæ’°å†™æœ¬æ–‡æ—¶ï¼Œæµè§ˆå™¨å¼€å§‹å®æ–½ä¸€é¡¹å»ºè®®ï¼Œåœ¨å…¬å¼€ICEå€™é€‰è€…æ—¶ä½¿ç”¨mDNSæ¥ä¿æŠ¤ç”¨æˆ·éšç§ï¼Œè¿™æ„å‘³ç€æ‚¨å°†å¾—åˆ°ä¸€ä¸ªç±»ä¼¼äº1f528c83-551f-4f34-ad3a-67524d2fed83.localçš„åœ°å€ï¼Œè€Œä¸æ˜¯192.168.1.4ã€‚</p><p>     For the sake of simplicity of our PoC, we are going to scan by brute force only the last one (192.168/16), which is most commonly used by home routers anyway, and they usually assign new clients IP (using  DHCP) in the same subnet.</p><p>ä¸ºäº†ç®€åŒ–æˆ‘ä»¬çš„PoCï¼Œæˆ‘ä»¬å°†åªæš´åŠ›æ‰«ææœ€åä¸€ä¸ª(192.168/16)ï¼Œè¿™æ˜¯å®¶åº­è·¯ç”±å™¨æœ€å¸¸ç”¨çš„ï¼Œå¹¶ä¸”å®ƒä»¬é€šå¸¸åœ¨åŒä¸€å­ç½‘ä¸­ä¸ºæ–°å®¢æˆ·ç«¯åˆ†é…IP(ä½¿ç”¨DHCP)ã€‚</p><p>    For each IP address, initiate HTTP GET request with Rokuâ€™s ECP port (8060), with Roku specific URL path (for example, 192.168.0.1:8060/query/apps). For 1, error event will be fired after the browserâ€™s timeout passed, because the address is unreachable. For 2, error event will be fired because itâ€™s not a valid URL. For 2, load event will be fired and we could use it to identify the Rokuâ€™s IP address.</p><p>å¯¹äºæ¯ä¸ªIPåœ°å€ï¼Œä½¿ç”¨Rokuçš„ECPç«¯å£(8060)å‘èµ·HTTP GETè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨Rokuç‰¹å®šçš„URLè·¯å¾„(ä¾‹å¦‚ï¼Œ192.168.0.1ï¼š8060/query/apps)ã€‚å¯¹äº%1ï¼Œå°†åœ¨æµè§ˆå™¨è¶…æ—¶åæ¿€å‘é”™è¯¯äº‹ä»¶ï¼Œå› ä¸ºæ— æ³•è®¿é—®è¯¥åœ°å€ã€‚å¯¹äº%2ï¼Œå°†æ¿€å‘é”™è¯¯äº‹ä»¶ï¼Œå› ä¸ºå®ƒä¸æ˜¯æœ‰æ•ˆçš„URLã€‚å¯¹äº2ï¼Œå°†æ¿€å‘Loadäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯†åˆ«Rokuçš„IPåœ°å€ã€‚</p><p> Note that the requests must be HTTP and not HTTPS, as the Roku ECP doesnâ€™t support HTTPS. Up until recently it was not a problem, because by using  passive mixed content we could initiate HTTP requests from HTTPS, so we could run this network scan logic directly inside the malicious adâ€™s creative code.</p><p>è¯·æ³¨æ„ï¼Œè¯·æ±‚å¿…é¡»æ˜¯HTTPè€Œä¸æ˜¯HTTPSï¼Œå› ä¸ºRoku ECPä¸æ”¯æŒHTTPSã€‚ç›´åˆ°æœ€è¿‘ï¼Œè¿™è¿˜ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºé€šè¿‡ä½¿ç”¨è¢«åŠ¨çš„æ··åˆå†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»HTTPSå‘èµ·HTTPè¯·æ±‚ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åœ¨æ¶æ„å¹¿å‘Šçš„åˆ›é€ æ€§ä»£ç ä¸­è¿è¡Œè¿™ä¸ªç½‘ç»œæ‰«æé€»è¾‘ã€‚</p><p> However,  Chrome recently started  blocking mixed content (HTTP content on HTTPS websites) by default, without falling back to HTTP when the content isnâ€™t available over HTTPS. Since most websites / ads are served nowadays over HTTPS, it would make it impossible to use this method directly in the ad, but still itâ€™s possible to do so from an attacker controlled HTTP web page, either by making it the destination of the adâ€™s landing page (and buying PPC), or just programmatically force redirecting the user to such a page, which is a commonly used malvertising practice.</p><p>ç„¶è€Œï¼ŒChromeæœ€è¿‘å¼€å§‹åœ¨é»˜è®¤æƒ…å†µä¸‹å±è”½æ··åˆå†…å®¹(HTTPSç½‘ç«™ä¸Šçš„HTTPå†…å®¹)ï¼Œå½“å†…å®¹ä¸èƒ½é€šè¿‡HTTPSè®¿é—®æ—¶ï¼Œä¸ä¼šé€€å›åˆ°HTTPã€‚ç”±äºç°åœ¨å¤§å¤šæ•°ç½‘ç«™/å¹¿å‘Šéƒ½æ˜¯é€šè¿‡HTTPSæä¾›æœåŠ¡çš„ï¼Œå› æ­¤ä¸å¯èƒ½åœ¨å¹¿å‘Šä¸­ç›´æ¥ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œä½†ä»ç„¶å¯ä»¥ä»æ”»å‡»è€…æ§åˆ¶çš„HTTPç½‘é¡µæ‰§è¡Œæ­¤æ“ä½œï¼Œæ–¹æ³•æ˜¯å°†å…¶è®¾ç½®ä¸ºå¹¿å‘Šç™»å½•é¡µé¢çš„ç›®çš„åœ°(å¹¶è´­ä¹°PPC)ï¼Œæˆ–è€…ä»…é€šè¿‡ç¼–ç¨‹å¼ºåˆ¶ç”¨æˆ·é‡å®šå‘åˆ°æ­¤ç±»é¡µé¢ï¼Œè¿™æ˜¯ä¸€ç§å¸¸ç”¨çš„æ¶æ„è¡Œä¸ºã€‚</p><p>  EDIT: After giving it a second thought, I wonâ€™t publicly share the PoC code. Although all the details needed in order to implement it are available here in this post, I donâ€™t want to help script kiddies to launch attacks ğŸ™‚</p><p>ç¼–è¾‘ï¼šåœ¨é‡æ–°è€ƒè™‘ä¹‹åï¼Œæˆ‘ä¸ä¼šå…¬å¼€åˆ†äº«PoCä»£ç ã€‚è™½ç„¶å®ç°å®ƒæ‰€éœ€çš„æ‰€æœ‰ç»†èŠ‚éƒ½å¯ä»¥åœ¨æœ¬æ–‡ä¸­æ‰¾åˆ°ï¼Œä½†æˆ‘ä¸æƒ³å¸®åŠ©å­©å­ä»¬ç¼–å†™è„šæœ¬æ¥å‘åŠ¨æ”»å‡»ğŸ™‚ã€‚</p><p> So, after we found the IP address, all we have left is to send the ECP commands to install our channel:</p><p>å› æ­¤ï¼Œåœ¨æˆ‘ä»¬æ‰¾åˆ°IPåœ°å€ä¹‹åï¼Œå‰©ä¸‹çš„å°±æ˜¯å‘é€ECPå‘½ä»¤æ¥å®‰è£…æˆ‘ä»¬çš„é€šé“ï¼š</p><p> let rokuAddress = &#39;http://192.168.1.8:8060&#39;; // found previously with the scanner  let appId = 14; // MLB is just used for demonstration, replace with our malicious channel id let install = &#39;/install/&#39; + appId; let keypress = &#39;/keypress/&#39; let select = keypress + &#39;Select&#39;; let home = keypress + &#39;Home&#39;; function postToRoku (cmd) {  return fetch(rokuAddress + cmd, {method: &#39;POST&#39;, mode: &#39;no-cors&#39;}); } // launch the install screen postToRoku(install).then(res =&gt; {  // press the intall button  postToRoku(select).then(res =&gt; {  // go back to home screen  postToRoku(home);  }); });</p><p>è®©ä¹‹å‰ç”¨æ‰«æä»ªæ‰¾åˆ°çš„rokuAddress=&#39ï¼›http://192.168.1.8:8060&#39ï¼›ï¼›//åªç”¨äºæ¼”ç¤ºï¼Œæ›¿æ¢ä¸ºæˆ‘ä»¬çš„æ¶æ„é€šé“id let install=&#39ï¼›/install/&#39ï¼›+appidï¼›let keypress=&#39ï¼›/keypress/&#39ï¼›let select=keypress+#39ï¼›select&#39ï¼›let home=keypress+#39ï¼›Home&#39ï¼›å‡½æ•°postToRoku(Cmd){return Fetch(rokuAddress+cmdï¼Œ{methodï¼š&#39ï¼›post&#39ï¼›ï¼Œmodeï¼š&#39ï¼›no-cors&#39ï¼›})ï¼›}//å¯åŠ¨postToRoku(å®‰è£…)å±å¹•ã€‚ç„¶å(res=&gtï¼›{//æŒ‰å®‰è£…æŒ‰é’®postToRoku(Select)ã€‚ç„¶å(res=&gtï¼›{//è¿”å›ä¸»å±å¹•postToRoku(Home)ï¼›})ï¼›})ï¼›</p><p>  I really thinks this attack is not only theoretical, but really is a practical one. Itâ€™s possible to fix it be including a token that must be included in ECP requests in the initial SSDP response, this way the Roku device could verify that the EXP requests are coming from a party thatâ€™s able to read the response, such as remote control mobile app, and not from a browser. Unfortunately, this is not backward compatible and would probably break existing apps that are built on top of ECP.</p><p>æˆ‘çœŸçš„è®¤ä¸ºè¿™æ¬¡æ”»å‡»ä¸ä»…æ˜¯ç†è®ºä¸Šçš„ï¼Œè€Œä¸”æ˜¯çœŸæ­£çš„å®è·µã€‚æœ‰å¯èƒ½åœ¨åˆå§‹SSDPå“åº”ä¸­åŒ…æ‹¬ECPè¯·æ±‚ä¸­å¿…é¡»åŒ…æ‹¬çš„ä»¤ç‰Œï¼Œè¿™æ ·Rokuè®¾å¤‡å°±å¯ä»¥éªŒè¯EXPè¯·æ±‚æ˜¯å¦æ¥è‡ªèƒ½å¤Ÿè¯»å–å“åº”çš„ä¸€æ–¹ï¼Œä¾‹å¦‚è¿œç¨‹æ§åˆ¶ç§»åŠ¨åº”ç”¨ç¨‹åºï¼Œè€Œä¸æ˜¯æ¥è‡ªæµè§ˆå™¨ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸æ˜¯å‘åå…¼å®¹çš„ï¼Œå¯èƒ½ä¼šç ´åæ„å»ºåœ¨ECPä¹‹ä¸Šçš„ç°æœ‰åº”ç”¨ç¨‹åºã€‚</p><p> If you liked this post, are interested in ad security and want to chat â€“ donâ€™t hesitate to contact me! Iâ€™m also currently looking for new projects.</p><p>å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¦‚æœä½ å¯¹å¹¿å‘Šå®‰å…¨æ„Ÿå…´è¶£å¹¶æƒ³èŠå¤©-è¯·ä¸è¦çŠ¹è±«ä¸æˆ‘è”ç³»ï¼æˆ‘ç›®å‰ä¹Ÿåœ¨å¯»æ‰¾æ–°çš„é¡¹ç›®ã€‚</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://adtechmadness.wordpress.com/2020/11/01/attacking-roku-sticks-for-fun-and-profit/">https://adtechmadness.wordpress.com/2020/11/01/attacking-roku-sticks-for-fun-and-profit/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/roku/">#roku</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç¾å›½/">#ç¾å›½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è°·æ­Œ/">#è°·æ­Œ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç¨‹åº/">#ç¨‹åº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>