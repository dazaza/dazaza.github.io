<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>黑客使用Google Analytics窃取信用卡，绕过CSP</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">黑客使用Google Analytics窃取信用卡，绕过CSP</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-23 13:48:08</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/6/e8987dca65fa9fc13403a14feb60df0a.jpg"><img src="http://img.diglog.com/img/2020/6/e8987dca65fa9fc13403a14feb60df0a.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>黑客利用谷歌的服务器和谷歌分析平台窃取网上商店顾客提交的信用卡信息。</p><p>上周披露的一种使用谷歌分析API绕过内容安全政策(CSP)的新方法已经部署在正在进行的Magecart攻击中，该攻击旨在从数十个电子商务网站窃取信用卡数据。</p><p>这一新策略利用了这样一个事实，即使用谷歌网络分析服务来跟踪访问者的电子商务网站，正将谷歌分析域名列入白名单，列入其CSP安全配置(一种用于阻止在网络应用上执行不可信代码的安全标准)。</p><p>网络安全公司SansEC和PerimeterX的最新研究表明，在也部署了Google Analytics(GA)的网站上，使用CSP来防止信用卡掠夺攻击是毫无意义的，因为威胁行为者可以利用它将收获的数据渗透到自己的账户中。</p><p>6月17日，PerimeterX在CSP的核心功能中发现并演示了一个易于复制的漏洞，该漏洞用于阻止凭证、PII和支付数据(如信用卡)的窃取。</p><p>不是阻止基于注入的攻击，而是允许Google Analytics脚本使攻击者受益，因为他们可以利用这些脚本窃取数据。这是通过Web Skimmer脚本完成的，该脚本专门设计用于对窃取的数据进行编码，并以加密的形式将其传送到攻击者的GA仪表板。</p><p>攻击者只需使用自己的UA-#-#表单的标签ID所有者AS&#34；CSP策略不能基于标签ID&#34；进行歧视，以便他们的脚本能够滥用GA发送获取的信息，如凭据、信用卡数据等。</p><p>问题的根源是CSP规则体系不够精细，PerimeterX的研究副总裁阿米尔·沙克德解释说。</p><p>识别和阻止旨在滥用此缺陷的脚本需要高级可见性解决方案，该解决方案可以检测敏感用户数据(在本例中为用户的电子邮件地址和密码)的访问和泄露。</p><p>虽然Shaked使用GA作为攻击者使用CSP中白名单中的主机的示例，因为它是CSP配置中最常见的白名单第三方服务，但任何其他白名单域服务都会受到攻击或提供基于帐户的管理，就像GA可以用作流出通道一样。</p><p>根据PerimeterX基于2020年3月的HTTPArchive扫描得出的统计数据，在排名前300万的因特网域中，只有21万人在使用CSP。通过这些域名可以访问的网站中，有1.7万个网站被列入了白名单，名为google-analytics.com。</p><p>根据BuiltWith提供的数据，目前有超过2900万家网站在使用谷歌的GA网络分析服务，百度智能分析和Yandex-Metrika也分别在700多万和200万网站上使用。</p><p>SansEC的威胁研究团队今天透露，自3月17日以来，他们一直在跟踪Magecart的一次活动，攻击者利用这个问题，使用谷歌分析(Google Analytics)绕过了几十个电子商务网站上的CSP。</p><p>这场行动背后的威胁分子更进一步，他们通过谷歌的开放存储平台Firebasestorage.googleapis.com向目标网站提供信用卡网络掠夺器，以确保所有活动组件都在使用谷歌服务器。</p><p>SansEC解释说，通常情况下，数字掠夺器(又名Magecart)运行在避税天堂不可靠的服务器上，它的位置暴露了它的邪恶意图。</p><p>但是，当浏览活动完全在受信任的谷歌服务器上运行时，很少有安全系统会将其标记为可疑。更重要的是，当网站管理员信任谷歌时，像内容安全策略(CSP)这样的流行对策将不起作用。</p><p>攻击者用来注入他们的网络掠夺器的加载器有多层混淆，它被用来在临时框架内加载攻击者控制的AGA账户。</p><p>一旦加载，掠夺器将监视被攻破的网站的用户输入，它将抓取任何输入的信用卡信息，对其进行加密，并自动将其发送到其主GA仪表板。</p><p>然后，攻击者可以从他们的免费Google Analytics仪表盘中收集被盗的信用卡数据，并使用XOR加密密钥进行解密。</p><p>正如SansEC还发现的那样，如果受威胁的在线商店的客户打开他们的浏览器开发工具，他们将被标记，撇油器将自动禁用。</p><p>&#34；默认情况下允许所有内容。发明CSP是为了限制不可信代码的执行。但由于几乎每个人都信任谷歌，这种模式是有缺陷的，SansEC首席执行官兼创始人威廉·德·格鲁特(Willem De Groot)告诉BleepingComputer。</p><p>基于这些发现，如果攻击者找到利用已被允许的域/服务渗漏信息的方法，CSP远不能万无一失地抵御Magecart等基于注入的Web应用程序攻击。</p><p>Shaked总结道：一种可能的解决方案来自自适应URL，将ID添加为URL或子域的一部分，以允许管理员设置CSP规则，将数据外泄限制到其他帐户。</p><p>作为CSP标准的一部分，加强CSP方向的一个更细粒度的未来方向是XHR代理实施。这实质上将创建一个客户端WAF，该WAF可以执行关于允许向何处传输特定数据字段的策略。&#34；</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.bleepingcomputer.com/news/security/hackers-use-google-analytics-to-steal-credit-cards-bypass-csp/">https://www.bleepingcomputer.com/news/security/hackers-use-google-analytics-to-steal-credit-cards-bypass-csp/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/黑客/">#黑客</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/csp/">#csp</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1007747.html"><img src="http://img.diglog.com/img/2020/6/thumb_d829674efb9de3e44aaa4b0f6a59ef1f.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007747.html">组件的谷歌(Google)</a></div><span class="my_story_list_date">2020-6-23 10:47</span></div><div class="col-sm"><div><a target="_blank" href="/story/1007732.html"><img src="http://img.diglog.com/img/2020/6/thumb_1e35d2eebab052da2e12dca8845fdf14.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007732.html">骗子滥用谷歌分析隐瞒支付卡数据被盗</a></div><span class="my_story_list_date">2020-6-23 7:13</span></div><div class="col-sm"><div><a target="_blank" href="/story/1007667.html"><img src="http://img.diglog.com/img/2020/6/thumb_59de2958006b3d3d2d7996d456ff6c5e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007667.html">谷歌将开始事实核查谷歌图片</a></div><span class="my_story_list_date">2020-6-23 0:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1007612.html"><img src="http://img.diglog.com/img/2020/6/thumb_4e3466d18ab27650eeab1b92b2aec95b.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007612.html">谷歌的真正起源部分在于政府对大规模监控的拨款(2017)</a></div><span class="my_story_list_date">2020-6-22 15:3</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>