<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>印度政府联系人追踪App存在严重安全漏洞</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">印度政府联系人追踪App存在严重安全漏洞</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-07 02:09:39</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/5/c75974657df58f713f4f3a927d8cbda2.jpeg"><img src="http://img.diglog.com/img/2020/5/c75974657df58f713f4f3a927d8cbda2.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>为了对抗Covid19，印度政府发布了一款名为Aarogya Setu的移动联系人追踪应用程序。这个应用程序在Playstore上可以买到，已经有9000万印度人安装了它。</p><p>这个应用程序目前在印度获得了很大的关注。在诺伊达，如果人们没有在手机上安装应用程序，一个人可能会被判处最高6个月的监禁或最高1000卢比的罚款。</p><p>4月3日，也就是这款应用上线2天后，我决定看看这款应用的1.0.1版本。那是晚上11点54分，我看了不到2个小时。</p><p>凌晨1点27分，我发现一个名为WebViewActivity的活动行为异常。这个活动是一个网页浏览，理论上负责显示网页，例如隐私政策。</p><p>问题是WebViewActivity能够做的比这多一点。</p><p>如您所见，onPageStarted方法检查了str参数的值。如果str：-是tel：//[电话号码]：它将要求Android打开拨号器并预拨号码-不包含http或https，它什么也不做-否则它将打开具有指定URI的网页视图。</p><p>如您所见，根本没有主机验证。因此，我尝试通过发送以下命令打开名为FightCorona_prefs.xml的应用程序的内部文件。</p><p>为什么这是个问题？攻击者只需单击一次即可打开任何应用程序内部文件，包括名为Fight-covid-db的应用程序使用的本地数据库</p><p>5月4日，我决定进一步分析，我分析了这款应用的v1.1.1版本，也就是目前的版本。</p><p>我注意到的第一件事是前面描述的问题已经被开发人员悄悄地修复了。实际上，WebViewActivity不能再从外部访问，他们删除了AndroidManifest.xml中的意图过滤器。</p><p>为了继续我的分析，我决定在一台有根基的设备上使用这款应用程序。当我尝试的时候，我直接收到了这条消息。</p><p>我反编译了这个应用程序，并找到了这个根检测的实现位置。为了绕过它，我在Frida脚本中编写了一个小函数。</p><p>下一个挑战是能够绕过实现的证书锁定，以便能够监控应用程序发出的网络请求。一旦我这样做了，我使用了这款应用程序，发现了一个有趣的功能。</p><p>在这款应用中，你可以知道在你所在的地区有多少人做了自我评估。您可以选择该区域的半径。它可以是500米、1公里、2公里、5公里或10公里。</p><p>当用户单击以下距离之一时：-发送他的位置：查看标题中的经度和经度参数-发送半径选择：查看url中的dist参数和标题中的距离参数。</p><p>我注意到的第一件事是，这个端点返回了很多信息：-感染人数-不适人数-声明为蓝牙阳性的人数-在您周围进行的自我评估的人数-在您周围使用该应用程序的人数</p><p>因为我很笨，我尝试的第一件事就是修改位置，看看我是否能在印度的任何地方获得信息。第二件事是将半径修改为100公里，看看我是否能够获得应用程序中没有的半径信息。正如你在前面的截图中看到的，我将我的位置设为新德里，并将半径设置为100公里，它起作用了！</p><p>后果是什么？多亏了这个端点，攻击者可以知道谁在印度的任何地方，在他选择的地区被感染。例如，我可以知道我的邻居是否生病了。听起来像是我的隐私问题，…。</p><p>所以我决定稍微玩一下，看看在半径500米的一些特定地方谁感染了病毒：-PMO办公室：{“感染”：0，“不适”：5，“蓝光阳性”：4，“成功”：TRUE，“Self Asses”：215，“usersNearBy”：1936}-国防部：{“感染”：0，“不适”：5，“蓝光阳性”：11，“Success”：TRUE，“(自述)：215，”usersNearBy“：1936}-国防部：{”感染“：0，”不适“：5，”BluetothPositive“：11，”成功“：TRUE，”“usersNearBy”：1375}-印度议会：{“感染”：1，“身体不适”：2，“BluToothPositive”：17，“Success”：true，“selfAsses”：225，“usersNearBy”：2338}--印度陆军司令部：{“感染”：0，“身体不适”：2，“BluetothPositive”：4，“Success”：TRUE，“selfAsses”：91，“usersNearBy”：1302}。</p><p>在我最初发推文49分钟后，NIC和印第安人证书联系了我。我给他们寄了一份小小的技术报告。</p><p>我对他们的回答是：-正如你在文章中看到的，完全可以使用与5个硬编码值不同的半径，所以很明显他们在这一点上撒谎，他们知道这一点。他们甚至承认现在的默认值是1公里，所以在我的报告之后，他们对生产进行了更改-有趣的是，他们还承认用户可以获得多个位置的数据。多亏了三角测量，攻击者可以用一米的精度获得某人的健康状况。-批量通话是可能的，我的朋友.。我花了一天时间给这个端点打电话，你也知道。</p><p>我很高兴他们很快回复了我的报告，并解决了一些问题，但我是认真的：停止撒谎，停止否认。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://medium.com/@fs0c131y/aarogya-setu-the-story-of-a-failure-3a190a18e34">https://medium.com/@fs0c131y/aarogya-setu-the-story-of-a-failure-3a190a18e34</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/漏洞/">#漏洞</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/联系人/">#联系人</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/应用程序/">#应用程序</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1000969.html"><img src="http://img.diglog.com/img/2020/5/thumb_e05bbb6c0ac01ea06d5c1dcee6169416.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1000969.html">Open Sourcing the Anvil App Server(开源Anvil应用服务器)</a></div><span class="my_story_list_date">2020-5-7 1:0</span></div><div class="col-sm"><div><a target="_blank" href="/story/1000933.html"><img src="http://img.diglog.com/img/2020/5/thumb_3097b7f7a832096f4e0f7bfcd6920c66.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1000933.html">苹果版权官司给安全研究造成“寒蝉效应”</a></div><span class="my_story_list_date">2020-5-6 21:18</span></div><div class="col-sm"><div><a target="_blank" href="/story/1000928.html"><img src="http://img.diglog.com/img/2020/5/thumb_aecb87e0aab9959ddebd2c071a792781.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1000928.html">是什么让开发人员保持快乐？为开放源码做出贡献</a></div><span class="my_story_list_date">2020-5-6 21:17</span></div><div class="col-sm"><div><a target="_blank" href="/story/1000896.html"><img src="http://img.diglog.com/img/2020/5/thumb_ad498587255ab0b74244c28c1f6312c4.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1000896.html">游戏开发：从零到App Store再到付费用户，作为一个副业。方式和原因</a></div><span class="my_story_list_date">2020-5-6 18:44</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>