<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ä¸ºæ‚¨çš„å®¶åº­å®éªŒå®¤å»ºç«‹ä¸€ä¸ªå¾®å°çš„è¯ä¹¦é¢å‘æœºæ„ </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">ä¸ºæ‚¨çš„å®¶åº­å®éªŒå®¤å»ºç«‹ä¸€ä¸ªå¾®å°çš„è¯ä¹¦é¢å‘æœºæ„ </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-24 21:40:02</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/429fcc7691cfbb0c11b59409c4534870.png"><img src="http://img2.diglog.com/img/2020/12/429fcc7691cfbb0c11b59409c4534870.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>TL; DRåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå°å‹çš„ç‹¬ç«‹åœ¨çº¿è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ï¼Œè¯¥è¯ä¹¦é¢å‘æœºæ„å°†ç”ŸæˆTLSè¯ä¹¦å¹¶ä½¿ç”¨YubiKeyè¿›è¡Œä¿æŠ¤ã€‚å®ƒå°†æ˜¯æˆ‘ä»¬æœ¬åœ°ç½‘ç»œä¸Šçš„å†…éƒ¨ACMEæœåŠ¡å™¨ï¼ˆACMEä¸Let's Encryptä½¿ç”¨çš„åè®®ç›¸åŒï¼‰ã€‚ YubiKeyå°†å®‰å…¨åœ°å­˜å‚¨CAç§é’¥å’Œç­¾åè¯ä¹¦ï¼Œä½œä¸ºç¡¬ä»¶å®‰å…¨æ¨¡å—ï¼ˆHSMï¼‰çš„å»‰ä»·æ›¿ä»£å“ã€‚æˆ‘ä»¬è¿˜å°†ä½¿ç”¨å¼€æºçš„True Random Number Generatorï¼ˆç§°ä¸ºæ— é™å™ªå£°TRNGï¼‰æ¥ä¸ºLinuxç†µæ± å¢å…‰æ·»å½©ã€‚</p><p>  ç”±äºç«¯åˆ°ç«¯TLSå¾ˆæ£’ï¼Œå› æ­¤æ‚¨åº”è¯¥å¯ä»¥è½»æ¾åœ°åœ¨éœ€è¦çš„ä»»ä½•åœ°æ–¹è¿è¡ŒTLSã€‚ç‰¹åˆ«æ˜¯åœ¨æ‚¨çš„å®¶åº­å®éªŒå®¤ä¸­ã€‚å†…éƒ¨ç½‘ç»œä¸å†è¢«è§†ä¸ºå¯ä»¥è¿›è¡ŒæœªåŠ å¯†æµé‡çš„å®‰å…¨åŒºåŸŸã€‚ä½†æ˜¯æ‚¨éœ€è¦è¯ä¹¦ã€‚</p><p> ç”±äºTLSå®¢æˆ·ç«¯èº«ä»½éªŒè¯åœ¨å„ç§æœåŠ¡ä¸­å¾—åˆ°è¶Šæ¥è¶Šå¹¿æ³›çš„æ”¯æŒï¼Œå¹¶ä¸”æ¯”å¯†ç è¦å¥½å¾—å¤šã€‚ä½†æ˜¯æ‚¨éœ€è¦è¯ä¹¦ã€‚</p><p> ç”±äºACMEåè®®ï¼ˆç”±Let's Encryptä½¿ç”¨ï¼‰å¯ä»¥è½»æ¾åœ°åœ¨å†…éƒ¨éƒ¨ç½²ï¼Œå› æ­¤æ‚¨å¯ä»¥è‡ªåŠ¨è¿›è¡Œç»­è®¢ï¼Œè€Œä¸å¿…è€ƒè™‘è¯ä¹¦ã€‚</p><p> å› ä¸ºä¹Ÿè®¸æ‚¨å·²ç»ç”¨OpenSSLå®Œæˆäº†â€œè‡ªç­¾åè¯ä¹¦â€æ“ä½œåå¤šæ¬¡ã€‚å¯èƒ½è¿˜è¦ä½¿äº‹æƒ…æ­£è§„åŒ–ï¼Œå¹¶ä½¿æ‚¨çš„è®¾å¤‡ä¿¡ä»»å¯ä»¥åœ¨ä»»ä½•éœ€è¦çš„åœ°æ–¹ä½¿ç”¨çš„CAã€‚</p><p>  æ”¯æŒCAç­¾åæ“ä½œçš„æ”¯æŒä¸ªäººèº«ä»½éªŒè¯ï¼ˆPIVï¼‰åº”ç”¨ç¨‹åºçš„ä»»ä½•YubiKeyã€‚æˆ‘ä½¿ç”¨çš„æ˜¯YubiKey 5 NFCã€‚</p><p>  USBæ‹‡æŒ‡é©±åŠ¨å™¨ï¼ˆæˆ–ç¬¬äºŒä¸ªYubiKeyï¼‰ï¼Œç”¨äºå­˜å‚¨æˆ‘ä»¬CAçš„è„±æœºå¤‡ä»½ </p><p>åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸Šï¼Œä½¿ç”¨Raspberry Pi Imagerå°†Ubuntu 20.10 Server 64ä½ARMé¢„å®‰è£…æœåŠ¡å™¨æ˜ åƒåˆ»å½•åˆ°microSDå¡ä¸Šã€‚</p><p> å¯åŠ¨Raspberry Piï¼Œå°†å…¶æ’å…¥ç½‘ç»œå¹¶æ‰¾åˆ°å…¶åˆå§‹IPåœ°å€ã€‚æ‚¨å¯ä»¥è¿è¡Œarp -na | grep -eï¼†ï¼ƒ34; b8ï¼š27ï¼šebï¼†ï¼ƒ34; -eï¼†ï¼ƒ34; dcï¼ša6ï¼š32ï¼†ï¼ƒ34; -eï¼†ï¼ƒ34ï¼š5fï¼š01ï¼†ï¼ƒ34;åœ¨æœ¬åœ°ç½‘ç»œä¸Šå‘ç°Raspberry Piè®¾å¤‡ã€‚</p><p>   ä½¿ç”¨timedatectl set-timezone America / Los_Angelesè®¾ç½®æ—¶åŒºï¼ˆæˆ–ä»»ä½•æ—¶åŒºï¼› timedatectl list-timezoneå°†åˆ—å‡ºæ‰€æœ‰æ—¶åŒºï¼‰</p><p> ç¡®ä¿NTPå·¥ä½œæ­£å¸¸ã€‚ä½¿ç”¨timedatectlæ£€æŸ¥çŠ¶æ€-ç¡®ä¿â€œ NTPæœåŠ¡â€ä¸ºâ€œæ´»åŠ¨â€ã€‚å¦‚æœæ²¡æœ‰ï¼Œæ‚¨å¯ä»¥å°†ä¸€äº›NTPæœåŠ¡å™¨æ·»åŠ åˆ°/etc/systemd/timesyncd.confå¹¶è¿è¡Œsystemctl restart systemd-timesyncdã€‚</p><p> æ‚¨éœ€è¦åœ¨è®¡ç®—æœºä¸Šä½¿ç”¨DNSåç§°ï¼ˆå¯¹æˆ‘æ¥è¯´æ˜¯tinyca.internalï¼‰å’Œ/æˆ–ç½‘ç»œä¸Šçš„é™æ€IPã€‚</p><p>   ç°åœ¨ï¼Œæ’å…¥æ‚¨çš„YubiKeyã€‚è®©æˆ‘ä»¬å®‰è£…yubico-piv-toolï¼Œå¹¶ç¡®ä¿æ‚¨å¯ä»¥è¿æ¥åˆ°YubiKeyï¼š</p><p> $ sudo apt-add-repository ppaï¼šyubico / stable $ sudo apt update $ sudo apt install -y yubico-piv-tool $ yubico-piv-tool --action =ï¼†ï¼ƒ34; statusï¼†ï¼ƒ34;ç‰ˆæœ¬ï¼š5.2.7ä¸²è¡Œæ•°å­—ï¼š... CHUIDï¼š3019 ..... 0fe00CCCï¼šæ— å¯ç”¨æ•°æ®PINå°è¯•å·¦ç§»ï¼š3 </p><p>$ cd $ curl -LO https://golang.org/dl/go1.15.6.linux-arm64.tar.gz$ sudo tar -C / usr / local -xzf go1.15.6.linux-arm64.tar.gz $ catï¼†lt;ï¼†lt; EOFï¼†gt;ï¼†gt; .profileï¼†gt;å¯¼å‡ºPATH = $ PATHï¼š/ usr / local / go / binï¼†gt; EOF $æº.profile $ goç‰ˆæœ¬goç‰ˆæœ¬go1.15.6 linux / arm64</p><p>  æ‚¨éœ€è¦åŒæ—¶å®‰è£…step-caï¼ˆCAæœåŠ¡å™¨è½¯ä»¶ï¼‰å’Œstepï¼ˆç”¨äºé…ç½®å’Œæ§åˆ¶step-caçš„å‘½ä»¤ï¼‰ã€‚</p><p>  $ curl -LO https://github.com/smallstep/certificates/archive/v0.15.5.tar.gz$ tar xvzf v0.15.5.tar.gz $ cd certificate-0.15.5 /ï¼ƒstep-caè¯´æ˜ä»æ­¤å¤„å¼€å§‹ï¼š$ sudo apt-get install -y libpcsclite-dev $ make bootstrap $ make build GOFLAGS =ï¼†ï¼ƒ34;ï¼†ï¼ƒ34; .... Build Completeï¼$ sudo cp bin / step-ca / usr / local / bin $ sudo setcap CAP_NET_BIND_SERVICE = + eip / usr / local / bin / step-ca $ step-ca versionSmallstep CA / 0.15.5ï¼ˆlinux / arm64ï¼‰å‘å¸ƒæ—¥æœŸï¼š2020-12-08 19:49 UTC</p><p>  $ curl -LO https://github.com/smallstep/cli/releases/download/v0.15.3/step_linux_0.15.3_arm64.tar.gz$ tar xvzf step_linux_0.15.3_arm64.tar.gz $ sudo cp step_0.15.3 / bin / step / usr / local / bin $æ­¥éª¤ç‰ˆæœ¬Smallstep CLI / 0.15.3ï¼ˆlinux / arm64ï¼‰å‘å¸ƒæ—¥æœŸï¼š2020-10-21 23:46 UTC</p><p>  æ— é™å™ªå£°TRNGæ˜¯ä¸€ç§å¼€æºUSBçœŸéšæœºæ•°å‘ç”Ÿå™¨ã€‚å®ƒä½¿ç”¨â€œæ¨¡å—åŒ–ç†µä¹˜æ³•å™¨â€æ¶æ„æ¥å¿«é€Ÿç”Ÿæˆå¤§é‡éšæœºæ•°æ®ã€‚å¯¹äºæ­¤è®¾ç½®ï¼Œå®ˆæŠ¤ç¨‹åºå°†é€šè¿‡å†™å…¥/ dev / randomæ¥å°†ç†µè¿ç»­åœ°é¦ˆå…¥Linuxçš„ç³»ç»Ÿç†µæ± ä¸­ã€‚</p><p> ä½†æ˜¯CAä¼šå®é™…ä½¿ç”¨è¿™ä¸ªå¯çˆ±çš„æ–°ç†µç”Ÿæˆå™¨å—ï¼Ÿæˆ‘éœ€è¦åœ¨è¿™é‡Œå›ç­”ä¸¤ä¸ªé—®é¢˜ï¼š</p><p> CAå¦‚ä½•ç”Ÿæˆéšæœºæ•°ï¼Ÿæˆ‘ä¸å¾—ä¸ä»”ç»†ç ”ç©¶ä¸€ä¸‹ä»¥ç¡®è®¤è¿™ä¸€ç‚¹ã€‚ step-caä½¿ç”¨Goçš„crypto / randç”Ÿæˆæ‰€æœ‰å¯†é’¥ï¼Œè€Œcyrpto / randä½¿ç”¨/ dev / urandomä½œä¸ºLinuxç³»ç»Ÿä¸Šçš„éšæœºæ•°æ®æºã€‚ </p><p>é€šè¿‡å†™å…¥/ dev / randomåˆ›å»ºçš„ç†µæ˜¯å¦å®é™…ä¸Šä¼šå½±å“ä»/ dev / urandomè¯»å–çš„å†…å®¹ï¼Ÿè¿™æ ·åšæ˜¯å› ä¸ºLinuxåªæœ‰ä¸€ä¸ªç†µæ± ï¼Œç”±/ dev / randomå’Œ/ dev / urandomå…±äº«ã€‚</p><p> æˆ‘ä»¬è¿˜éœ€è¦ç¡®è®¤èˆ·å¤–TRNGå®é™…ä¸Šæ­£åœ¨äº§ç”Ÿé«˜è´¨é‡çš„å™ªå£°ã€‚æˆ‘ä»¬å°†åœ¨ä¸€åˆ†é’Ÿå†…å®Œæˆã€‚</p><p> æ‚¨éœ€è¦ä»æºä»£ç ç¼–è¯‘é©±åŠ¨ç¨‹åºï¼Œå› ä¸ºæ²¡æœ‰å¯ç”¨çš„é¢„æ„å»ºarm64è½¯ä»¶åŒ…ã€‚</p><p> $ curl -LO https://github.com/13-37-org/infnoise/archive/0.3.1.tar.gz$ tar xvzf 0.3.1.tar.gz $ cd infnoise-0.3.1 / $ sudo apt -get install -y libftdi-dev libusb-dev $ make -f Makefile.linux $ sudo make -f Makefile.linux installinstall -d / usr / local / sbininstall -m 0755 infnoise / usr / local / sbin / install -d / usr / local / lib / udev / rules.d / install -m 0644 init_scripts / 75-infnoise.rules /usr/local/lib/udev/rules.d/install -d / usr / local / lib / systemd / systeminstall- m 0644 init_scripts / infnoise.service / usr / local / lib / systemd / system</p><p>   é‡æ–°å¯åŠ¨åï¼Œæ‚¨åº”è¯¥çœ‹åˆ°é©±åŠ¨ç¨‹åºå·²å¯åŠ¨ã€‚å®ƒä¼šæ ¹æ®æ˜¯å¦å­˜åœ¨TRNGæ¥å¯åŠ¨å’Œåœæ­¢ã€‚</p><p> $ systemctl status infnoiseâ—infnoise.service-Wayward Geek InfNoise TRNGé©±åŠ¨ç¨‹åºå·²åŠ è½½ï¼šå·²åŠ è½½ï¼ˆ/usr/local/lib/systemd/system/infnoise.serviceï¼›å·²ç¦ç”¨ï¼›ä¾›åº”å•†é¢„è®¾ï¼šå·²å¯ç”¨ï¼‰æ´»åŠ¨ï¼šè‡ª2020å¹´2æœˆä»¥æ¥å¤„äºæ´»åŠ¨çŠ¶æ€12-08 12:52:51 PST; 2åˆ†é’Ÿ0ä¹‹å‰è¿›ç¨‹ï¼š1652 ExecStart = / usr / local / sbin / infnoise --dev-random --daemon --pidfile /var/run/infnoise.pidï¼ˆä»£ç =å·²é€€å‡ºï¼Œstatus = 0ï¼†gt;ä¸»PIDï¼š1657ï¼ˆinfnoise ï¼‰ä»»åŠ¡ï¼š1ï¼ˆé™åˆ¶ï¼š2099ï¼‰CGroupï¼š/system.slice/infnoise.serviceâ””â”€1657/ usr / local / sbin / infnoise --dev-random --daemon --pidfile /var/run/infnoise.pidDec 08 12:52:51 tinyca systemd [1]ï¼šå¯åŠ¨Wayward Geek InfNoise TRNGé©±åŠ¨ç¨‹åº...åäºŒæœˆ08 12:52:51 tinyca systemd [1]ï¼šå¯åŠ¨Wayward Geek InfNoise TRNGé©±åŠ¨ç¨‹åºã€‚</p><p> æœ€åï¼Œè®©æˆ‘ä»¬è¿›è¡Œè¿è¡ŒçŠ¶å†µæ£€æŸ¥ï¼Œä»¥ç¡®ä¿å¯ä»¥ä½¿ç”¨TRNGï¼š </p><p>$ infnoise --debug --no-outputç”Ÿæˆ1048576ä½ã€‚ **å¯ä»¥ä½¿ç”¨æ•°æ®ã€‚**ä¼°è®¡çš„æ¯ä½ç†µï¼š0.877159ï¼Œä¼°è®¡çš„Kï¼š1.836755num1sï¼š50.514668ï¼…ï¼Œå¶æ•°å¤±ç«ï¼š0.111168ï¼…ï¼Œå¥‡æ•°å¤±ç«ï¼š0.152342ï¼…^ C</p><p> æ¯ç§’infnoise.serviceå°†ç†µå†™å…¥/ dev / randomã€‚ä¸€åˆ‡éƒ½å–å†³äºéšæœºæ€§ï¼ç°åœ¨ï¼Œæ‚¨å·²ç»æ‹¥æœ‰äº†è¶³å¤Ÿå¤šçš„ç†µï¼Œç°åœ¨å¯ä»¥ç”ŸæˆCAå¯†é’¥äº†ã€‚</p><p>  ç°åœ¨ï¼Œæ‚¨å°†åˆ›å»ºæ ¹CAè¯ä¹¦å’Œä¸­é—´CAè¯ä¹¦å’Œå¯†é’¥ï¼Œå¹¶å°†å®ƒä»¬å®‰å…¨åœ°å­˜å‚¨åœ¨YubiKeyä¸Šã€‚</p><p> ç†æƒ³æƒ…å†µä¸‹ï¼Œæ­¤éƒ¨åˆ†åº”ä½¿æ‚¨çš„Raspberry Piä¿æŒè„±æœºçŠ¶æ€ã€‚æ–­å¼€ä»¥å¤ªç½‘ç”µç¼†ï¼Œç„¶åé€šè¿‡HDMIå’Œé”®ç›˜ç›´æ¥è¿æ¥åˆ°è®¾å¤‡ã€‚</p><p>  æ‚¨ä¸èƒ½ä»…è®©CAç§é’¥ä»…å­˜åœ¨äºYubiKeyä¸Šã€‚ä¸‡ä¸€YubiKeyåäº†ï¼Œæ‚¨è‡³å°‘è¦å¤‡ä»½ä¸€ä»½ï¼</p><p> æ’å…¥USBæ‹‡æŒ‡é©±åŠ¨å™¨ã€‚æ‚¨å°†ç›´æ¥åœ¨æ­¤é©±åŠ¨å™¨ä¸Šç”Ÿæˆå¯†é’¥ï¼Œè¿™æ ·å®ƒä»¬å°±æ°¸è¿œä¸ä¼šç¢°åˆ°Piçš„microSDå¡ã€‚é¦–å…ˆï¼Œæ‰¾åˆ°æ‚¨çš„USBé©±åŠ¨å™¨çš„è®¾å¤‡åç§°ï¼š</p><p> $ sudo fdisk -l ...ç£ç›˜/ dev / sdaï¼š14.91 GiBï¼Œ16005464064å­—èŠ‚ï¼Œ31260672æ‰‡åŒºç£ç›˜æ¨¡å‹ï¼šCruzer FitUnitsï¼š1 * 512 = 512å­—èŠ‚çš„æ‰‡åŒºæ‰‡åŒºå¤§å°ï¼ˆé€»è¾‘/ç‰©ç†ï¼‰ï¼š512å­—èŠ‚/ 512å­—èŠ‚... </p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé©±åŠ¨å™¨ä¸º/ dev / sdaã€‚è®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªext4åˆ†åŒºå¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ï¼š</p><p> $ sudo fdisk / dev / sdaæ¬¢è¿ä½¿ç”¨fdiskï¼ˆutil-linux 2.36ï¼‰ã€‚æ›´æ”¹å°†ä»…ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°æ‚¨å†³å®šå°†å…¶å†™å…¥ä¸ºæ­¢ã€‚åœ¨ä½¿ç”¨writeå‘½ä»¤ä¹‹å‰è¯·å°å¿ƒã€‚å‘½ä»¤ï¼ˆmå¯»æ±‚å¸®åŠ©ï¼‰ï¼šnPartitionç±»å‹p primaryï¼ˆ 0ä¸ªä¸»è¦ï¼Œ0ä¸ªæ‰©å±•ï¼Œ4ä¸ªå…è´¹ï¼‰eæ‰©å±•ï¼ˆé€»è¾‘åˆ†åŒºçš„å®¹å™¨ï¼‰é€‰æ‹©ï¼ˆé»˜è®¤pï¼‰ï¼špåˆ†åŒºå·ï¼ˆ1-4ï¼Œé»˜è®¤1ï¼‰ï¼šç¬¬ä¸€ä¸ªæ‰‡åŒºï¼ˆ2048-31260671ï¼Œé»˜è®¤2048ï¼‰ï¼šæœ€åä¸€ä¸ªæ‰‡åŒºï¼Œ+ / -sectorsæˆ–+/- size {Kï¼ŒMï¼ŒGï¼ŒTï¼ŒP}ï¼ˆ2048-31260671ï¼Œé»˜è®¤å€¼ä¸º31260671ï¼‰ï¼šåˆ›å»ºäº†ç±»å‹ä¸ºï¼†ï¼ƒ39; Linuxï¼†ï¼ƒ39;çš„æ–°åˆ†åŒº1ã€‚å¤§å°ä¸º14.9 GiB.Commandï¼ˆmä¸ºå¸®åŠ©ï¼‰ï¼šwåˆ†åŒºè¡¨å·²æ›´æ”¹ã€‚è°ƒç”¨ioctlï¼ˆï¼‰é‡æ–°è¯»å–åˆ†åŒºè¡¨ã€‚åŒæ­¥ç£ç›˜ã€‚$ sudo mkfs.ext4 / dev / sda1 -vmke2fs 1.45.6ï¼ˆ20 -2020å¹´3æœˆï¼‰ç”¨äºmke2fs.confçš„fs_typesè§£æåº¦ï¼šï¼†ï¼ƒ39; ext4ï¼†ï¼ƒ39;æ–‡ä»¶ç³»ç»Ÿæ ‡ç­¾=æ“ä½œç³»ç»Ÿç±»å‹ï¼šLinux ...åˆ›å»ºæ—¥å¿—ï¼ˆ16384å—ï¼‰ï¼šdoneç¼–å†™è¶…çº§å—å’Œæ–‡ä»¶ç³»ç»Ÿè®°å¸ä¿¡æ¯ï¼šdone $ sudo mount / dev / sda1 / mnt</p><p>  å¤ªå¥½äº†ï¼Œç°åœ¨æ‚¨å¯ä»¥åˆ›å»ºæ‚¨çš„å…¬é’¥åŸºç¡€ç»“æ„ï¼ˆPKIï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œæ‚¨å°†åˆ›å»ºCAå¯†é’¥å’Œè¯ä¹¦ã€‚</p><p> Tiny CAå…·æœ‰æ ¹CAå¯†é’¥å’Œè¯ä¹¦ï¼Œä»¥åŠä¸­é—´CAå¯†é’¥å’Œè¯ä¹¦ã€‚</p><p>    é»˜è®¤æƒ…å†µä¸‹ï¼Œstep-caé¢å‘å…·æœ‰24å°æ—¶å¯¿å‘½çš„è¯ä¹¦ã€‚æˆ‘å¸Œæœ›æ­¤é»˜è®¤è®¾ç½®å°†è¿«ä½¿æ‚¨åœ¨å®¢æˆ·ç«¯ä¸Šè®¾ç½®è‡ªåŠ¨ç»­è®¢ã€‚å¦‚æœæ‚¨å¸Œæœ›æ›´è½»æ¾ä¸€äº›ï¼Œå¯ä»¥éšæ—¶åœ¨CAé…ç½®ä¸­å¢åŠ TLSè¯ä¹¦çš„æŒç»­æ—¶é—´ã€‚</p><p> å¦‚æœè®¾å¤‡é…ç½®ä¸ºä¿¡ä»»æ‚¨çš„æ ¹CAï¼Œå®ƒå°†ä¿¡ä»»æ‚¨ä½¿ç”¨step-caåˆ›å»ºçš„è¯ä¹¦ã€‚</p><p>  éœ€è¦X.509è¯ä¹¦å¤ä¹ å—ï¼Ÿè¯·å‚é˜…æˆ‘ä»¬çš„å¸–å­ï¼Œæœ‰å…³è¯ä¹¦å’ŒPKIçš„æ‰€æœ‰çŸ¥è¯†ï¼Œä½†åˆå®³æ€•é—®ã€‚ </p><p>å‡ºç°æç¤ºæ—¶ï¼Œè¯·ä½¿ç”¨å¼ºå¯†ç ï¼Œå¹¶ç¦»çº¿ä¿å­˜å¯†ç ï¼Œè¶…çº§å®‰å…¨ã€‚</p><p> $ cd / mnt $ sudo mkdir ca $ sudo chown ubuntuï¼šubuntu ca $ export STEPPATH = / mnt / ca $ step ca init --pki --name =ï¼†ï¼ƒ34; Tinyï¼†ï¼ƒ34;âœ”æ‚¨æƒ³è¾“å…¥ä»€ä¹ˆå¯†ç æ˜¯ï¼Ÿ [ç•™ç©ºï¼Œæˆ‘ä»¬å°†ç”Ÿæˆä¸€ä¸ª]ï¼š...æ­£åœ¨ç”Ÿæˆæ ¹è¯ä¹¦...å·²å®Œæˆï¼æ­£åœ¨ç”Ÿæˆä¸­é—´è¯ä¹¦...å·²å®Œæˆï¼âœ”æ ¹è¯ä¹¦ï¼š/mnt/ca/certs/root_ca.crtâœ”æ ¹ç§é’¥ï¼š/ mnt / ca /â€‹â€‹ secrets /root_ca_keyâœ”æ ¹æŒ‡çº¹ï¼šd6b3b9ef79a42aeeabcd5580b2b516458ddb25d1af4ea7ff0845e624ec1bb609âœ”ä¸­çº§è¯ä¹¦ï¼š/mnt/ca/certs/intermediate_ca.crtâœ”ä¸­çº§ç§ç”¨å¯†é’¥/ ret /ret_secğŸ˜/ BACKæ£€æµ‹ä½¿ç”¨æƒ…å†µç»Ÿè®¡ä¿¡æ¯ã€‚å®ƒä¸ç»™å®¶æ‰“ç”µè¯ã€‚ä½†æ˜¯æ‚¨çš„åé¦ˆæ„è§éå¸¸å®è´µã€‚æ‚¨å¯ä»¥æä¾›çš„æœ‰å…³æ‚¨å¦‚ä½•ä½¿ç”¨â€œæ­¥éª¤â€çš„ä»»ä½•ä¿¡æ¯éƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚è¯·ç»™æˆ‘ä»¬å‘é€ä¸€ä¸¤ä¸ªå¥å­ï¼Œæ— è®ºå¥½åï¼šfeedback@smallstep.comæˆ–åŠ å…¥https://github.com/smallstep/certificates/discussionsã€‚</p><p> åˆ«å¿˜äº†ç»™æ‚¨çš„CAå–ä¸ªå¯çˆ±çš„åå­—ï¼å®ƒä¼šå‡ºç°åœ¨æ‚¨æ‰€æœ‰çš„è¯ä¹¦ä¸Šã€‚è¿˜è¦æŠ“ç´§æ‚¨çš„æ ¹æŒ‡çº¹ï¼›æ‚¨å°†éœ€è¦å®ƒæ¥ç¨åå¼•å¯¼æ‚¨çš„å®¢æˆ·ã€‚</p><p>   $ yubico-piv-tool --action =ï¼†ï¼ƒ34; import-certificateï¼†ï¼ƒ34; --slot =ï¼†ï¼ƒ34; 9aï¼†ï¼ƒ34; --touch-policy =ï¼†neverï¼†ï¼ƒ34; ï¼†lt; /mnt/ca/certs/root_ca.crtæˆåŠŸå¯¼å…¥äº†æ–°è¯ä¹¦ã€‚$ yubico-piv-tool --action =ï¼†ï¼ƒ34; import-keyï¼†ï¼ƒ34; --slot =ï¼†ï¼ƒ34; 9aï¼†ï¼ƒ34; --touch-policy =ï¼†neverï¼†ï¼ƒ34; ï¼†lt; / mnt / ca /â€‹â€‹ secrets / root_ca_keyè¾“å…¥PEMå¯†ç ï¼š...å·²æˆåŠŸå¯¼å…¥æ–°çš„ç§é’¥ã€‚$ yubico-piv-tool --action =ï¼†ï¼ƒ34; import-certificateï¼†ï¼ƒ34; --slot =ï¼†ï¼ƒ34; 9cï¼†ï¼ƒ34; --touch-policy =ï¼†neverï¼†ï¼ƒ34; ï¼†lt; /mnt/ca/certs/intermediate_ca.crtæˆåŠŸå¯¼å…¥äº†æ–°è¯ä¹¦ã€‚$ yubico-piv-tool --action =ï¼†ï¼ƒ34; import-keyï¼†ï¼ƒ34; --slot =ï¼†ï¼ƒ34; 9cï¼†ï¼ƒ34; --touch-policy =ï¼†neverï¼†ï¼ƒ34; ï¼†lt; / mnt / ca /â€‹â€‹ secrets / intermediate_ca_keyè¾“å…¥PEMå¯†ç ï¼š...å·²æˆåŠŸå¯¼å…¥æ–°çš„ç§é’¥ã€‚ ï¼šæ²¡æœ‰å¯ç”¨æ•°æ®æ§½ä½9aï¼šç®—æ³•ï¼šECCP256ä¸»é¢˜DNï¼šCN =å¾®å°çš„æ ¹CAé¢å‘è€…DNï¼šCN =å¾®å°çš„æ ¹CAæŒ‡çº¹ï¼šd6b3b9ef79a42aeeabcd5580b2b516458ddb25d1af4ea7ff0845e624ec1bb609ä¸æ—©äºï¼šDec 8 20:12:15 2020 GMT Not Afterï¼š 2030 GMTSlot 9cï¼šç®—æ³•ï¼šECCP256ä¸»é¢˜DNï¼šCN =å¾®å°çš„ä¸­çº§CAé¢å‘è€…DNï¼šCN =å¾®å°çš„æ ¹CAæŒ‡çº¹ï¼šfa21279c114ef44be899cb41e830b920faa6ce2c0ec5bc4f1c9310194e5837d2ä¸æ—©äºï¼šDec 8 20:12:15 2020 GMT Not Afterå‘å·¦å°è¯•ï¼š3</p><p> å¥½ï¼ç°åœ¨ï¼Œæ‚¨å°†å¤åˆ¶CAè¯ä¹¦æ–‡ä»¶ï¼Œå°†ç§é’¥ç•™åœ¨USBè®°å¿†æ£’ä¸Šï¼Œç„¶åç»§ç»­åˆ›å»ºCAã€‚</p><p>    æ‚¨ç°åœ¨è¦é‡æ–°è¿è¡Œæ­¥éª¤ca initï¼Œä½†æ˜¯æ‚¨å°†ä¸ä½¿ç”¨å®ƒç”Ÿæˆçš„è¯ä¹¦æˆ–å¯†é’¥ã€‚è¿™æ ·åšåªæ˜¯ä¸ºäº†åˆ›å»ºé…ç½®æ–‡ä»¶ã€‚åœ¨å‡ºç°æç¤ºæ—¶é€‰æ‹©çš„å¯†ç å°†æ˜¯ç®¡ç†å‘˜æä¾›è€…å¯†ç ã€‚æ‹¥æœ‰è¯¥å¯†ç çš„ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨step ca certificateå­å‘½ä»¤ä»æ‚¨çš„CAè·å–ä»»ä½•è¯ä¹¦ã€‚</p><p> ä¸è¦å°†æ‚¨çš„æ ¹CAå¯†ç ç”¨äºé…ç½®è€…ï¼Œè€Œè¦é€‰æ‹©åšå›ºçš„ä¸œè¥¿å¹¶å°†å…¶å­˜å‚¨åœ¨å®‰å…¨çš„åœ°æ–¹ã€‚ </p><p>$ sudo useradd step $ sudo passwd -l step $ sudo mkdir / etc / step-ca $ export STEPPATH = / etc / step-ca $ sudo --preserve-env step ca init --name =ï¼†ï¼ƒ34; Tiny CAï¼†ï¼ƒ 34; \ --dns =ï¼†ï¼ƒ34; tinyca.internalï¼Œ10.20.30.42ï¼†ï¼ƒ34; --address =ï¼†ï¼ƒ34;ï¼š443ï¼†ï¼ƒ34; \ --provisioner =ï¼†ï¼ƒ34; you@example.com&#34;âœ”æ‚¨å¸Œæœ›å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ [ç•™ç©ºï¼Œæˆ‘ä»¬å°†ç”Ÿæˆä¸€ä¸ª]ï¼šæ­£åœ¨ç”Ÿæˆæ ¹è¯ä¹¦...å·²å®Œæˆï¼æ­£åœ¨ç”Ÿæˆä¸­é—´è¯ä¹¦...å·²å®Œæˆï¼âœ”æ ¹è¯ä¹¦ï¼š/etc/step-ca/certs/root_ca.crtâœ”æ ¹ç§æœ‰å¯†é’¥ï¼š/ etc / step-ca / secrets /root_ca_keyâœ”æ ¹æŒ‡çº¹ï¼šd52aa8dc57114fb28aafe0a4fa2795d3afeâ€‹â€‹eb3a024bf6e6291077d99ff0cebc6âœ”ä¸­çº§è¯ä¹¦ï¼š/ etc / step-ca / certs / intermediate_caã€‚æ–‡ä»¶å¤¹ï¼š/ etc / step-ca /dbâœ”é»˜è®¤é…ç½®ï¼š/etc/step-ca/config/defaults.jsonâœ”è¯ä¹¦é¢å‘æœºæ„é…ç½®ï¼š/etc/step-ca/config/ca.jsonæ‚¨çš„PKIå·²å‡†å¤‡å°±ç»ªã€‚è¦ä¸ºå•ä¸ªæœåŠ¡ç”Ÿæˆè¯ä¹¦ï¼Œè¯·å‚è§â€œæ­¥éª¤å¸®åŠ©ca..FEEDBACKâ€ã€‚æ­¥éª¤å®ç”¨ç¨‹åºæœªå®‰è£…ä½¿ç”¨æƒ…å†µç»Ÿè®¡ä¿¡æ¯ã€‚å®ƒä¸ç»™å®¶æ‰“ç”µè¯ã€‚ä½†æ˜¯æ‚¨çš„åé¦ˆæ„è§éå¸¸å®è´µã€‚æ‚¨å¯ä»¥æä¾›çš„æœ‰å…³æ‚¨å¦‚ä½•ä½¿ç”¨â€œæ­¥éª¤â€çš„ä»»ä½•ä¿¡æ¯éƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚è¯·ç»™æˆ‘ä»¬å‘é€ä¸€ä¸¤ä¸ªå¥å­ï¼Œæ— è®ºå¥½åï¼šfeedback@smallstep.comæˆ–åŠ å…¥https://github.com/smallstep/certificates/discussionsã€‚</p><p> ç°åœ¨ï¼Œæ‚¨å°†æ·»åŠ ä¸€ä¸ªACMEé…ç½®å™¨ï¼Œå®ƒå°†æ‚¨çš„Tiny CAå˜æˆä¸€ä¸ªå¾ˆå°çš„Let's Encryptã€‚</p><p> $ step ca Provisioneræ·»åŠ acme --type acmeæˆåŠŸï¼æ‚¨çš„`step-ca`é…ç½®å·²æ›´æ–°ã€‚ä¸ºäº†è·å¾—æ–°çš„é…ç½®SIGHUPï¼ˆkill -1ï¼†lt; pidï¼†gt;ï¼‰æˆ–é‡æ–°å¼€å§‹step-caè¿‡ç¨‹ã€‚</p><p>   æœ€åï¼Œæ‚¨éœ€è¦ä½¿ç”¨YubiKeyä¸Šçš„ä¸­é—´é”®ï¼Œå°†step-caé…ç½®ä¸ºä½¿ç”¨YubiKeyç­¾ç½²è¯ä¹¦ã€‚è¯·æ³¨æ„ï¼Œæ­¤å¤„ä¹Ÿæ˜¾ç¤ºäº†é»˜è®¤çš„YubiKey PINï¼ˆ123456ï¼‰ã€‚ç¼–è¾‘æ–‡ä»¶/etc/step-ca/config/ca.jsonã€‚æ‚¨å¸Œæœ›æ–‡ä»¶çš„é¡¶éƒ¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><p> {ï¼†ï¼ƒ34; rootï¼†ï¼ƒ34 ;:ï¼†ï¼ƒ34; /etc/step-ca/certs/root_ca.crt&#34 ;,ï¼†ï¼ƒ34; federatedRootsï¼†ï¼ƒ34 ;: []ï¼Œï¼†ï¼ƒ34; crtï¼†ï¼ƒ34; ï¼šï¼†ï¼ƒ34; /etc/step-ca/certs/intermediate_ca.crt&#34 ;ï¼Œï¼†ï¼ƒ34; keyï¼†ï¼ƒ34 ;ï¼šï¼†ï¼ƒ34; yubikeyï¼šslot-id = 9cï¼†ï¼ƒ34 ;,ï¼†ï¼ƒ34; kmsï¼† ï¼ƒ34 ;: {ï¼†ï¼ƒ34; typeï¼†ï¼ƒ34 ;:ï¼†ï¼ƒ34; yubikeyï¼†ï¼ƒ34 ;,ï¼†ï¼ƒ34; pinï¼†ï¼ƒ34 ;:ï¼†ï¼ƒ34; 123456ï¼†ï¼ƒ34; }ï¼Œï¼†ï¼ƒ34; addressï¼†ï¼ƒ34 ;:ï¼†ï¼ƒ34;ï¼š443ï¼†ï¼ƒ34 ;, ...</p><p> ç°åœ¨ï¼Œæ‚¨å°†å¯åŠ¨CAå¹¶ç¡®ä¿å…¶æ­£å¸¸è¿è¡Œï¼š</p><p> $ sudo chown -R stepï¼šstep / etc / step-ca $ sudo -u step step-ca /etc/step-ca/config/ca.json2020/12/08 14:17:06åœ¨ï¼š443ä¸Šæä¾›HTTPS .. ã€‚ </p><p>åœ¨è¿™é‡Œï¼Œæ‚¨éœ€è¦ä½¿ç”¨åˆå§‹å¯†é’¥é›†åˆ›å»ºçš„CAæŒ‡çº¹ï¼š</p><p> $ step ca bootstrap --ca-url =ï¼†ï¼ƒ34; httpsï¼š//tinyca.internal&#34; --fingerprint d6b3b9ef79a42aeeabcd5580b2b516458ddb25d1af4ea7ff0845e624ec1bb609æ ¹è¯ä¹¦å·²ä¿å­˜åœ¨/home/ubuntu/.step/certs/root_ca.crtä¸­ï¼Œæ‚¨çš„é…ç½®å·²ä¿å­˜åœ¨/home/ubuntu/.step/config/defaults.jsonæ­¥éª¤ä¸­ã€‚ 34; localhostï¼†ï¼ƒ34; localhost.crtlocalhost.keyâœ”æä¾›è€…ï¼šcarl@smallstep.comï¼ˆJWKï¼‰[å­©å­ï¼šKn16nM7lnKBIsUSB-jd5wJDPgRsxzYsvilWTK4Rm2b0]âœ”è¯·è¾“å…¥å¯†ç ä»¥è§£å¯†æä¾›è€…å¯†é’¥ï¼šâœ”CAï¼šhttpsï¼š//tinyca.internalï¼š443âœ”è¯ä¹¦ï¼š localhost.crtâœ”ç§é’¥ï¼šlocalhost.key $æ­¥éª¤è¯ä¹¦æ£€æŸ¥localhost.crt --shortX.509v3 TLSè¯ä¹¦ï¼ˆECDSA P-256ï¼‰[åºåˆ—å·ï¼š2949 ... 3005]ä¸»é¢˜ï¼šlocalhostå‘è¡Œè€…ï¼šTiny Intermediate CA Provisionerï¼šcarl @ smallstep.com [IDï¼šKn16 ... m2b0]æœ‰æ•ˆæœŸä»ï¼š2020-12-08T22ï¼š18ï¼š34Zåˆ°ï¼š2020-12-09T22ï¼š19ï¼š34Z</p><p> å¤§ï¼æ‚¨åˆšåˆšä½¿ç”¨YubiKeyå’Œstep-caç­¾ç½²äº†æ‚¨çš„ç¬¬ä¸€ä¸ªX.509 TLSå¶å­è¯ä¹¦ã€‚</p><p> å½“æ‚¨è¦æ±‚CAä¸ºTLSç«¯ç‚¹é¢å‘å¶è¯ä¹¦æ—¶ï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªè¯ä¹¦æ–‡ä»¶å’Œä¸€ä¸ªå…³è”çš„ç§é’¥æ–‡ä»¶ã€‚è¯ä¹¦æ–‡ä»¶å°†åŒæ—¶åŒ…å«ä¸­é—´CAè¯ä¹¦å’Œæ‚¨è¯·æ±‚çš„å¶è¯ä¹¦ã€‚è¿™æ ·ï¼Œä¿¡ä»»æ‚¨çš„æ ¹CAçš„è®¾å¤‡å°±å¯ä»¥éªŒè¯ä»æ ¹åˆ°ä¸­é—´ä»¥åŠä»ä¸­é—´åˆ°å¶çš„ä¿¡ä»»é“¾ã€‚</p><p>  åœ¨æœ¬éƒ¨åˆ†ä¸­ï¼Œæ‚¨å°†ä¸ºstep-caè®¾ç½®systemdæœåŠ¡ï¼Œä»¥ä¾¿åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨ã€‚</p><p> æ‚¨è¿˜å°†é…ç½®systemdä»¥åœ¨åˆ é™¤YubiKeyæ—¶åœæ­¢CAï¼Œå¹¶åœ¨é‡æ–°æ’å…¥YubiKeyæ—¶é‡æ–°å¯åŠ¨å®ƒã€‚</p><p> é¦–å…ˆï¼Œæ‚¨éœ€è¦é€šè¿‡æ·»åŠ ä¸€äº›udevè§„åˆ™æ¥å‘Šè¯‰udevæœ‰å…³æ‚¨çš„YubiKeyçš„çŸ¥è¯†ï¼Œè¿™å°†æœ‰åŠ©äºä½¿YubiKeyä½œä¸ºè®¾å¤‡åœ¨systemdä¸­å¯è§ã€‚ </p><p>$ sudo tee /etc/udev/rules.d/75-yubikey.rulesï¼†gt; / dev / nullï¼†lt;ï¼†lt; EOFACTION ==ï¼†ï¼ƒ34; addï¼†ï¼ƒ34;ï¼ŒSUBSYSTEM ==ï¼†ï¼ƒ34; usbï¼†ï¼ƒ34;ï¼ŒENV {PRODUCT} ==ï¼†ï¼ƒ34; 1050/407 / *ï¼†ï¼ƒ34;ï¼ŒTAG + =ï¼†ï¼ƒ34; systemdï¼†ï¼ƒ34;ï¼ŒSYMLINK + =ï¼†ï¼ƒ34; yubikeyï¼†ï¼ƒ34; ACTION ==ï¼†ï¼ƒ34;åˆ é™¤ï¼†ï¼ƒ34;ï¼ŒSUBSYSTEM ==ï¼†ï¼ƒ34; usbï¼†ï¼ƒ34;ï¼ŒENV {PRODUCT} ==ï¼†ï¼ƒ34; 1050 / 407 / *ï¼†ï¼ƒ34;ï¼ŒTAG + =ï¼†ï¼ƒ34; systemdï¼†ï¼ƒ34; EOF $ sudo udevadmæ§ä»¶-é‡æ–°åŠ è½½è§„åˆ™</p><p> åœ¨æ­¤ï¼ŒENV {PRODUCT}å€¼çš„æ ¼å¼ä¸º{vendorId} / {productId} / *ã€‚ Yubicoçš„ä¾›åº”å•†IDä¸º1050ï¼Œè€Œ407æ˜¯YubiKey 5 NFCçš„äº§å“IDã€‚å¦‚æœæ‚¨ä½¿ç”¨å…¶ä»–çš„YubiKeyï¼Œåˆ™å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°æ‚¨çš„å‹å·ã€‚</p><p>   $ sudo tee /etc/systemd/system/step-ca.serviceï¼†gt; / dev / nullï¼†lt;ï¼†lt; EOF [å•ä½]è¯´æ˜= step-caBindsTo = dev-yubikey.deviceAfter = dev-yubikey.device [æœåŠ¡]ç”¨æˆ·= stepGroup = stepExecStart = / bin / sh -cï¼†ï¼ƒ39; / usr / local / bin / step-ca /etc/step-ca/config/ca.json&#39;Type=simpleRestart=on-failureRestartSec=10[Install]WantedBy=multi-user.targetEOF$ sudo mkdir /etc/systemd/system/dev-yubikey.deviceã€‚æƒ³è¦$ sudo ln -s /etc/systemd/system/step-ca.service /etc/systemd/system/dev-yubikey.device.wants/$ sudo systemctl daemon-reload $ sudo systemctlå¯ç”¨step-ca</p><p>  $ sudo systemctl status step-caâ—step-ca.service-step-caå·²åŠ è½½ï¼šå·²åŠ è½½ï¼ˆ/etc/systemd/system/step-ca.serviceï¼›å·²å¯ç”¨ï¼›ä¾›åº”å•†é¢„è®¾ï¼šå·²å¯ç”¨ï¼‰æ´»åŠ¨ï¼šè‡ª2020å¹´æ˜ŸæœŸäºŒèµ·å¤„äºæ´»åŠ¨ï¼ˆè¿è¡Œï¼‰çŠ¶æ€-12-08 14:27:02 PST; 3ç§’é’Ÿå‰ä¸»PIDï¼š3269ï¼ˆshï¼‰ä»»åŠ¡ï¼š9ï¼ˆé™åˆ¶ï¼š2099ï¼‰CGroupï¼š/system.slice/step-ca.serviceâ”œâ”€3269/ bin / sh -c / usr / local / bin / step-ca / etc /step-ca/config/ca.jsonâ””â”€3270/ usr / local / bin / step-ca /etc/step-ca/config/ca.jsonDec 08 14:27:02 tinyca systemd [1]ï¼šå¼€å§‹äº†step- ca.Dec 08 14:27:02 tinyca sh [3270]ï¼š2020/12/08 14:27:02åœ¨ï¼š443ä¸Šæä¾›HTTPSæœåŠ¡...</p><p>     å®Œå…¨æ²¡æœ‰ä»»ä½•SSHè®¿é—®æƒé™ï¼Œæ‚¨çš„å°å‹CAå°†æ˜¯æœ€å®‰å…¨çš„ã€‚å¯¹äºCAï¼Œå”¯ä¸€çš„å¼€æ”¾ç«¯å£å°†æ˜¯443ã€‚ä¸ºäº†è¿›è¡Œç»´æŠ¤ï¼Œæ‚¨éœ€è¦æ’å…¥é”®ç›˜å’Œæ˜¾ç¤ºå™¨ã€‚</p><p> $ sudo tee /etc/ufw/applications.d/step-ca-serverï¼†gt; / dev / nullï¼†lt;ï¼†lt; EOF [step-ca] title =å°æ­¥éª¤CAdescription = step-caæ˜¯åœ¨çº¿X.509ï¼ŒSSHè¯ä¹¦é¢å‘æœºæ„ç«¯å£= 443 / tcp $ sudo ufwå…è®¸step-ca $ sudo ufw enableCommandå¯èƒ½ä¼šç ´åç°æœ‰çš„sshè¿æ¥ã€‚è¿›è¡Œè¿ç®—ï¼ˆy | nï¼‰ï¼Ÿ yFirewallåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å¤„äºæ´»åŠ¨çŠ¶æ€å¹¶å·²å¯ç”¨</p><p>    åœ¨æ–°è®¾å¤‡ä¸Šè¿è¡Œæ­¥éª¤ca bootstrapæ—¶ï¼ˆå¦‚ä¸Šï¼‰ï¼Œå°†ä»CAä¸‹è½½æ ¹è¯ä¹¦root_ca.crtã€‚å¦‚æœè¿è¡Œæ­¥éª¤ca bootstrap --install --ca-url = httpsï¼š//your.ca- -fingerprint =æ‚¨çš„ca-fingerprintï¼Œå®ƒå°†æŠŠæ ¹è¯ä¹¦å®‰è£…åˆ°è®¾å¤‡çš„ä¿¡ä»»åº“ä¸­ã€‚ </p><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨stepå‘½ä»¤è½»æ¾å®‰è£…æ ¹CAè¯ä¹¦ï¼ˆå®‰è£…æ­¥éª¤è¯ä¹¦ï¼‰ï¼Œè¿›è¡ŒACMEæ³¨å†Œï¼ˆæ­¥éª¤caè¯ä¹¦example.com example.crt example.key --provisioner acmeï¼‰ä»¥åŠç»­è®¢ä»»ä½•å°šæœªè·å¾—çš„è¯ä¹¦ã€‚ è¿˜æ²¡æœ‰è¿‡æœŸï¼ˆè¯·æ›´æ–°example.crt example.keyæ­¥éª¤ï¼‰ã€‚  å¯¹äºç§»åŠ¨è®¾å¤‡ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡å°†è¯ä¹¦é€šè¿‡è“ç‰™æˆ–AirDropæˆ–ç”µå­é‚®ä»¶é™„ä»¶å‘é€ç»™è‡ªå·±æ¥å®‰è£…è¯ä¹¦ã€‚ ç¡®ä¿ä¸ä»…å®‰è£…äº†è¯ä¹¦ï¼Œè€Œä¸”è®¾å¤‡ç¡®å®ä¿¡ä»»è¯¥è¯ä¹¦ã€‚ è¿™é€šå¸¸æ¶‰åŠè®¾å¤‡ä¸Šçš„å‡ ä¸ªç¡®è®¤æ­¥éª¤ã€‚  å€ŸåŠ©ACMEè®¾ç½®ç¨‹åºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Certbotç­‰è½¯ä»¶æˆ–  ...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://smallstep.com/blog/build-a-tiny-ca-with-raspberry-pi-yubikey/">https://smallstep.com/blog/build-a-tiny-ca-with-raspberry-pi-yubikey/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/å®éªŒå®¤/">#å®éªŒå®¤</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tiny/">#tiny</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ca/">#ca</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1040583.html"><img src="http://img2.diglog.com/img/2020/12/thumb_68dabff5128a33aae5511cd2a422de0b.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1040583.html">ç«ç®­å®éªŒå®¤ä¸æ–­æ‰©å¤§çš„è½¨é“ä¸Šçš„å½¼å¾—Â·è´å…‹ </a></div><span class="my_story_list_date">2020-12-19 2:39</span></div><div class="col-sm"><div><a target="_blank" href="/story/1037620.html"><img src="http://img2.diglog.com/img/2020/12/thumb_18d37b73164f21b6a29599ccfc69fde3.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1037620.html">æ–°åŠ å¡æˆä¸ºç¬¬ä¸€ä¸ªæ‰¹å‡†å®éªŒå®¤ç§æ¤è‚‰ç±»çš„å›½å®¶ </a></div><span class="my_story_list_date">2020-12-4 21:45</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033549.html"><img src="http://img2.diglog.com/img/2020/11/thumb_005d676b670eba548937f2d89a2dd566.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033549.html">
ç”Ÿäº§è‚‰ç±»æ›¿ä»£å“çš„åˆåˆ›ä¼ä¸šåœ¨å…¨çƒèŒƒå›´å†…è·å¾—äº†å¸å¼•åŠ›</a></div><span class="my_story_list_date">2020-11-7 6:18</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032837.html"><img src="http://img2.diglog.com/img/2020/11/thumb_63f892893084f41b3d1b59afdf2ed2da.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032837.html">
ç«ç®­å®éªŒå®¤çš„ä¸‹ä¸€æ¬¡å‘å°„å°†æŠŠ30é¢—å«æ˜Ÿé€å…¥è½¨é“-ä»¥åŠåŠ å¸ƒÂ·çº½å¨å°”(Gabe Newell)çš„3Dæ‰“å°ä¾å„’</a></div><span class="my_story_list_date">2020-11-3 3:45</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¶æ/">#æ¶æ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è°·æ­Œ/">#è°·æ­Œ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å·¥å…·/">#å·¥å…·</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>