<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>é€šè¿‡Internetæ§åˆ¶æ—§å¼ç”µå­è®¾å¤‡</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">é€šè¿‡Internetæ§åˆ¶æ—§å¼ç”µå­è®¾å¤‡</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-02 01:02:09</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/29596a51f4b18a9b2578b9c998df3deb.png"><img src="http://img2.diglog.com/img/2020/11/29596a51f4b18a9b2578b9c998df3deb.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Iâ€™m fascinated by the idea of smart consumer electronics. When it comes to tools I use on a daily ba sis, Iâ€™m sort of a control freak and like to utilize them as much as I can, from wherever I can. Unfortunately though, some of these tools are legacy electronics, like my air conditioner, and I simply donâ€™t want to spend money buying a new smart AC because this one just works fine. So for quite some time, I had been wondering if there was a way to smart up my AC in a cost-effective manner. I then realised last week that I had a Raspberry Pi, as well as  Adafruitâ€™s CircuitPlayground Express, which I had got as part of conference swag lying around in my desk drawer. These little beasts were essentially begging to be utilized for some good as I had not played much with them.</p><p>æˆ‘å¯¹æ™ºèƒ½æ¶ˆè´¹ç”µå­äº§å“çš„æƒ³æ³•å¾ˆç€è¿·ã€‚å½“è°ˆåˆ°æˆ‘åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ä½¿ç”¨çš„å·¥å…·æ—¶ï¼Œæˆ‘æœ‰ç‚¹åƒä¸€ä¸ªæ§åˆ¶ç‹‚ï¼Œå–œæ¬¢åœ¨ä»»ä½•æˆ‘èƒ½ç”¨åˆ°çš„åœ°æ–¹å°½å¯èƒ½å¤šåœ°ä½¿ç”¨å®ƒä»¬ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›å·¥å…·ä¸­æœ‰ä¸€äº›æ˜¯ä¼ ç»Ÿçš„ç”µå­äº§å“ï¼Œæ¯”å¦‚æˆ‘çš„ç©ºè°ƒï¼Œæˆ‘æ ¹æœ¬ä¸æƒ³èŠ±é’±ä¹°ä¸€å°æ–°çš„æ™ºèƒ½ç©ºè°ƒï¼Œå› ä¸ºè¿™ä¸€å°å·¥ä½œå¾—å¾ˆå¥½ã€‚å› æ­¤ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´ä»¥æ¥ï¼Œæˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œæ˜¯å¦æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è®©æˆ‘çš„ç©ºè°ƒå˜å¾—æ›´å…·æˆæœ¬æ•ˆç›Šã€‚ç„¶åï¼Œä¸Šå‘¨æˆ‘æ„è¯†åˆ°ï¼Œæˆ‘æœ‰ä¸€è¾†æ ‘è“PIï¼Œè¿˜æœ‰ä¸€è¾†Adafruitçš„Circuit Playround Expressï¼Œè¿™æ˜¯æˆ‘åœ¨åŠå…¬æ¡ŒæŠ½å±‰é‡Œä½œä¸ºä¼šè®®ç¤¼å“çš„ä¸€éƒ¨åˆ†å¾—åˆ°çš„ã€‚è¿™äº›å°é‡å…½æœ¬è´¨ä¸Šæ˜¯åœ¨ä¹æ±‚è¢«åˆ©ç”¨æ¥åšä¸€äº›å¥½äº‹ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰å’Œå®ƒä»¬ç©å¤ªå¤šã€‚</p><p> I noticed that CircuitPlayground Express had an embedded IR transceiver. While it doesnâ€™t have its own OS and Internet connectivity, I thought I could use it as a substitute for my AC remote in some way. Soon I also realised that the Internet connectivity void could be filled by the Raspberry Pi! Next thing I knew, I was scouring through the specs of these boards, trying to devise a way to use them in conjunction to smarten up my AC. After spending days on this problem (some of which were very, very frustrating), I was finally able to accomplish what I wanted!</p><p>æˆ‘æ³¨æ„åˆ°Circuit Playround Expressæœ‰ä¸€ä¸ªåµŒå…¥å¼çº¢å¤–æ”¶å‘å™¨ã€‚è™½ç„¶å®ƒæ²¡æœ‰è‡ªå·±çš„æ“ä½œç³»ç»Ÿå’Œäº’è”ç½‘è¿æ¥ï¼Œä½†æˆ‘æƒ³æˆ‘å¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šç”¨å®ƒæ¥æ›¿ä»£æˆ‘çš„äº¤æµé¥æ§å™¨ã€‚å¾ˆå¿«ï¼Œæˆ‘ä¹Ÿæ„è¯†åˆ°äº’è”ç½‘è¿æ¥çš„ç©ºç™½å¯ä»¥ç”±æ ‘è“PIæ¥å¡«è¡¥ï¼æ¥ä¸‹æ¥æˆ‘æ‰€çŸ¥é“çš„å°±æ˜¯ï¼Œæˆ‘ä»”ç»†ç ”ç©¶äº†è¿™äº›ç”µè·¯æ¿çš„è§„æ ¼ï¼Œè¯•å›¾è®¾è®¡å‡ºä¸€ç§å°†å®ƒä»¬ç»“åˆä½¿ç”¨çš„æ–¹æ³•ï¼Œä»¥ä½¿æˆ‘çš„ACå˜å¾—æ›´èªæ˜ã€‚åœ¨è¿™ä¸ªé—®é¢˜ä¸ŠèŠ±äº†å‡ å¤©æ—¶é—´(æœ‰äº›é—®é¢˜éå¸¸éå¸¸ä»¤äººæ²®ä¸§)ä¹‹åï¼Œæˆ‘ç»ˆäºèƒ½å¤Ÿå®ç°æˆ‘æƒ³è¦çš„äº†ï¼</p><p> As a starting step, the first thing I did was build a way to remotely turn on my AC â€” and by remotely I mean from anywhere in the world! In this article, Iâ€™ll be demonstrating how I used few open source tools along with the aforementioned boards to bring the power of Internet to my legacy air conditioner, which has no other means of I/O except infrared.</p><p>ä½œä¸ºç¬¬ä¸€æ­¥ï¼Œæˆ‘åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å»ºç«‹äº†ä¸€ç§è¿œç¨‹æ‰“å¼€æˆ‘çš„ACçš„æ–¹æ³•-æˆ‘è¯´çš„è¿œç¨‹æ˜¯æŒ‡ä»ä¸–ç•Œçš„ä»»ä½•åœ°æ–¹ï¼åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨å°‘é‡å¼€æºå·¥å…·å’Œå‰è¿°ä¸»æ¿å°†Internetçš„åŠ›é‡å¸¦åˆ°æˆ‘çš„ä¼ ç»Ÿç©ºè°ƒä¸Šï¼Œå®ƒé™¤äº†çº¢å¤–çº¿ä¹‹å¤–æ²¡æœ‰å…¶ä»–I/Oæ–¹å¼ã€‚</p><p>     Now, if you donâ€™t have CircuitPlayground Express (CPX), you can substitute it with any IR module, like  this. I used CPX because I already had it. Also, what weâ€™ll be doing isnâ€™t resource intensive, so any cloud box with basic specs will work, including free tier ones (in fact, I used a free-tier AWS EC2 box for this).</p><p>ç°åœ¨ï¼Œå¦‚æœæ‚¨æ²¡æœ‰Circuit Playround Express(CPX)ï¼Œæ‚¨å¯ä»¥å°†å…¶æ›¿æ¢ä¸ºä»»ä½•IRæ¨¡å—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚æˆ‘ç”¨CPXæ˜¯å› ä¸ºæˆ‘å·²ç»æœ‰äº†ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¦åšçš„ä¸æ˜¯èµ„æºå¯†é›†å‹çš„ï¼Œæ‰€ä»¥ä»»ä½•æœ‰åŸºæœ¬è§„æ ¼çš„äº‘ç›’éƒ½å¯ä»¥å·¥ä½œï¼ŒåŒ…æ‹¬å…è´¹çš„ç¬¬ä¸€å±‚(äº‹å®ä¸Šï¼Œæˆ‘ä¸ºæ­¤ä½¿ç”¨çš„æ˜¯è‡ªç”±å±‚çš„AWS EC2ç›’)ã€‚</p><p>  On the software end, we will need the following tools (Iâ€™ll explain their usage later in the article):</p><p>åœ¨è½¯ä»¶æ–¹é¢ï¼Œæˆ‘ä»¬å°†éœ€è¦ä»¥ä¸‹å·¥å…·(æˆ‘å°†åœ¨æœ¬æ–‡åé¢è§£é‡Šå®ƒä»¬çš„ç”¨æ³•)ï¼š</p><p> Shortcuts app on iOS / IFTTT on Android (I only describe the steps for iOS but theyâ€™ll be almost identical for Android)</p><p>IOSä¸Šçš„å¿«æ·é”®åº”ç”¨ç¨‹åº/Androidä¸Šçš„IFTTT(æˆ‘åªæè¿°äº†iOSä¸Šçš„æ­¥éª¤ï¼Œä½†Androidä¸Šçš„æ­¥éª¤å‡ ä¹ç›¸åŒ)ã€‚</p><p>   In order for us to be able to switch on the AC from CPX, we first need to see how the remote control does it. Sure, it sends an infrared signal to the receiver in AC, but we need to know how this signal looks like so that we can imitate it from CPX.</p><p>ä¸ºäº†è®©æˆ‘ä»¬èƒ½å¤Ÿä»CPxæ‰“å¼€äº¤æµç”µæºï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çœ‹çœ‹é¥æ§å™¨æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„ã€‚å½“ç„¶ï¼Œå®ƒä¼šå‘äº¤æµç”µä¸­çš„æ¥æ”¶å™¨å‘é€çº¢å¤–ä¿¡å·ï¼Œä½†æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ªä¿¡å·æ˜¯ä»€ä¹ˆæ ·å­ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½åœ¨CPXä¸Šæ¨¡ä»¿å®ƒã€‚</p><p> Figuring this out was arguably the hardest part for me, because the  official Adafruit tutorial and many other tutorials on the Web assume that devices we weâ€™re working with follow the NEC infrared protocol. Unfortunately that wasnâ€™t the case with me and I realised that after painful 4 hours of scratching my head. Different companies use different protocols, and Fujitsu General doesnâ€™t use NEC. I then tried to get the IR codes for my AC model directly from the docs of Arduino libraries like  these, but deciphering them was even harder.</p><p>å¼„æ¸…æ¥šè¿™ä¸€ç‚¹å¯¹æˆ‘æ¥è¯´å¯èƒ½æ˜¯æœ€å›°éš¾çš„éƒ¨åˆ†ï¼Œå› ä¸ºAdafruitå®˜æ–¹æ•™ç¨‹å’Œç½‘ä¸Šçš„è®¸å¤šå…¶ä»–æ•™ç¨‹éƒ½å‡è®¾æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„è®¾å¤‡éµå¾ªNECçº¢å¤–åè®®ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘çš„æƒ…å†µå¹¶éå¦‚æ­¤ï¼Œåœ¨ç—›è‹¦åœ°æŒ äº†4ä¸ªå°æ—¶çš„å¤´ä¹‹åï¼Œæˆ‘æ„è¯†åˆ°äº†è¿™ä¸€ç‚¹ã€‚ä¸åŒçš„å…¬å¸ä½¿ç”¨ä¸åŒçš„åè®®ï¼Œå¯Œå£«é€šé€šç”¨ä¸ä½¿ç”¨NECã€‚ç„¶åï¼Œæˆ‘è¯•å›¾ç›´æ¥ä»Arduinoåº“çš„æ–‡æ¡£ä¸­è·å¾—æˆ‘çš„ACå‹å·çš„IRä»£ç ï¼Œä½†è¦ç ´è¯‘å®ƒä»¬å°±æ›´éš¾äº†ã€‚</p><p> Much later, I thought â€” what if I donâ€™t try to obtain the decoded sequence from the IR pulses, but rather just imitate the pulses directly? For this, I experimented with the  pulseio CPX library (preinstalled on the board)and discovered that imitating my AC remote this way was much easier â€” plus this approach also generalizes to all infrared protocols, not just NEC!</p><p>å¾ˆä¹…ä»¥åï¼Œæˆ‘æƒ³-å¦‚æœæˆ‘ä¸è¯•å›¾ä»IRè„‰å†²ä¸­è·å¾—è§£ç åºåˆ—ï¼Œè€Œæ˜¯ç›´æ¥æ¨¡æ‹Ÿè„‰å†²ä¼šæ€ä¹ˆæ ·ï¼Ÿä¸ºæ­¤ï¼Œæˆ‘è¯•éªŒäº†Pulseio CPXåº“(é¢„è£…åœ¨ç”µè·¯æ¿ä¸Š)ï¼Œå‘ç°ç”¨è¿™ç§æ–¹å¼æ¨¡ä»¿æˆ‘çš„äº¤æµé¥æ§å™¨è¦å®¹æ˜“å¾—å¤š-æ­¤å¤–ï¼Œè¿™ç§æ–¹æ³•è¿˜é€‚ç”¨äºæ‰€æœ‰çº¢å¤–åè®®ï¼Œè€Œä¸ä»…ä»…æ˜¯NECï¼</p><p>  After connecting CPX to my laptop via USB, I first imported the necessary libraries and set up the IR receiver in mu-editorâ€™s REPL. Then I pointed my AC remote control towards the CPX board and hit the power button on it. CPX received the IR pulses sent from the remote control, which I then printed on screen:</p><p>åœ¨é€šè¿‡USBå°†CPXè¿æ¥åˆ°æˆ‘çš„ç¬”è®°æœ¬ç”µè„‘ä¹‹åï¼Œæˆ‘é¦–å…ˆå¯¼å…¥äº†æ‰€éœ€çš„åº“ï¼Œå¹¶åœ¨Mu-Editorâ€˜s REPLä¸­è®¾ç½®äº†IRæ¥æ”¶å™¨ã€‚ç„¶åæˆ‘æŠŠæˆ‘çš„äº¤æµé¥æ§å™¨å¯¹å‡†CPxæ¿ï¼ŒæŒ‰ä¸‹äº†ä¸Šé¢çš„ç”µæºæŒ‰é’®ã€‚CPxæ”¶åˆ°é¥æ§å™¨å‘é€çš„IRè„‰å†²ï¼Œç„¶åæˆ‘å°†å…¶æ‰“å°åœ¨å±å¹•ä¸Šï¼š</p><p>  I ignored the stray values (generally short in length), and copied the large blob that shows up just after remote sends the power-on signal to CPX.</p><p>æˆ‘å¿½ç•¥äº†æ‚æ•£å€¼(é€šå¸¸é•¿åº¦è¾ƒçŸ­)ï¼Œå¹¶å¤åˆ¶äº†Remoteå°†å¼€æœºä¿¡å·å‘é€åˆ°CPxä¹‹åç«‹å³å‡ºç°çš„å¤§æ–‘ç‚¹ã€‚</p><p> I repeated the process to check if values are same all the time. Notice that individual pulses have slightly different numbers for each transmission, but as weâ€™ll see later, they work just fine as long as theyâ€™re together. The only significant pulse array you can see above is when Iâ€™d accidentally sent power-off signal from the remote control instead of power-on.</p><p>æˆ‘é‡å¤äº†è¿™ä¸ªè¿‡ç¨‹ï¼Œä»¥æ£€æŸ¥å€¼æ˜¯å¦å§‹ç»ˆç›¸åŒã€‚è¯·æ³¨æ„ï¼Œæ¯ä¸ªä¼ è¾“çš„å•ä¸ªè„‰å†²çš„æ•°å­—ç•¥æœ‰ä¸åŒï¼Œä½†æ­£å¦‚æˆ‘ä»¬ç¨åå°†çœ‹åˆ°çš„é‚£æ ·ï¼Œåªè¦å®ƒä»¬åœ¨ä¸€èµ·ï¼Œå®ƒä»¬å°±å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œã€‚æ‚¨åœ¨ä¸Šé¢çœ‹åˆ°çš„å”¯ä¸€é‡è¦çš„è„‰å†²é˜µåˆ—æ˜¯å½“æˆ‘ä¸å°å¿ƒä»é¥æ§å™¨å‘å‡ºæ–­ç”µä¿¡å·è€Œä¸æ˜¯å¼€æœºæ—¶ã€‚</p><p> I then copied the pulse array for power-on signal and stored it in a separate place (Notes app on my laptop).</p><p>ç„¶åï¼Œæˆ‘å¤åˆ¶äº†é€šç”µä¿¡å·çš„è„‰å†²é˜µåˆ—ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨å•ç‹¬çš„ä½ç½®(ç¬”è®°æœ¬ç”µè„‘ä¸Šçš„Notesåº”ç”¨ç¨‹åº)ã€‚</p><p>  This bit was much easier. In the mu-editor REPL, I stored the power-on pulse array as a variable (the same pulse array Iâ€™d copied earlier). Then I initialized and configured the IR transmitter on CPX board. A standard frequency of transmission is 38kHz, with a signal duty cycle (â€œon-timeâ€) of 32768, or 2Â¹âµ. Before sending the pulses, this library requires them to be converted to half-words, which I can be done via the pre-installed  array library itself.</p><p>è¿™ä¸€ç‚¹è¦å®¹æ˜“å¾—å¤šã€‚åœ¨uç¼–è¾‘å™¨REPLä¸­ï¼Œæˆ‘å°†å¼€æœºè„‰å†²æ•°ç»„å­˜å‚¨ä¸ºå˜é‡(ä¸æˆ‘ä¹‹å‰å¤åˆ¶çš„è„‰å†²æ•°ç»„ç›¸åŒ)ã€‚ç„¶åå¯¹CPxæ¿ä¸Šçš„çº¢å¤–å‘å°„å™¨è¿›è¡Œåˆå§‹åŒ–å’Œé…ç½®ã€‚æ ‡å‡†ä¼ è¾“é¢‘ç‡ä¸º38 kHzï¼Œä¿¡å·å ç©ºæ¯”(â€œON-Timeâ€)ä¸º32768ï¼Œæˆ–2ï¼Ÿâµã€‚åœ¨å‘é€è„‰å†²ä¹‹å‰ï¼Œè¯¥åº“è¦æ±‚å°†å…¶è½¬æ¢ä¸ºåŠå­—ï¼Œè¿™å¯ä»¥é€šè¿‡é¢„è£…çš„é˜µåˆ—åº“æœ¬èº«æ¥å®Œæˆã€‚</p><p>  The moment of truth for me was when I finally pressed enter after the  pulseout.send(power_on_sig) line. Immediately after pressing enter, I heard the clicking beep from my AC and it did turn on! ğŸ¥³</p><p>å¯¹æˆ‘æ¥è¯´ï¼Œå…³é”®æ—¶åˆ»æ˜¯åœ¨Pulseout.send(Power_On_Sig)è¡Œä¹‹åç»ˆäºæŒ‰äº†Enteré”®ã€‚æŒ‰Enteré”®åï¼Œæˆ‘ç«‹å³å¬åˆ°äº¤æµç”µæºå‘å‡ºæ»´ç­”å£°ï¼Œå®ƒç¡®å®æ‰“å¼€äº†ï¼ğŸ¥³ã€‚</p><p> A nice, neat little trick to try out is seeing CPX sending the IR pulses via a super-slow-mo camera. Since IR pulses are sent super quickly, and therefore not visible to the naked eye, you can capture them on video and play it back in slow-mo to see it in action â€” notice the blinking whitish dot in the middle of the board:</p><p>ä¸€ä¸ªä¸é”™çš„ã€å·§å¦™çš„å°æŠŠæˆå¯ä»¥è¯•ä¸€è¯•ï¼Œé‚£å°±æ˜¯çœ‹åˆ°CPXé€šè¿‡ä¸€ä¸ªè¶…æ…¢é•œå¤´å‘é€çº¢å¤–è„‰å†²ã€‚ç”±äºçº¢å¤–è„‰å†²å‘é€é€Ÿåº¦æå¿«ï¼Œå› æ­¤è‚‰çœ¼çœ‹ä¸åˆ°ï¼Œå› æ­¤æ‚¨å¯ä»¥ç”¨è§†é¢‘æ•è·å®ƒä»¬ï¼Œå¹¶ä»¥æ…¢é•œå¤´æ’­æ”¾ä»¥æŸ¥çœ‹å®é™…æƒ…å†µ-è¯·æ³¨æ„ç”µè·¯æ¿ä¸­å¤®é—ªçƒçš„ç™½ç‚¹ï¼š</p><p>  Now that the core functionality of my solution had been figured out, rest of the steps were relatively smoother. Next thing to find out how to signal CPX itself to fire these IR pulses towards the AC. Interestingly, the USB cable that powers up CPX can also be used as a serial input-output periphery. So I decided that a simple way to signal CPX about when to transmit IR pulses would be to send bytes representing the string  &#34;on&#34; through the USB. CPX will fire the IR pulses every time it receives this sequence of bytes from its mini-USB port. I also decided to add a flash of green to the LEDâ€™s on CPX as a cool way of acknowledging received command to turn on the AC. The overall code for this is fairly simple:</p><p>æ—¢ç„¶æˆ‘çš„è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒåŠŸèƒ½å·²ç»å¼„æ¸…æ¥šäº†ï¼Œå‰©ä¸‹çš„æ­¥éª¤å°±ç›¸å¯¹æµç•…äº†ã€‚æ¥ä¸‹æ¥è¦äº†è§£å¦‚ä½•å‘CPxè‡ªèº«å‘å‡ºä¿¡å·ï¼Œä»¥å‘ACå‘å°„è¿™äº›IRè„‰å†²ã€‚æœ‰è¶£çš„æ˜¯ï¼Œä¸ºCPXé€šç”µçš„USBç”µç¼†ä¹Ÿå¯ä»¥ç”¨ä½œä¸²è¡Œè¾“å…¥è¾“å‡ºå¤–å›´è®¾å¤‡ã€‚å› æ­¤ï¼Œæˆ‘å†³å®šé€šçŸ¥CPxä½•æ—¶å‘é€IRè„‰å†²çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯é€šè¿‡USBå‘é€è¡¨ç¤ºå­—ç¬¦ä¸²çš„å­—èŠ‚(&#34ï¼›On&#34ï¼›on&#34ï¼›On&#34ï¼›on&#34ï¼›on)ã€‚CPxå°†åœ¨æ¯æ¬¡ä»å…¶è¿·ä½ USBç«¯å£æ¥æ”¶åˆ°æ­¤å­—èŠ‚åºåˆ—æ—¶è§¦å‘IRè„‰å†²ã€‚æˆ‘è¿˜å†³å®šåœ¨CPxä¸Šçš„LEDä¸Šå¢åŠ ä¸€ä¸ªç»¿è‰²çš„é—ªçƒï¼Œä½œä¸ºç¡®è®¤æ¥æ”¶åˆ°æ‰“å¼€äº¤æµçš„å‘½ä»¤çš„ä¸€ç§å¾ˆé…·çš„æ–¹å¼ã€‚è¿™æ–¹é¢çš„æ€»ä½“ä»£ç ç›¸å½“ç®€å•ï¼š</p><p>  So that was how CPX handles serial input and infrared output. Now I needed a way to send commands to CPX via the Internet, so that I can indirectly control my AC remotely. This is where Raspberry Pi came in. I SSH-ed to my Pi, installed Flask on it via Pythonâ€™s package manager  pip, and then wrote a simple server that sends bytes over USB representing the commands. What I envisioned is, whenever I make a GET  /switch/on request to this server, it should send  on bytes via USB to CPX, which in turn sends corresponding IR signals to my AC to switch itself on. Hereâ€™s the mostly-self-explanatory code for the server:</p><p>è¿™å°±æ˜¯CPXå¤„ç†ä¸²è¡Œè¾“å…¥å’Œçº¢å¤–è¾“å‡ºçš„æ–¹å¼ã€‚ç°åœ¨æˆ‘éœ€è¦ä¸€ç§é€šè¿‡äº’è”ç½‘å‘CPXå‘é€å‘½ä»¤çš„æ–¹å¼ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥é—´æ¥åœ°è¿œç¨‹æ§åˆ¶æˆ‘çš„äº¤æµã€‚è¿™å°±æ˜¯æ ‘è“æ´¾çš„ç”¨æ­¦ä¹‹åœ°ã€‚æˆ‘é€šè¿‡SSHè¿æ¥åˆ°æˆ‘çš„PIï¼Œé€šè¿‡Pythonçš„åŒ…ç®¡ç†å™¨pipåœ¨ä¸Šé¢å®‰è£…äº†Flaskï¼Œç„¶åç¼–å†™äº†ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ï¼Œå®ƒé€šè¿‡USBå‘é€è¡¨ç¤ºå‘½ä»¤çš„å­—èŠ‚ã€‚æˆ‘è®¾æƒ³çš„æ˜¯ï¼Œæ¯å½“æˆ‘å‘è¯¥æœåŠ¡å™¨å‘å‡ºGET/SWITCH/ONè¯·æ±‚æ—¶ï¼Œå®ƒåº”è¯¥é€šè¿‡USBå°†å­—èŠ‚å‘é€åˆ°CPXï¼ŒCPXå†å°†ç›¸åº”çš„IRä¿¡å·å‘é€åˆ°æˆ‘çš„ACä»¥æ‰“å¼€å®ƒè‡ªå·±ã€‚ä»¥ä¸‹æ˜¯æœåŠ¡å™¨çš„å¤§éƒ¨åˆ†ä¸è¨€è‡ªæ˜çš„ä»£ç ï¼š</p><p>  After connecting CPX to my Raspberry Pi via USB, I fired up this server on Pi via  python3 command_sender.py. Next, from my laptop, I sent a  cURL GET request to my Pi (via home LAN), as follows:</p><p>åœ¨é€šè¿‡USBå°†CPXè¿æ¥åˆ°æˆ‘çš„Raspberry PIä¹‹åï¼Œæˆ‘é€šè¿‡python3å‘½ä»¤_sender.pyåœ¨PIä¸Šå¯åŠ¨äº†è¿™ä¸ªæœåŠ¡å™¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»æˆ‘çš„ç¬”è®°æœ¬ç”µè„‘å‘æˆ‘çš„PI(é€šè¿‡å®¶åº­LAN)å‘é€äº†ä¸€ä¸ªcURL GETè¯·æ±‚ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>  And yet again, my AC turned on gracefully as soon as I pressed enter! This was one of those rare occasions when my code works as intended in the very first run ğŸ˜„. But this happiness didnâ€™t last long as I was about to hit a kind of dead end.</p><p>å†ä¸€æ¬¡ï¼Œæˆ‘ä¸€æŒ‰å›è½¦é”®ï¼Œæˆ‘çš„ACå°±ä¼˜é›…åœ°æ‰“å¼€äº†ï¼è¿™æ˜¯æˆ‘çš„ä»£ç åœ¨ç¬¬ä¸€æ¬¡è¿è¡ŒğŸ˜„æ—¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œçš„æå°‘æ•°æƒ…å†µä¹‹ä¸€ã€‚ä½†æ˜¯è¿™ç§å¿«ä¹å¹¶æ²¡æœ‰æŒç»­å¾ˆé•¿æ—¶é—´ï¼Œå› ä¸ºæˆ‘å³å°†èµ°è¿›ä¸€æ¡æ­»èƒ¡åŒã€‚</p><p>  The system I was trying to build wouldnâ€™t be of much utility if I couldnâ€™t access it via Internet. It worked till now because I was sending commands to Raspberry Pi while being on the same home Wifi network.</p><p>å¦‚æœæˆ‘ä¸èƒ½é€šè¿‡äº’è”ç½‘è®¿é—®ï¼Œæˆ‘è¯•å›¾å»ºç«‹çš„ç³»ç»Ÿå°±ä¸ä¼šæœ‰å¤ªå¤§çš„ç”¨å¤„ã€‚å®ƒä¸€ç›´å·¥ä½œåˆ°ç°åœ¨ï¼Œå› ä¸ºæˆ‘åœ¨åŒä¸€ä¸ªå®¶åº­Wifiç½‘ç»œä¸Šå‘æ ‘è“Piå‘é€å‘½ä»¤ã€‚</p><p> While the straightforward way to make the Pi accessible via the public Internet was to enable port-forwarding on my home router, I didnâ€™t want to do that mostly because of two reasons:</p><p>è™½ç„¶ä½¿PIå¯ä»¥é€šè¿‡å…¬å…±Internetè®¿é—®çš„ç›´æ¥æ–¹æ³•æ˜¯åœ¨æˆ‘çš„å®¶åº­è·¯ç”±å™¨ä¸Šå¯ç”¨ç«¯å£è½¬å‘ï¼Œä½†æˆ‘ä¸æƒ³è¿™æ ·åšï¼Œä¸»è¦æ˜¯å› ä¸ºä¸¤ä¸ªåŸå› ï¼š</p><p> I didnâ€™t want to expose my home networkâ€™s public IP (Iâ€™m not a security whiz but I just didnâ€™t feel safe doing this).</p><p>æˆ‘ä¸æƒ³æš´éœ²æˆ‘çš„å®¶åº­ç½‘ç»œçš„å…¬å…±IP(æˆ‘ä¸æ˜¯å®‰å…¨ä¸“å®¶ï¼Œä½†æˆ‘åªæ˜¯è§‰å¾—è¿™æ ·åšä¸å®‰å…¨)ã€‚</p><p> My ISP can change the public IP address of my home without informing me, which can lead to headaches and unnecessary reconfiguration.</p><p>æˆ‘çš„ISPå¯ä»¥åœ¨ä¸é€šçŸ¥æˆ‘çš„æƒ…å†µä¸‹æ›´æ”¹æˆ‘å®¶çš„å…¬å…±IPåœ°å€ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¤´ç—›å’Œä¸å¿…è¦çš„é‡æ–°é…ç½®ã€‚</p><p> Anticipating the unreliability of this approach, I decided to look for alternatives. I was aware that reverse proxies are a common way to solve these kinds of problems, since they donâ€™t require messing with router configurations and are relatively safer since connections are always initiated from within the network. A cool reverse proxy solution I was familiar with is   ngrok , but the problem with  ngrok is that the free version only allows connectivity for 8 hours. Then there is another solution built specifically for Raspberry Piâ€™s is  dataplicity, but itâ€™s terminal interface has some bugs and the free version is quite limited, just like  ngrok. Moreover, I wanted to avoid as much external dependencies as possible.</p><p>é¢„è§åˆ°è¿™ç§æ–¹æ³•çš„ä¸å¯é æ€§ï¼Œæˆ‘å†³å®šå¯»æ‰¾æ›¿ä»£æ–¹æ³•ã€‚æˆ‘çŸ¥é“åå‘ä»£ç†æ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„å¸¸ç”¨æ–¹æ³•ï¼Œå› ä¸ºå®ƒä»¬ä¸éœ€è¦å¤„ç†è·¯ç”±å™¨é…ç½®ï¼Œè€Œä¸”ç›¸å¯¹å®‰å…¨ï¼Œå› ä¸ºè¿æ¥æ€»æ˜¯ä»ç½‘ç»œå†…éƒ¨å‘èµ·çš„ã€‚æˆ‘ç†Ÿæ‚‰çš„ä¸€ä¸ªå¾ˆé…·çš„åå‘ä»£ç†è§£å†³æ–¹æ¡ˆæ˜¯ngrokï¼Œä½†ngrokçš„é—®é¢˜æ˜¯å…è´¹ç‰ˆæœ¬åªå…è®¸è¿æ¥8å°æ—¶ã€‚è¿˜æœ‰å¦ä¸€ä¸ªä¸“é—¨ä¸ºRaspberry Piæ„å»ºçš„è§£å†³æ–¹æ¡ˆæ˜¯dataplicityï¼Œä½†æ˜¯å®ƒçš„ç»ˆç«¯ç•Œé¢æœ‰ä¸€äº›é”™è¯¯ï¼Œè€Œä¸”å…è´¹ç‰ˆæœ¬éå¸¸æœ‰é™ï¼Œå°±åƒngrokä¸€æ ·ã€‚æ­¤å¤–ï¼Œæˆ‘å¸Œæœ›å°½å¯èƒ½å¤šåœ°é¿å…å¤–éƒ¨ä¾èµ–ã€‚</p><p> â€œIn computer networks, a  reverse proxy is a type of proxy server that retrieves resources on behalf of a client from one or more servers. These resources are then returned to the client, appearing as if they originated from the server itself.â€ â€” Wikipedia</p><p>â€œåœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼Œåå‘ä»£ç†æ˜¯ä»£è¡¨å®¢æˆ·ç«¯ä»ä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡å™¨æ£€ç´¢èµ„æºçš„ä¸€ç§ä»£ç†æœåŠ¡å™¨ã€‚ç„¶åè¿™äº›èµ„æºè¢«è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œçœ‹èµ·æ¥å¥½åƒå®ƒä»¬æ¥è‡ªæœåŠ¡å™¨æœ¬èº«ã€‚â€œ-ç»´åŸºç™¾ç§‘ã€‚</p><p> After searching the Web for a while, I discovered a free and open-source tool called   frp, short for â€œfast reverse proxyâ€, that can be set up as a reverse proxy server, and has an extensive set of configurations available. I tinkered with it for a while and found it to be a great fit for my needs. Leveraging its power, I decided to go with the following approach:</p><p>åœ¨Webä¸Šæœç´¢äº†ä¸€æ®µæ—¶é—´åï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªç§°ä¸ºFRPçš„å…è´¹å¼€æºå·¥å…·ï¼Œå®ƒæ˜¯â€œå¿«é€Ÿåå‘ä»£ç†â€çš„ç¼©å†™ï¼Œå¯ä»¥è®¾ç½®ä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ä¸”æœ‰å¤§é‡å¯ç”¨çš„é…ç½®ã€‚æˆ‘ä¿®ä¿®è¡¥è¡¥äº†ä¸€ä¼šå„¿ï¼Œå‘ç°å®ƒéå¸¸é€‚åˆæˆ‘çš„éœ€è¦ã€‚åˆ©ç”¨å®ƒçš„åŠ›é‡ï¼Œæˆ‘å†³å®šé‡‡ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p><p> I would set up a public-Internet facing box on AWS, that will act as a reverse proxy server. This means Iâ€™ll be sending my AC control requests to the IP of this box, and it will in turn forward that request to the Pi in my home. This is better than doing port forwarding, as I donâ€™t have to mess with my router settings and change configuration every time my ISP changes the public IP for my home network. It is also safer as I can fine tune access to devices in my home network, way beyond the basic security configuration most home routers provide. More benefits of using a reverse proxy can be found in  this Stackoverflow answer.</p><p>æˆ‘ä¼šåœ¨AWSä¸Šè®¾ç½®ä¸€ä¸ªé¢å‘å…¬å…±äº’è”ç½‘çš„ç›’å­ï¼Œä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ã€‚è¿™æ„å‘³ç€æˆ‘å°†æŠŠæˆ‘çš„ACæ§åˆ¶è¯·æ±‚å‘é€åˆ°è¿™ä¸ªç›’å­çš„IPï¼Œç„¶åå®ƒä¼šå°†è¯¥è¯·æ±‚è½¬å‘ç»™æˆ‘å®¶é‡Œçš„PIã€‚è¿™æ¯”è¿›è¡Œç«¯å£è½¬å‘è¦å¥½ï¼Œå› ä¸ºæ¯æ¬¡ISPæ›´æ”¹æˆ‘å®¶åº­ç½‘ç»œçš„å…¬ç”¨IPæ—¶ï¼Œæˆ‘éƒ½ä¸å¿…å¼„ä¹±æˆ‘çš„è·¯ç”±å™¨è®¾ç½®å’Œæ›´æ”¹é…ç½®ã€‚å®ƒä¹Ÿæ›´å®‰å…¨ï¼Œå› ä¸ºæˆ‘å¯ä»¥å¾®è°ƒå¯¹å®¶åº­ç½‘ç»œä¸­è®¾å¤‡çš„è®¿é—®ï¼Œè¿œè¿œè¶…å‡ºå¤§å¤šæ•°å®¶åº­è·¯ç”±å™¨æä¾›çš„åŸºæœ¬å®‰å…¨é…ç½®ã€‚åœ¨æ­¤å †æ ˆæº¢å‡ºç­”æ¡ˆä¸­å¯ä»¥æ‰¾åˆ°ä½¿ç”¨åå‘ä»£ç†çš„æ›´å¤šå¥½å¤„ã€‚</p><p>  As I said earlier, I used AWS for provisioning a box, but any other cloud provider will work just as good. After provisioning, I SSH-ed to the box and downloaded  frp on it. Server side configuration is simple, I just had to add a couple of lines to  frps.ini file:</p><p>æ­£å¦‚æˆ‘å‰é¢æ‰€è¯´çš„ï¼Œæˆ‘ä½¿ç”¨AWSæ¥é…ç½®æœºç®±ï¼Œä½†æ˜¯ä»»ä½•å…¶ä»–äº‘æä¾›å•†éƒ½ä¼šå·¥ä½œå¾—ä¸€æ ·å¥½ã€‚é…ç½®åï¼Œæˆ‘é€šè¿‡SSHè¿æ¥åˆ°æœºç®±å¹¶åœ¨å…¶ä¸Šä¸‹è½½äº†FRPã€‚æœåŠ¡å™¨ç«¯é…ç½®å¾ˆç®€å•ï¼Œæˆ‘åªéœ€å‘frps.iniæ–‡ä»¶æ·»åŠ å‡ è¡Œï¼š</p><p>  frp will be using this port (7000) for internal communication with clients (Pi in our case).</p><p>FRPå°†ä½¿ç”¨æ­¤ç«¯å£(7000)ä¸å®¢æˆ·ç«¯(æœ¬ä¾‹ä¸­ä¸ºPI)è¿›è¡Œå†…éƒ¨é€šä¿¡ã€‚</p><p> Next, I installed  tmux and then triggered a  tmux session. Then I started the  frp server from within it. After that I detached from the session so that reverse proxy session keeps running even after I disconnect from the box:</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å®‰è£…äº†tmuxï¼Œç„¶åè§¦å‘äº†tmuxä¼šè¯ã€‚ç„¶åæˆ‘ä»é‡Œé¢å¯åŠ¨äº†FRPæœåŠ¡å™¨ã€‚åœ¨é‚£ä¹‹åï¼Œæˆ‘ä¸ä¼šè¯åˆ†ç¦»ï¼Œä»¥ä¾¿åå‘ä»£ç†ä¼šè¯å³ä½¿åœ¨æˆ‘ä¸è®¡ç®—æœºæ–­å¼€è¿æ¥åä¹Ÿèƒ½ç»§ç»­è¿è¡Œï¼š</p><p>  Then I SSHed to my Raspberry Pi again, downloaded  frp on it, and configured the  frpc.ini file as such:</p><p>ç„¶åï¼Œæˆ‘å†æ¬¡é€šè¿‡SSHè¿æ¥åˆ°æˆ‘çš„Raspberry PIï¼Œåœ¨ä¸Šé¢ä¸‹è½½äº†FRPï¼Œå¹¶æŒ‰å¦‚ä¸‹æ–¹å¼é…ç½®äº†frpc.iniæ–‡ä»¶ï¼š</p><p> [common] server_addr = &lt;public ip of my AWS EC2 instance&gt; server_port = 7000 [web] type = tcp local_ip = 127.0.0.1 local_port = 5000 remote_port = 6000</p><p>[å¸¸ç”¨]æˆ‘çš„AWS EC2å®ä¾‹çš„æœåŠ¡å™¨åœ°å€=&ltï¼›å…¬ç½‘IP&gtï¼›æœåŠ¡å™¨ç«¯å£=7000[web]type=TCP LOCAL_IP=127.0.0.1 LOCAL_PORT=5000 REMOTE_PORT=6000ã€‚</p><p> Here,  server_port is same as  bind_port that Iâ€™d set on the server â€” 7000. Now,  remote_port and  local_port values mean that the reverse proxy server will accept requests on port 6000 and forward them to port 5000 on the Pi. I also modified the inbound settings of my EC2 instanceâ€™s security group so that ports 7000 and 8000 can be accessed.</p><p>è¿™é‡Œï¼Œserver_portä¸æˆ‘åœ¨server-7000ä¸Šè®¾ç½®çš„bind_portç›¸åŒã€‚ç°åœ¨ï¼ŒREMOTE_PORTå’ŒLOCAL_PORTå€¼æ„å‘³ç€åå‘ä»£ç†æœåŠ¡å™¨å°†æ¥å—ç«¯å£6000ä¸Šçš„è¯·æ±‚ï¼Œå¹¶å°†å®ƒä»¬è½¬å‘åˆ°PIä¸Šçš„ç«¯å£5000ã€‚æˆ‘è¿˜ä¿®æ”¹äº†EC2å®ä¾‹å®‰å…¨ç»„çš„å…¥ç«™è®¾ç½®ï¼Œä»¥ä¾¿å¯ä»¥è®¿é—®ç«¯å£7000å’Œ8000ã€‚</p><p> Next, I installed  tmux on the Pi too, and after opening a  tmux session I started the command sender Flask server ( note that I did not set up a production server but a development server, since I was still experimenting) as well as the  frp client, and then finally detached from this session and disconnected from the Pi:</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä¹Ÿåœ¨PIä¸Šå®‰è£…äº†tmuxï¼Œåœ¨æ‰“å¼€tmuxä¼šè¯ä¹‹åï¼Œæˆ‘å¯åŠ¨äº†å‘½ä»¤å‘é€å™¨FlaskæœåŠ¡å™¨(è¯·æ³¨æ„ï¼Œæˆ‘æ²¡æœ‰è®¾ç½®ç”Ÿäº§æœåŠ¡å™¨ï¼Œè€Œæ˜¯å¼€å‘æœåŠ¡å™¨ï¼Œå› ä¸ºæˆ‘ä»åœ¨è¿›è¡Œå®éªŒ)ä»¥åŠFRPå®¢æˆ·ç«¯ï¼Œæœ€åä»è¯¥ä¼šè¯åˆ†ç¦»å¹¶æ–­å¼€ä¸PIçš„è¿æ¥ï¼š</p><p>  Most of my setup was done at this point. I connected my laptop to my mobile data, then made the following  cURL call:</p><p>æˆ‘çš„å¤§éƒ¨åˆ†è®¾ç½®éƒ½æ˜¯åœ¨è¿™ä¸€ç‚¹ä¸Šå®Œæˆçš„ã€‚æˆ‘æŠŠæˆ‘çš„ç¬”è®°æœ¬ç”µè„‘è¿æ¥åˆ°æˆ‘çš„ç§»åŠ¨æ•°æ®ä¸Šï¼Œç„¶åæ‰“äº†ä»¥ä¸‹å·å‘ç”µè¯ï¼š</p><p>  â€¦and the AC beeped to life yet again, this time via a signal sent over the public Internet!</p><p>â€¦ã€‚è€Œç©ºè°ƒåˆä¸€æ¬¡å‘¼å”¤ç€ç”Ÿå‘½ï¼Œè¿™ä¸€æ¬¡æ˜¯é€šè¿‡å…¬å…±äº’è”ç½‘å‘é€çš„ä¿¡å·ï¼</p><p>  The only thing remaining was to set up a way to conveniently make this API call from my phone to turn the AC on â€” I didnâ€™t want to memorise the IP address of my EC2 machine, so I finally decided to put the Shortcuts app on my phone to some use, as that was another thing I rarely used until now, and I really wanted to try it out.</p><p>å‰©ä¸‹çš„å”¯ä¸€ä¸€ä»¶äº‹å°±æ˜¯è®¾ç½®ä¸€ç§æ–¹æ³•ï¼Œæ–¹ä¾¿åœ°ä»æˆ‘çš„æ‰‹æœºè°ƒç”¨è¿™ä¸ªAPIæ¥æ‰“å¼€AC-æˆ‘ä¸æƒ³è®°ä½æˆ‘çš„EC2æœºå™¨çš„IPåœ°å€ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆå†³å®šæŠŠæ‰‹æœºä¸Šçš„å¿«æ·æ–¹å¼åº”ç”¨ç¨‹åºæŠ•å…¥ä¸€äº›ç”¨é€”ï¼Œå› ä¸ºè¿™æ˜¯å¦ä¸€ä¸ªæˆ‘ç°åœ¨å¾ˆå°‘ä½¿ç”¨çš„ä¸œè¥¿ï¼Œæˆ‘çœŸçš„å¾ˆæƒ³å°è¯•ä¸€ä¸‹ã€‚</p><p>  Open Shortcuts app  &gt;   Create Shortcut  &gt;   Add Action  &gt;   Web  &gt;   URL  &gt;   add my API call  &gt; Tapped on    +  to add another action &gt;   Get Contents of URL  (this makes the actual GET request for the URL configured in previous action)</p><p>æ‰“å¼€å¿«æ·æ–¹å¼APP&&gt;åˆ›å»ºå¿«æ·æ–¹å¼&&gt;æ·»åŠ æ“ä½œ&&gt;Web&&gt;URL&&gt;å•å‡»+æ·»åŠ æˆ‘çš„APIè°ƒç”¨&&gt;ä»¥æ·»åŠ å¦ä¸€ä¸ªæ“ä½œ&&gt;è·å–URLçš„å†…å®¹(è¿™å°†ç”Ÿæˆå¯¹ä¸Šä¸€æ“ä½œä¸­é…ç½®çš„URLçš„å®é™…GETè¯·æ±‚)ã€‚</p><p>  While still on my mobile data, I opened the Shortcuts app on my phone and tapped on the shortcut I just created. Hereâ€™s what happened:</p><p>å½“æˆ‘è¿˜åœ¨ä½¿ç”¨æˆ‘çš„ç§»åŠ¨æ•°æ®æ—¶ï¼Œæˆ‘æ‰“å¼€äº†æ‰‹æœºä¸Šçš„å¿«æ·é”®åº”ç”¨ç¨‹åºï¼Œç‚¹å‡»äº†æˆ‘åˆšåˆšåˆ›å»ºçš„å¿«æ·é”®ã€‚äº‹æƒ…æ˜¯è¿™æ ·å‘ç”Ÿçš„ï¼š</p><p>  So thatâ€™s how I made my AC remotely accessible. It can only power-on right now, but other functionalities can be added easily, now that the barebones have been set up. The AWS box I created can act as a single hub for all communications to and from legacy electronics. Not only can I send commands to the AC, itâ€™s also possible to get its state and create controlled feedback loops for a smart temperature system â€” a lot of things can be implemented!</p><p>æ‰€ä»¥æˆ‘å°±æ˜¯è¿™æ ·è®©æˆ‘çš„ç©ºè°ƒå¯ä»¥è¿œç¨‹è®¿é—®çš„ã€‚å®ƒç°åœ¨åªèƒ½é€šç”µï¼Œä½†ç°åœ¨å¯ä»¥å¾ˆå®¹æ˜“åœ°æ·»åŠ å…¶ä»–åŠŸèƒ½ï¼Œå› ä¸ºåŸºæœ¬è®¾å¤‡å·²ç»è®¾ç½®å¥½äº†ã€‚æˆ‘åˆ›å»ºçš„AWSæœºå™¨å¯ä»¥å……å½“ä¸ä¼ ç»Ÿç”µå­äº§å“ä¹‹é—´çš„æ‰€æœ‰é€šä¿¡çš„å•ä¸€é›†çº¿å™¨ã€‚æˆ‘ä¸ä»…å¯ä»¥å‘ACå‘é€å‘½ä»¤ï¼Œè¿˜å¯ä»¥è·å–å…¶çŠ¶æ€å¹¶ä¸ºæ™ºèƒ½æ¸©åº¦ç³»ç»Ÿåˆ›å»ºå—æ§åé¦ˆå›è·¯-å¯ä»¥å®ç°å¾ˆå¤šäº‹æƒ…ï¼</p><p>  frp also provides a dashboard to monitor traffic, you can enable it via adding these lines to  frps.ini file:</p><p>FRPè¿˜æä¾›äº†ä¸€ä¸ªæ§åˆ¶é¢æ¿æ¥ç›‘æ§æµé‡ï¼Œæ‚¨å¯ä»¥é€šè¿‡å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°frps.iniæ–‡ä»¶æ¥å¯ç”¨å®ƒï¼š</p><p>  Donâ€™t forget to create an inbound rule for this port (9000 in this example) so that the dashboard can be accessed. It looks something like this:</p><p>ä¸è¦å¿˜è®°ä¸ºæ­¤ç«¯å£(æœ¬ä¾‹ä¸­ä¸º9000)åˆ›å»ºå…¥ç«™è§„åˆ™ï¼Œä»¥ä¾¿å¯ä»¥è®¿é—®ä»ªè¡¨æ¿ã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><p>  I hope this article inspires you to work on your own DIY projects with Raspberry Pi, CircuitPlayground Express and legacy devices! Let me know your thoughts and feedback in the comments!</p><p>æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯å‘æ‚¨ä½¿ç”¨Raspberry Piã€Circuit Playround Expresså’Œä¼ ç»Ÿè®¾å¤‡è¿›è¡Œè‡ªå·±çš„DIYé¡¹ç›®ï¼è¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘æ‚¨çš„æƒ³æ³•å’Œåé¦ˆï¼</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://schedutron.medium.com/build-smart-home-systems-on-top-of-legacy-electronics-d85640d2e5ea">https://schedutron.medium.com/build-smart-home-systems-on-top-of-legacy-electronics-d85640d2e5ea</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/æ§åˆ¶/">#æ§åˆ¶</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/legacy/">#legacy</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/cpx/">#cpx</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è®¾è®¡/">#è®¾è®¡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ¸¸æˆ/">#æ¸¸æˆ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åˆ›æ„/">#åˆ›æ„</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‹¹æœ/">#è‹¹æœ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‘„å½±/">#æ‘„å½±</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è½¯ä»¶/">#è½¯ä»¶</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç¾å›½/">#ç¾å›½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å›¾ç‰‡/">#å›¾ç‰‡</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/æ‰‹æœº/">#æ‰‹æœº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è§†é¢‘/">#è§†é¢‘</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¹¿å‘Š/">#å¹¿å‘Š</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å…è´¹/">#å…è´¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è°·æ­Œ/">#è°·æ­Œ</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç½‘ç«™/">#ç½‘ç«™</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/å¾®è½¯/">#å¾®è½¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ä¸‹è½½/">#ä¸‹è½½</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/éŸ³ä¹/">#éŸ³ä¹</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/åšå®¢/">#åšå®¢</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/ç¨‹åº/">#ç¨‹åº</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/è‰ºæœ¯/">#è‰ºæœ¯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>